{"getSiteIds":{"filter":"filter","models":["customer","site","region"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionIfWOTypeIdsPresent"}],"columns":{"customerCompanyName":"customer.companyName","regionName":"region.name","siteName":"site.name","siteId":"site.id"},"name":"getSiteIds","description":"fetch site ids for given regions ids and customer ids","inputVarMap":{"siteQueryFilter":"filter","region":"region","customer":"customer"},"links":{"site":"customer","region":"site"},"outputVarMap":{"data":"siteIds"},"nodeType":"QUERY"},"getWorkforceWorkGroupDataForTechnician":{"filter":"{$workforceWorkGroupWorkforceUserId}={@selectedUserId}","models":["workforceWorkGroup","workGroupFilter","workGroup"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionIfWorkforceWorkGroupDataPresent"}],"columns":{"workforceWorkGroupWorkforceUserId":"workforceWorkGroup.workforceUserId","workGroupFilterFilterId":"workGroupFilter.filterId","workGroupFilterId":"workGroupFilter.id","workforceWorkGroupWorkGroupId":"workforceWorkGroup.workGroupId","workGroupId":"workGroup.id","workGroupFilterMethod":"workGroup.filterMethod"},"name":"getWorkforceWorkGroupDataForTechnician","distinct":true,"description":"getWorkforceWorkGroupDataForTechnician","outerJoinOnModel":"workGroup","links":{"workforceWorkGroup":"workGroup","workGroup":"workGroupFilter"},"inputVarMap":{"selectedUserId":"selectedUserId"},"outputVarMap":{"data":"workforceWorkGroupDataFortechnician"},"nodeType":"QUERY"},"getWorkforceWorkGroupDataForLoggedInUser":{"filter":"{$workforceWorkGroupWorkforceUserId}={@userId}","models":["workforceWorkGroup","workGroupFilter","workGroup"],"connectors":[{"exitPortType":"NextStep","nodeId":"getWorkforceWorkGroupDataForTechnician"}],"columns":{"workforceWorkGroupWorkforceUserId":"workforceWorkGroup.workforceUserId","workGroupFilterFilterId":"workGroupFilter.filterId","workGroupFilterId":"workGroupFilter.id","workforceWorkGroupWorkGroupId":"workforceWorkGroup.workGroupId","workGroupId":"workGroup.id","workGroupFilterMethod":"workGroup.filterMethod"},"name":"getWorkforceWorkGroupDataForLoggedInUser","outerJoinOnModel":"workGroup","distinct":true,"description":"fetch work group data for logged in user (dispatcher)","links":{"workforceWorkGroup":"workGroup","workGroup":"workGroupFilter"},"inputVarMap":{"{@userId}":"userId"},"outputVarMap":{"data":"workforceWorkGroupDataforDisptacher"},"nodeType":"QUERY"},"processFilter":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchSchedulingData"}],"contextChangePermitted":true,"name":"processFilter","description":"processFilter","processRule":"{if(typeof contextVar.filter !== 'undefined' && contextVar.filter !== ''){contextVar.filter += ' AND ({$taskType.crewTask} IS NULL OR {$taskType.crewTask} = false)';}}","nodeType":"PROCESS"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"getWorkforceWorkGroupDataForLoggedInUser"}],"name":"start","description":"Start","id":"start","nodeType":"START"},"processWorkforceWorkGroupData":{"connectors":[{"exitPortType":"NextStep","nodeId":"decisionIfAllGroupApplied"}],"contextChangePermitted":true,"name":"processWorkforceWorkGroupData","description":"process work group data","processRule":"@DXM8XVC0EY","id":"processWorkforceWorkGroupData","nodeType":"PROCESS"},"processFilterForSiteQuery":{"connectors":[{"exitPortType":"NextStep","nodeId":"getSiteIds"}],"contextChangePermitted":true,"name":"processFilterForSiteQuery","description":"create a filter for fetching site ids","processRule":"contextVar.siteQueryFilter = ' '; if (typeof contextVar.region != 'undefined' && contextVar.region.length > 0) { contextVar.siteQueryFilter = contextVar.siteQueryFilter + '({$site.regionId} IN {@region})'; if (contextVar.customer != 'undefined' && contextVar.customer.length > 0) { contextVar.siteQueryFilter = contextVar.siteQueryFilter + ' AND ({$site.customerId} IN {@customer})'; } } else if (contextVar.customer != 'undefined' && contextVar.customer.length > 0) { contextVar.siteQueryFilter = contextVar.siteQueryFilter + '({$site.customerId} IN {@customer})'; }","nodeType":"PROCESS"},"processSiteIdsAndWorkOrderIds":{"connectors":[{"exitPortType":"NextStep","nodeId":"processZRule"}],"contextChangePermitted":true,"name":"processSiteIdsAndWorkOrderIds","description":"process fetched site ids and workOrder ids","processRule":"contextVar.siteIdsToFilterWith = []; contextVar.WorkOrderIdsToFilterWith = []; if(typeof contextVar.siteIds != 'undefined' && contextVar.siteIds.length > 0) { contextVar.siteIds.forEach(function (element) { contextVar.siteIdsToFilterWith.push(element.siteId); }); } if(typeof contextVar.workOrderIds != 'undefined' && contextVar.workOrderIds.length > 0) { contextVar.workOrderIds.forEach(function (ele) { contextVar.WorkOrderIdsToFilterWith.push(ele.workOrderId); }); }","id":"initializeParams","nodeType":"PROCESS"},"fetchSchedulingData":{"models":["workOrder","workOrderTask","ZStatus","taskType","site","region","customer"],"connectors":[{"exitPortType":"NextStep","nodeId":"processSchedulingData"}],"columns":{"workOrderDeadline":"workOrder.deadline","customerCompanyName":"customer.companyName","regionName":"region.name","siteName":"site.name","resultWebPageId":"taskType.resultWebPageId","taskTypeName":"taskType.name","statusNameColor":"ZStatus.colorCode","workOrderTaskTypeId":"workOrderTask.taskTypeId","statusName":"ZStatus.name","workOrderTaskId":"workOrderTask.id","modifiedDate":"workOrderTask.modifiedDate","workOrderTaskModifiedDate":"workOrderTask.modifiedDate","workOrderTaskScheduledDate":"workOrderTask.scheduledDate","workOrderTaskEstimatedDuration":"Round(({$workOrderTask.estimatedDuration})/60,2)","workOrderId":"workOrder.id","status":"workOrderTask.statusId","viewTravelStatus":"taskType.viewTravelStatus","workOrderTaskCompletedDate":"workOrderTask.completedDate"},"description":"Fetch Task Details","orderBy":"orderBy","distinct":true,"inputVarMap":{"filter":"filter","statusFilter":"statusFilter","taskFilter":"taskFilter","orderBy":"orderBy","workOrderFilter":"workOrderFilter","batchSize":"batchSize","customerFilter":"customerFilter","batchNumber":"batchNumber"},"nodeType":"QUERY","filter":"filter","name":"fetchSchedulingData","links":{"workOrder":"workOrderTask","workOrderTask":"site","taskType":"workOrderTask","site":"workOrderTask","region":"site","ZStatus":"workOrderTask","customer":"site"},"id":"fetchSchedulingData","outputVarMap":{"data":"schedulingAndDispatchData","count":"count"},"batchSize":"batchSize","getCount":true,"batchNumber":"batchNumber"},"workflowNodes":["start","getWorkforceWorkGroupDataForLoggedInUser","getWorkforceWorkGroupDataForTechnician","decisionIfWorkforceWorkGroupDataPresent","processWorkforceWorkGroupData","decisionIfAllGroupApplied","decisionIfRegionIdsPresent","processFilterForSiteQuery","getSiteIds","decisionIfWOTypeIdsPresent","getWorkOrderIds","processSiteIdsAndWorkOrderIds","processZRule","processFilter","fetchSchedulingData","processSchedulingData","end"],"decisionIfWOTypeIdsPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"getWorkOrderIds"},{"exitPortType":"FalseStep","nodeId":"processSiteIdsAndWorkOrderIds"}],"name":"decisionIfWOTypeIdsPresent","description":"decisionIfWOTypeIdsPresent","processRule":"(typeof contextVar.workOrderType !== 'undefined' && contextVar.workOrderType !== '' && contextVar.workOrderType.length > 0 )","id":"decisionIfWOTypeIdsPresent","nodeType":"DECISION"},"processSchedulingData":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"processSchedulingData","description":"processSchedulingData","processRule":"{if(!Array.isArray(contextVar.schedulingAndDispatchData)){contextVar.schedulingAndDispatchData = []; }}","nodeType":"PROCESS"},"decisionIfAllGroupApplied":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processZRule"},{"exitPortType":"FalseStep","nodeId":"decisionIfRegionIdsPresent"}],"name":"decisionIfAllGroupApplied","description":"decides if ALL group filter added","processRule":"(typeof contextVar.isAllFilterApplied !== 'undefined' && contextVar.isAllFilterApplied ===true)","id":"decisionIfAllGroupApplied","nodeType":"DECISION"},"decisionIfRegionIdsPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processFilterForSiteQuery"},{"exitPortType":"FalseStep","nodeId":"decisionIfWOTypeIdsPresent"}],"name":"decisionIfRegionIdsPresent","description":"check if region ids exist","processRule":"((typeof contextVar.region !== 'undefined' && contextVar.region !== '' && contextVar.region.length > 0 )|| (typeof contextVar.customer !== 'undefined' && contextVar.customer !== '' && contextVar.customer.length > 0))","id":"decisionIfRegionIdsPresent","nodeType":"DECISION"},"workflowContext":{"count":0},"decisionIfWorkforceWorkGroupDataPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processWorkforceWorkGroupData"},{"exitPortType":"FalseStep","nodeId":"processZRule"}],"name":"decisionIfWorkforceWorkGroupDataPresent","description":"check if work group data exists","processRule":"(typeof contextVar.workforceWorkGroupDataforDisptacher !== 'undefined' && contextVar.workforceWorkGroupDataforDisptacher.length > 0 && typeof contextVar.workforceWorkGroupDataFortechnician !== 'undefined' && contextVar.workforceWorkGroupDataFortechnician.length > 0)","id":"decisionIfAllGroupApplied","nodeType":"DECISION"},"end":{"name":"End","description":"end","inputVarMap":{"count":"count","schedulingAndDispatchData":"openTasksData"},"outputVarMap":{"count":"count","schedulingAndDispatchData":"openTasksData"},"id":"end","nodeType":"END"},"getWorkOrderIds":{"filter":"{$workOrderWorkOrderTypeId} IN {@workOrderType}","models":["workOrder"],"connectors":[{"exitPortType":"NextStep","nodeId":"processSiteIdsAndWorkOrderIds"}],"columns":{"workOrderWorkOrderTypeId":"workOrder.workOrderTypeId","workOrderId":"workOrder.id"},"name":"getWorkOrderIds","description":"fetch workOrder ids for given workOrderType ids","inputVarMap":{"workOrderType":"workOrderType"},"outputVarMap":{"data":"workOrderIds"},"nodeType":"QUERY"},"processZRule":{"connectors":[{"exitPortType":"NextStep","nodeId":"processFilter"}],"contextChangePermitted":true,"name":"processZRule","description":"ZRule to create dynamic filter","processRule":"@PUQ89KC4I4","nodeType":"PROCESS","jsEngine":"es6"}}