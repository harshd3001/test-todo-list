{"pageContext":{},"actionOnLoad":["@actions.initialData"],"localPageContext":true,"jslib":{"isAnyMaterialStockAction":"function(pageContext){return (pageContext.materialStockAction == 'add' || pageContext.materialStockAction == 'edit');}","isMaterialStockActionEdit":"function(pageContext){return (pageContext.materialStockAction == 'edit');}","validateQuantity":"function(pageContext) { if (typeof pageContext.inventoryQuantity !== 'undefined' && pageContext.inventoryQuantity !== '') { if ((!isNaN(pageContext.inventoryQuantity) && pageContext.inventoryQuantity.toString().indexOf('.') != -1) || Number(pageContext.inventoryQuantity) <= 0) { return true; } } else { return false; } }","isSaveEditDisabled":"function(pageContext) { return (typeof pageContext.inventoryQuantity === 'undefined' || pageContext.inventoryQuantity === '' || (!isNaN(pageContext.inventoryQuantity) && pageContext.inventoryQuantity.toString().indexOf('.') != -1) || Number(pageContext.inventoryQuantity) <= 0 || (Number(pageContext.initialInventoryQuantity) === Number(pageContext.inventoryQuantity) && pageContext.materialStockAction == 'edit')) }","dynamicHeaderText":"function(pageContext){if(pageContext.materialAction == 'add' || pageContext.materialStockAction === 'add'){return '@lang.[\"anm1\",\"Add New Material\"]'} else if (pageContext.materialStockAction === 'edit'){return '@lang.[\"em1\",\"Edit Material\"]'}}","isAnyActionEdit":"function(pageContext){return (pageContext.materialAction == 'add' || pageContext.materialStockAction == 'add' || pageContext.materialAction == 'addInitial');}","isSaveAddDisabled":"function(pageContext) { return (typeof pageContext.inventoryQuantity == 'undefined' || pageContext.inventoryQuantity === '' || typeof pageContext.catalogId === 'undefined' || pageContext.catalogId === '' || typeof pageContext.inventorySiteId === 'undefined' || pageContext.inventorySiteId === '' || (!isNaN(pageContext.inventoryQuantity) && pageContext.inventoryQuantity.toString().indexOf('.') != -1) || Number(pageContext.inventoryQuantity) <= 0) }","isAnyMaterialAction":"function(pageContext){return (pageContext.materialAction == 'add'|| pageContext.materialAction == 'addInitial');}","isSidePanelSaveHidden":"function(pageContext){return (pageContext.materialAction == 'edit' || pageContext.materialAction == 'editInitial');}"},"header":{"leftData":{"children":[{"hidden":"@jslib.isAnyMaterialAction","name":"back","icon":"@iconlib.NavigationArrowBackGrey","actionOnClick":["@actions.resetInventoryQuantity","@actions.openPreviousPanel","@actions.refreshMaterialDataGrid"],"type":"buttonIcon"}]},"children":[{"buttonType":"primary","hidden":"@jslib.isSidePanelSaveHidden","actionOnClick":["@actions.setSubActionUpsertInventoryMaterialAdd","@actions.fireProcessEvent","@actions.closePanel","@actions.refreshMaterialDataGrid"],"disabled":"@jslib.isSaveAddDisabled","id":"submitInventory","type":"button","title":"@lang.['s12','Save']"},{"buttonType":"primary","hidden":"@jslib.isAnyMaterialAction","actionOnClick":["@actions.setSubActionUpsertInventory","@actions.fireProcessEvent","@actions.setUpdatedQuantity","@actions.openPreviousPanel","@actions.refreshMaterialDataGrid","@actions.refreshMaterialStockDatagrid"],"disabled":"@jslib.isSaveEditDisabled","id":"submitInventorySP","type":"button","title":"@lang.['s12','Save']"},{"hidden":"@jslib.isAnyMaterialStockAction","icon":"@iconlib.NavigationCloseGrey","actionOnClick":["@actions.refreshMaterialDataGrid","@actions.closePanel"],"id":"close","type":"buttonIcon"}],"title":"@jslib.dynamicHeaderText"},"body":{"children":[{"children":[{"actionOnChange":["@actions.setCatalogId","@actions.fetchCatalogData","@actions.setCatalogData"],"hidden":"@jslib.isAnyMaterialStockAction","optLabelMap":"catalogName","optValueMap":"catalogId","isMainPage":false,"label":"@lang.['mn','Model Name']","type":"selectDropdown","isMultiSelect":false,"searchByOptions":{"dataSourceId":"process/start","sourceType":"api","columns":["catalogId","catalogName","catalogModelNumber","manufacturerName"],"dataToBeSent":{"apiResponseParams":["count"],"inputVar":{},"processId":"KUK08XW4QQ","apiResponseFormat":true,"contextVar":{"filter":"({$catalogTypeId} like 'material') AND ({$catalogName} like {@searchText} OR {$catalogModelNumber} like {@searchText})"},"apiResponseObject":"catalogData"}},"isAdvanceSearch":{"selectedRowAdvanceGrid":"AdvancedGridCatalog","rowsToBeSelect":"selectedId","columnsNotSelected":["catalogModelNumber","manufacturerName","catalogTypeName","stockUnitName","catalogCustomerPrice","catalogUnitPrice"],"tableHeaderDisplayOrder":["catalogName","catalogModelNumber","manufacturerName"],"rowsToSelectSourceType":"pageContext","customColumns":{"catalogName":"@lang.['mn','Model Name']","manufacturerName":"@lang.['m','Manufacturer']","catalogModelNumber":"@lang.['mn1','Model Number']"},"filter":"({$catalogTypeId} like 'material') ","rowsToSelect":"@pageContext.catalogIdArray","columnsToBeHidden":["catalogId"],"dataSourceId":"pageContext","rowsToSelectSourceId":"process/start","sidePanelTitle":"@lang.['sm3','Select Model']","gridHeaderText":"@lang.['navC4','Catalog']","searchKeys":["catalogName","catalogModelNumber","manufacturerName"]},"id":"catalogName","placeholder":"@lang.['smn','Select model name']","value":"@pageContext.catalogDropdownData"},{"hidden":"@jslib.isAnyMaterialStockAction","disabled":true,"inputType":"text","id":"modelNumber","label":"@lang.['mn1','Model Number']","placeholder":"@lang.['mnwbabosm','Model number will be autofilled based on selected model']","type":"input","value":"@pageContext.catalogModelNumber"},{"hidden":"@jslib.isAnyMaterialStockAction","disabled":true,"inputType":"text","id":"manufacturer","label":"@lang.['m','Manufacturer']","placeholder":"@lang.['mwbabosm','Manufacturer will be autofilled based on selected model']","type":"input","value":"@pageContext.manufacturerName"},{"isRequired":true,"actionOnChange":["@actions.setSelectedSiteData"],"isMultiSelect":false,"searchByOptions":{"dataSourceId":"process/start","sourceType":"api","columns":[],"dataToBeSent":{"apiResponseParams":["count"],"inputVar":{},"processId":"UXT3UYWAPW","apiResponseFormat":true,"contextVar":{"filter":"({$siteName} like {@searchText} OR {$siteAddress} like {@searchText})"},"apiResponseObject":"sitesData"}},"optLabelMap":"siteName","optValueMap":"siteId","hidden":"@jslib.isAnyMaterialStockAction","id":"siteName","label":"@lang.['navSL1','Stock Location']","placeholder":"@lang.['ssl1','Select stock location']","type":"selectDropdown","value":"@pageContext.siteDropdownData"},{"hidden":"@jslib.isAnyMaterialAction","disabled":true,"inputType":"text","id":"stockLocationName","label":"@lang.['navSL1','Stock Location']","placeholder":"@lang.['ssl1','Select stock location']","type":"input","value":"@pageContext.siteName"},{"disabled":true,"inputType":"text","id":"stockUnit","label":"@lang.['su1','Stock Unit']","placeholder":"@lang.['abosm','Autofilled based on selected material']","type":"input","value":"@pageContext.stockUnit"},{"errorText":"@lang.['epevq','Error! Please enter valid quantity']","hidden":"@jslib.isMaterialStockActionEdit","validator":"@jslib.validateQuantity","inputType":"number","id":"quantity","label":"@lang.['q','Quantity']","placeholder":"@lang.['eq','Enter quantity']","type":"input","value":"@pageContext.inventoryQuantity"},{"hidden":"@jslib.isAnyActionEdit","inputType":"number","disabled":"@jslib.isMaterialStockActionEdit","id":"initialInventoryQuantity","label":"@lang.['q','Quantity']","placeholder":"@lang.['eq','Enter quantity']","type":"input","value":"@pageContext.initialInventoryQuantity"},{"errorText":"@lang.['epevq','Error! Please enter valid adjusted quantity']","hidden":"@jslib.isAnyActionEdit","validator":"@jslib.validateQuantity","inputType":"number","id":"adjustedQuantity","label":"@lang.['aq','Adjusted Quantity']","placeholder":"@lang.['eq','Enter quantity']","type":"input","value":"@pageContext.inventoryQuantity"}],"label":"@lang.['md','Material Details']","id":"matetialDetail","type":"section"}]},"actions":[{"name":"setSelectedSiteData","type":"script","actionDef":"function(pageContext){if(pageContext.siteDropdownData[0] !== null){pageContext.inventorySiteId=pageContext.siteDropdownData[0].value;} else {pageContext.inventorySiteId=''}}"},{"name":"setUpdatedQuantity","type":"script","actionDef":"function(pageContext){pageContext.inventoryQuantity = (pageContext.data && pageContext.data[0].data &&  pageContext.data[0].data[0].inventoryOutput) ? pageContext.data[0].data[0].inventoryOutput[0].inventoryQuantity : pageContext.inventoryQuantity;}"},{"name":"closePanel","type":"closePanel"},{"name":"initialData","type":"script","actionDef":"function (pageContext) { if (pageContext.materialStockAction == 'add') { pageContext.stockUnit = pageContext.stockUnitName; pageContext.initialInventoryQuantity = pageContext.inventoryQuantity; pageContext.inventoryQuantity = ''; pageContext.inventoryId = ''; pageContext.catalogId = pageContext.inventoryCatalogId; } else if (pageContext.materialStockAction == 'edit') { pageContext.stockUnit = pageContext.stockUnitName; pageContext.initialInventoryQuantity = pageContext.inventoryQuantity; pageContext.inventoryQuantity = ''; } else if (pageContext.materialAction == 'addInitial') { pageContext.inventoryQuantity = ''; pageContext.inventoryId = ''; pageContext.stockUnit = ''; pageContext.manufacturerName = ''; pageContext.catalogModelNumber = ''; pageContext.siteDropdownData = []; pageContext.siteDropdownData.push({ 'value': pageContext.siteId, 'label': pageContext.siteName }); pageContext.inventorySiteId = pageContext.siteId; pageContext.materialAction = 'add'; } }"},{"endPoint":"process/start","name":"fireProcessEvent","outputVarMap":{"data":"@pageContext.inventoryOutput"},"type":"api","actionDef":{"data":[{"processId":"inventoryPublishEventWF","contextVar":{"subAction":"@pageContext.subAction","inventory":[{"quantity":"@pageContext.inventoryQuantity","catalogId":"@pageContext.catalogId","statusId":"inventoryInStock","statusTargetModel":"inventory","siteId":"@pageContext.inventorySiteId","id":"@pageContext.inventoryId"}]}}]}},{"name":"resetInventoryQuantity","type":"script","actionDef":"function(pageContext){pageContext.inventoryQuantity = pageContext.initialInventoryQuantity;}"},{"name":"setSubActionUpsertInventoryMaterialAdd","type":"script","actionDef":"function(pageContext){pageContext.subAction='upsertInventoryMaterialAdd';}"},{"name":"setSubActionUpsertInventory","type":"script","actionDef":"function(pageContext){if(pageContext.materialStockAction==='edit'){pageContext.subAction='upsertInventory';}else{pageContext.subAction='upsertInventoryMaterialAdd';}}"},{"name":"refreshMaterialDataGrid","gridId":["materialStock"],"type":"RefreshGridOnSidePanel"},{"name":"setCatalogData","type":"script","actionDef":"function (pageContext) { if (Array.isArray(pageContext.catalogData)) { pageContext.catalogName = pageContext.catalogData[0].catalogData[0].catalogName; pageContext.catalogModelNumber = pageContext.catalogData[0].catalogData[0].catalogModelNumber; pageContext.manufacturerName = pageContext.catalogData[0].catalogData[0].manufacturerName; pageContext.stockUnit = pageContext.catalogData[0].catalogData[0].stockUnitName; } if ((typeof pageContext.catalogDropdownData === 'undefined' || pageContext.catalogDropdownData === '' || pageContext.catalogDropdownData.toString() === '{}' || pageContext.catalogDropdownData[0] === null) && (pageContext.inventoryRequestData == 'undefined' && !pageContext.inventoryRequestData.length)) { pageContext.catalogModelNumber = '-'; pageContext.manufacturerName = '-'; pageContext.catalogName = ''; } }"},{"endPoint":"process/start","name":"fetchCatalogData","outputVarMap":{"data":"@pageContext.catalogData"},"type":"api","actionDef":{"data":[{"inputVar":{},"processId":"KUK08XW4QQ","apiResponseFormat":true,"contextVar":{"filter":"({$catalogTypeId} like 'material') AND {$catalogId} = {@searchText}","searchText":"@pageContext.catalogId"}}]}},{"name":"setCatalogId","type":"script","actionDef":"function (pageContext) { pageContext.catalogId = ''; pageContext.catalogIdArray = []; if (typeof pageContext.catalogDropdownData !== 'undefined' && pageContext.catalogDropdownData !== '' && pageContext.catalogDropdownData.toString() !== '{}' && pageContext.catalogDropdownData[0] !== null) { pageContext.catalogId = pageContext.catalogDropdownData[0].value; pageContext.fetchCatalogData = true; pageContext.catalogIdArray.push({ 'catalogId': pageContext.catalogId, 'catalogName': pageContext.catalogDropdownData[0].label }); } }"},{"name":"refreshMaterialStockDatagrid","gridId":["materialStockDataGrid"],"type":"RefreshGridOnSidePanel"},{"name":"openPreviousPanel","type":"backPanel","requiredPageContextKeys":"[\"inventoryQuantity\"]"},{"name":"clearPageContext","type":"clearPageContext"},{"name":"refreshDataGrid","type":"refreshDataGrid"}]}