{"pageContext":{},"actionOnLoad":["@actions.fetchSelectedTaskTypes","@actions.setInitialData"],"localPageContext":true,"jslib":{"isAddTaskTypeDisabled":"function (pageContext) { if (Array.isArray(pageContext.initialSelectedRowIdsArray) && Array.isArray(pageContext.selectedRowIds)) { if (_(pageContext.initialSelectedRowIdsArray).xorWith(pageContext.selectedRowIds, _.isEqual).isEmpty()) { return true; } else { return false; } } }"},"header":{"leftData":{"children":[{"name":"back","icon":"@iconlib.NavigationArrowBackGrey","actionOnClick":["@actions.openPreviousPanel"],"type":"buttonIcon"}]},"children":[{"buttonType":"primary","actionOnClick":["@actions.setSubAction","@actions.comparePreviousTaskTypeId","@actions.fireProcessEvent","@actions.openPreviousPanel","@actions.refreshDataGrid"],"disabled":"@jslib.isAddTaskTypeDisabled","id":"submit","type":"button","title":"@lang.['s12','Save']"},{"icon":"@iconlib.NavigationCloseGrey","actionOnClick":["@actions.closePanel"],"id":"close","type":"buttonIcon"}],"title":"@lang.['ett','Edit Task Type']"},"body":{"children":[{"label":"@lang.['s16','Search']","id":"taskTypeDataGrid","type":"datagrid","jsonDef":{"isScrollAble":false,"tableWidth":"60rem","searchAllowed":true,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY']","type":"noData"},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"tableHeader":[{"name":"@lang.['i4','Id']","options":{"hidden":true,"showLabel":false},"key":"taskTypeId","primaryKey":true},{"name":"@lang.['s','Status']","options":{"flex":1.5,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"taskTypeStatus"},{"name":"@lang.['n','Name']","options":{"flex":1.5,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"taskTypeName"},{"name":"@lang.['taskType','Task Type']","options":{"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"taskTypeType"},{"name":"@lang.['d','Description']","options":{"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"taskTypeDescription"}],"dataToBeSent":{"models":["taskType"],"columns":{"taskTypeType":"IF({$taskType.webTask}=true,'Web','Mobile')","taskTypeDescription":"taskType.description","taskTypeId":"taskType.id","taskTypeStatus":"IF({$taskType.statusId}='taskTypeDeactivated','Deactivated','Active')","taskTypeName":"taskType.name","taskTypeRecver":"taskType.recver"},"name":"taskTypeDataList","orderBy":"taskTypeName ASC","distinct":true,"translate":true},"rowsToSelect":{"filter":"{$workOrderTypeTaskType.workOrderTypeId} = {@idFilter}","models":["taskType","workOrderTypeTaskType"],"columns":{"taskTypeType":"IF({$taskType.webTask}=true,'Web','Mobile')","taskTypeDescription":"taskType.description","taskTypeId":"taskType.id","taskTypeName":"taskType.name","taskTypeRecver":"taskType.recver"},"inputs":{"idFilter":"@pageContext.workOrderTypeId"},"name":"gettaskTypeList","orderBy":"taskTypeName ASC","distinct":true,"description":"gettaskTypeList","links":{"taskType":"workOrderTypeTaskType"},"getCount":true,"translate":true},"dataSourceId":"query/read","rowTextLength":50,"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['navTT','Task Types']"},"isSelectable":true,"updateAllowed":true,"actions":[],"searchKeys":["taskTypeName"]}}],"label":"Task Type","id":"taskTypeDataGrid","type":"section","transparent":true},"updateAllowed":true,"isSelectable":true,"actions":[{"name":"openPreviousPanel","type":"backPanel"},{"name":"setSubAction","type":"script","actionDef":"function(pageContext){pageContext.subAction='upsertWorkOrderTypeTaskType';}"},{"endPoint":"process/start","name":"fireProcessEvent","outputVarMap":{"data":"@pageContext.workOrderTaskTypeList"},"type":"api","actionDef":{"data":[{"processId":"workOrderTypeTaskTypeWF","contextVar":{"subAction":"@pageContext.subAction","workOrderTypeTaskType":[{"workOrderTypeId":"@pageContext.workOrderTypeId","removeTaskTypeList":"@pageContext.unSelectedList","taskTypeList":"@pageContext.selectedRowIds"}]}}]}},{"name":"fetchSelectedTaskTypes","outputVarMap":{"data":"@pageContext.taskTypeList"},"type":"query","actionDef":{"filter":"{$workOrderTypeId} = {@idFilter}","models":["workOrderTypeTaskType","workOrderType","taskType"],"inputs":{"idFilter":"@pageContext.workOrderTypeId"},"columns":{"workOrderTypeId":"workOrderType.id","workOrderTypeTaskTypeId":"workOrderTypeTaskType.taskTypeId","taskTypeName":"taskType.name","workOrderTypeTaskTypeRecver":"workOrderTypeTaskType.recver"},"orderBy":"taskTypeName ASC","links":{"taskType":"workOrderTypeTaskType","workOrderType":"workOrderTypeTaskType"}}},{"name":"setInitialData","type":"script","actionDef":"function(pageContext) { pageContext.initialSelectedRowIdsArray = []; if (typeof pageContext.taskTypeList !== 'undefined' && pageContext.taskTypeList !== '' && pageContext.taskTypeList.length!==0) { for (var i = 0; i < pageContext.taskTypeList.length; i++) { pageContext.initialSelectedRowIdsArray.push({ 'taskTypeId': pageContext.taskTypeList[i].workOrderTypeTaskTypeId }); } } }"},{"name":"comparePreviousTaskTypeId","type":"script","actionDef":"function(pageContext) { pageContext.selectedList = []; pageContext.selectedRowIds.map(select => pageContext.selectedList.push({ workOrderTypeTaskTypeId: select.workOrderTypeTaskTypeId })); pageContext.unSelectedList = []; var props = ['workOrderTypeTaskTypeId', 'workOrderTypeId', 'workOrderTypeTaskTypeRecver']; var result = pageContext.taskTypeList.filter(function(o1) { return !pageContext.selectedRowIds.some(function(o2) { return o1.workOrderTypeTaskTypeId === o2.workOrderTypeTaskTypeId }) }).map(function(o) { return props.reduce(function(newo, name) { newo[name] = o[name]; return newo }, {}) }); pageContext.unSelectedList = result; }"},{"name":"closePanel","type":"closePanel"},{"name":"refreshDataGrid","type":"refreshDataGrid"}]}