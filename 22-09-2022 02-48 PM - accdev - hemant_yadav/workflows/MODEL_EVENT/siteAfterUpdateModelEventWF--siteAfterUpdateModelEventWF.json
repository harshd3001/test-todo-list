{"processInputData":{"connectors":[{"exitPortType":"NextStep","nodeId":"checkIfLocationHasChanged"}],"contextChangePermitted":true,"name":"processInputData","description":"processInputData","processRule":"{ for (const key in contextVar.data) { contextVar[key] = contextVar.data[key]; } contextVar.location = contextVar.latitude + ',' + contextVar.longitude; contextVar.timestamp = Math.floor(Date.now() / 1000); contextVar.language = 'en'; }","nodeType":"PROCESS","jsEngine":"es6"},"callSiteUpsertWF":{"eventId":"siteModelUpsertEvent","connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"multirecord":true,"name":"callSiteUpsertWF","description":"callSiteUpsertWF","inputVarMap":{"siteJsonObj":"siteJsonObj"},"outputVarMap":{},"nodeType":"PUBLISH"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"processInputData"}],"name":"start","description":"start","nodeType":"START"},"checkIfLocationHasChanged":{"connectors":[{"exitPortType":"TrueStep","nodeId":"fetchTimeZoneOffset"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"checkIfLocationHasChanged","description":"checkIfLocationHasChanged","processRule":"typeof contextVar.latitude !== 'undefined' && contextVar.latitude!=='' && typeof contextVar.longitude!=='undefined' && contextVar.longitude!=='' && (typeof contextVar.latLong ==='undefined' || contextVar.latLong==='' || contextVar.location!==contextVar.latLong)","nodeType":"DECISION"},"decisionNodeForUpsert":{"connectors":[{"exitPortType":"TrueStep","nodeId":"callSiteUpsertWF"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"decisionNodeForUpsert","description":"decisionNodeForUpsert","processRule":"contextVar.siteJsonObj.length > 0","nodeType":"DECISION"},"end":{"name":"end","description":"end","inputVarMap":{},"outputVarMap":{},"nodeType":"END"},"processTimeZoneData":{"connectors":[{"exitPortType":"NextStep","nodeId":"decisionNodeForUpsert"}],"contextChangePermitted":true,"name":"processTimeZoneData","description":"processTimeZoneData","processRule":"{ contextVar.siteJsonObj = []; if (contextVar.timeZoneOffsetData.length > 0) { if (contextVar.timeZoneOffsetData[0].status == 'OK') { if (contextVar.timeZoneOffsetData[0].dstOffset > 0) { contextVar.latestTimeZoneOffset = -((contextVar.timeZoneOffsetData[0].rawOffset + contextVar.timeZoneOffsetData[0].dstOffset) / 60); } else { contextVar.latestTimeZoneOffset = -(contextVar.timeZoneOffsetData[0].rawOffset / 60); } contextVar.siteJsonObj.push({ 'id': contextVar.id, 'timezoneOffset': contextVar.latestTimeZoneOffset, 'latLong':contextVar.location }); } } }","nodeType":"PROCESS","jsEngine":"es6"},"workflowNodes":["start","processInputData","checkIfLocationHasChanged","fetchTimeZoneOffset","processTimeZoneData","decisionNodeForUpsert","callSiteUpsertWF","end"],"fetchTimeZoneOffset":{"connectors":[{"exitPortType":"NextStep","nodeId":"processTimeZoneData"}],"name":"fetchTimeZoneOffset","description":"fetchTimeZoneOffset","networkId":"UH6NLJO3AC","inputVarMap":{"location":"location","language":"language","timestamp":"timestamp"},"outputVarMap":{"data":"timeZoneOffsetData"},"nodeType":"NETWORK"}}