{"loopThroughTasksList":{"connectors":[{"exitPortType":"TrueStep","nodeId":"forEachInstance"},{"exitPortType":"FalseStep","nodeId":"end"}],"data":"tasksList","name":"loopThroughTasksList","description":"loopThroughTasksList","inputVarMap":{},"outputVarMap":{},"nodeType":"FOREACHLOOP"},"forEachInstance":{"connectors":[{"exitPortType":"NextStep","nodeId":"createPdf"}],"contextChangePermitted":true,"name":"forEachInstance","description":"forEachInstance","processRule":"{ contextVar.taskId = contextVar.loopThroughTasksList_currentElement.taskId; contextVar.taskType = contextVar.loopThroughTasksList_currentElement.taskType; contextVar.scheduledDate = contextVar.loopThroughTasksList_currentElement.scheduledDate; contextVar.endDate = contextVar.loopThroughTasksList_currentElement.endDate; contextVar.technicianName = contextVar.loopThroughTasksList_currentElement.technicianName; contextVar.customerSignature = contextVar.loopThroughTasksList_currentElement.customerSignature; contextVar.beforeCaptureEvidencePhoto1 = ''; contextVar.beforeCaptureEvidencePhoto2 = ''; contextVar.afterCaptureEvidencePhoto1 = ''; contextVar.afterCaptureEvidencePhoto2 = ''; if (contextVar.loopThroughTasksList_currentElement.result != undefined) {  contextVar.allTasksData='';contextVar.beforeCaptureEvidencePhoto1 = contextVar.loopThroughTasksList_currentElement.result[0].beforeCaptureEvidence.media; contextVar.beforeCaptureEvidenceComments1 = contextVar.loopThroughTasksList_currentElement.result[0].beforeCaptureEvidence.comment; contextVar.beforeCaptureEvidencePhoto2 = contextVar.loopThroughTasksList_currentElement.result[0].beforeCaptureEvidenceOptionalFirst.media; if (contextVar.loopThroughTasksList_currentElement.result[0].beforeCaptureEvidenceOptionalFirst.comment !== undefined && contextVar.loopThroughTasksList_currentElement.result[0].beforeCaptureEvidenceOptionalFirst.comment !== '') { contextVar.beforeCaptureEvidenceComments2 = contextVar.loopThroughTasksList_currentElement.result[0].beforeCaptureEvidenceOptionalFirst.comment; } else { contextVar.beforeCaptureEvidenceComments2 = 'No comments available'; } if (contextVar.loopThroughTasksList_currentElement.result[0].beforeComments !== undefined && contextVar.loopThroughTasksList_currentElement.result[0].beforeComments !== '') { contextVar.beforeCaptureOverAllComments = contextVar.loopThroughTasksList_currentElement.result[0].beforeComments; } else { contextVar.beforeCaptureOverAllComments = 'No comments available'; } contextVar.afterCaptureEvidencePhoto1 = contextVar.loopThroughTasksList_currentElement.result[0].afterCaptureEvidence.media; contextVar.afterCaptureEvidenceComments1 = contextVar.loopThroughTasksList_currentElement.result[0].afterCaptureEvidence.comment; contextVar.afterCaptureEvidencePhoto2 = contextVar.loopThroughTasksList_currentElement.result[0].afterCaptureEvidenceOptionalFirst.media; if (contextVar.loopThroughTasksList_currentElement.result[0].afterCaptureEvidenceOptionalFirst.comment !== undefined && contextVar.loopThroughTasksList_currentElement.result[0].afterCaptureEvidenceOptionalFirst.comment !== '') { contextVar.afterCaptureEvidenceComments2 = contextVar.loopThroughTasksList_currentElement.result[0].afterCaptureEvidenceOptionalFirst.comment; } else { contextVar.afterCaptureEvidenceComments2 = 'No comments available'; } if (contextVar.loopThroughTasksList_currentElement.result[0].afterComments !== undefined && contextVar.loopThroughTasksList_currentElement.result[0].afterComments !== '') { contextVar.afterCaptureOverAllComments = contextVar.loopThroughTasksList_currentElement.result[0].afterComments; } else { contextVar.afterCaptureOverAllComments = 'No comments available'; } for (var k = 0; k < contextVar.loopThroughTasksList_currentElement.result[0].activityDataGrid.length; k++) { var appendBody = new String(contextVar.allTasksBody); appendBody = appendBody.replace('SERVICETYPE', contextVar.loopThroughTasksList_currentElement.result[0].activityDataGrid[k].taskActivity[0].serviceName); appendBody = appendBody.replace('ASSET', contextVar.loopThroughTasksList_currentElement.result[0].activityDataGrid[k].assets[0].catalogName); appendBody = appendBody.replace('ASSETNO', contextVar.loopThroughTasksList_currentElement.result[0].activityDataGrid[k].barcode); if (contextVar.loopThroughTasksList_currentElement.result[0].activityDataGrid[k].activityComments !== undefined && contextVar.loopThroughTasksList_currentElement.result[0].activityDataGrid[k].activityComments != '') { appendBody = appendBody.replace('SERVICECOMMENTS', contextVar.loopThroughTasksList_currentElement.result[0].activityDataGrid[k].activityComments); } else { appendBody = appendBody.replace('SERVICECOMMENTS', 'No comments available'); } contextVar.allTasksData = contextVar.allTasksData + appendBody; } } if (contextVar.beforeCaptureEvidencePhoto1 !== undefined && contextVar.beforeCaptureEvidencePhoto1 !== '') { contextVar.images.push(contextVar.beforeCaptureEvidencePhoto1); } if (contextVar.beforeCaptureEvidencePhoto2 !== undefined && contextVar.beforeCaptureEvidencePhoto2 !== '') { contextVar.images.push(contextVar.beforeCaptureEvidencePhoto2); } if (contextVar.afterCaptureEvidencePhoto1 !== undefined && contextVar.afterCaptureEvidencePhoto1 !== '') { contextVar.images.push(contextVar.afterCaptureEvidencePhoto1); } if (contextVar.afterCaptureEvidencePhoto2 !== undefined && contextVar.afterCaptureEvidencePhoto2 !== '') { contextVar.images.push(contextVar.afterCaptureEvidencePhoto2); } if (contextVar.customerSignature !== undefined && contextVar.customerSignature !== '') { contextVar.images.push(contextVar.customerSignature); } var allTaskDetails = { 'taskId': contextVar.taskId }; contextVar.taskDetailsWithUrl.push(allTaskDetails);}","nodeType":"PROCESS"},"updateTasksPDFURL":{"modelName":"workOrderTask","connectors":[{"exitPortType":"NextStep","nodeId":"loopThroughTasksList"}],"name":"updateTasksPDFURL","description":"updateTasksPDFURL","inputVarMap":{"pdfUrl":"cop","taskId":"id"},"id":"updateTaskStatus","outputVarMap":{"data":"data"},"nodeType":"MODEL","operation":4},"workflowContext":{"allTasksData":"","images":[],"taskDetailsWithUrl":[],"allTasksBody":"<tr> <td colspan='2'> <div class='outer-border'> <table class='n-bordered'> <tbody> <tr> <td class='left-info-color'>Service Type<\/td> <td class='right-information'>SERVICETYPE<\/td> <\/tr> <tr> <td class='left-info-color'>Asset<\/td> <td class='right-information'>ASSET<\/td> <\/tr> <tr> <td class='left-info-color'>Asset No.<\/td> <td class='right-information'>ASSETNO<\/td> <\/tr> <tr> <td class='left-info-color'>Overall Comments<\/td> <td class='right-information'>SERVICECOMMENTS<\/td> <\/tr><\/tbody> <\/table> <\/div> <\/td> <\/tr> <tr> <td colspan='2'> &nbsp; <\/td> <\/tr>"},"getAllTasks":{"connectors":[{"exitPortType":"NextStep","nodeId":"loopThroughTasksList"}],"contextChangePermitted":true,"name":"getAllTasks","description":"Process All Tasks data","processRule":"{contextVar.tasksList = contextVar.workOrderData;}","id":"getAllTasks","nodeType":"PROCESS"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"getAllTasks"}],"name":"start","description":"start","nodeType":"START"},"end":{"name":"end","description":"End","inputVarMap":{"images":"images"},"outputVarMap":{"images":"images"},"nodeType":"END"},"createPdf":{"async":false,"connectors":[{"exitPortType":"NextStep","nodeId":"updateTasksPDFURL"}],"name":"createPdf","publicFile":true,"description":"CloseOut package","inputVarMap":{"beforeCaptureEvidencePhoto2":"beforeCaptureEvidencePhoto2","allTasksData":"allTasksData","afterCaptureOverAllComments":"afterCaptureOverAllComments","beforeCaptureEvidencePhoto1":"beforeCaptureEvidencePhoto1","beforeCaptureEvidenceComments1":"beforeCaptureEvidenceComments1","beforeCaptureOverAllComments":"beforeCaptureOverAllComments","customerSignature":"customerSignature","beforeCaptureEvidenceComments2":"beforeCaptureEvidenceComments2","afterCaptureEvidencePhoto2":"afterCaptureEvidencePhoto2","afterCaptureEvidenceComments2":"afterCaptureEvidenceComments2","afterCaptureEvidencePhoto1":"afterCaptureEvidencePhoto1","afterCaptureEvidenceComments1":"afterCaptureEvidenceComments1"},"id":"createPdf","outputVarMap":{"pdfFile":"pdfUrl"},"nodeType":"PDF","templateId":"W0AC32AYES"},"workflowNodes":["start","getAllTasks","loopThroughTasksList","forEachInstance","createPdf","updateTasksPDFURL","end"]}