{"pageContext":{},"actionOnLoad":["@actions.fetchSelectedUsers","@actions.setInitialData"],"localPageContext":true,"jslib":{"isAddUsersDisabled":"function (pageContext) { if (Array.isArray(pageContext.initialSelectedRowIdsArray) && Array.isArray(pageContext.selectedRowIds)) { if (_(pageContext.initialSelectedRowIdsArray).xorWith(pageContext.selectedRowIds, _.isEqual).isEmpty()) { return true; } else { return false; } } }"},"header":{"leftData":{"children":[{"name":"back","icon":"@iconlib.NavigationArrowBackGrey","actionOnClick":["@actions.openPreviousPanel"],"type":"buttonIcon"}]},"children":[{"buttonType":"primary","actionOnClick":["@actions.setSubActionInsertWorkforceWorkGroup","@actions.comparePreviousUserId","@actions.fireProcessEvent","@actions.openPreviousPanel","@actions.refreshDataGrid"],"disabled":"@jslib.isAddUsersDisabled","id":"submit","type":"button","title":"@lang.['s12','Save']"},{"icon":"@iconlib.NavigationCloseGrey","actionOnClick":["@actions.closePanel"],"id":"close","type":"buttonIcon"}],"title":"@lang.['em2','Edit Members']"},"body":{"children":[{"label":"@lang.['s16','Search']","id":"usersDataGrid","type":"datagrid","jsonDef":{"isScrollAble":false,"tableWidth":"60rem","searchAllowed":true,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY']","type":"noData"},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"tableHeader":[{"name":"@lang.['i','id']","options":{"hidden":true,"showLabel":false},"key":"workforceUserId","primaryKey":true},{"name":"@lang.['n','Name']","options":{"flex":0.9,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"userName"},{"name":"@lang.['r8','Role']","options":{"flex":0.7,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"workforceRole"},{"name":"@lang.['c','City']","options":{"flex":0.6,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"workforceCity"},{"name":"@lang.['s11','State']","options":{"flex":0.6,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"workforceState"},{"name":"@lang.['e4','Email']","options":{"flex":1.2,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"userEmailId"}],"dataToBeSent":{"filter":"{$User.status}!='Deactivated' AND {$workforce.statusId}!= 'workforceDeactivated'","models":["workforce","User","listOptionAnswer"],"columns":{"workforceCity":"workforce.city","userEmailId":"User.emailId","workforceRole":"listOptionAnswer.answerOptionText","workforceUserId":"workforce.userId","userName":"User.name","workforceState":"workforce.state"},"name":"workforceUserList","outerJoinOnModel":"workforce","distinct":true,"orderBy":"userName ASC","links":{"User":"workforce","workforce":"listOptionAnswer"},"translate":true},"rowsToSelect":{"filter":"{$workforceWorkGroup.workGroupId} = {@idFilter} AND {$User.status}!='Deactivated' AND {$workforce.statusId}!= 'workforceDeactivated'","models":["workforceWorkGroup","workforce","User","listOptionAnswer"],"inputs":{"idFilter":"@pageContext.workGroupId"},"columns":{"workforceCity":"workforce.city","userEmailId":"User.emailId","workforceRole":"listOptionAnswer.answerOptionText","workforceUserId":"workforce.userId","userName":"User.name","workforceState":"workforce.state"},"name":"getUserList","outerJoinOnModel":"workforce","distinct":true,"orderBy":"userName ASC","description":"getUserData","links":{"workforceWorkGroup":"workforce","User":"workforce","workforce":"listOptionAnswer"},"translate":true},"dataSourceId":"query/read","header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['users','Users']"},"isSelectable":true,"actions":[],"searchKeys":["userName","workforceCity","workforceState","userEmailId"]}}],"label":"Users","id":"datagridWorkGroupMembers","type":"section","transparent":true},"updateAllowed":true,"isSelectable":true,"actions":[{"name":"openPreviousPanel","type":"backPanel"},{"name":"setSubActionInsertWorkforceWorkGroup","type":"script","actionDef":"function(pageContext){pageContext.subAction='insertWorkforceWorkGroup';}"},{"endPoint":"event/start","name":"fireProcessEvent","outputVarMap":{"data":"@pageContext.workforceWorkGroupUserList"},"type":"api","actionDef":{"data":[{"eventId":"workforceWorkGroupProcessEvent","contextVar":{"workforceWorkGroup":[{"workforceWorkGroupUserList":"@pageContext.selectedRowIds","removeWorkforceWorkGroupUserList":"@pageContext.unSelectedMembersList","workGroupId":"@pageContext.workGroupId"}],"subAction":"@pageContext.subAction"}}]}},{"name":"fetchSelectedUsers","outputVarMap":{"data":"@pageContext.selectedUserList"},"type":"query","actionDef":{"filter":"{$workGroupId} = {@idFilter} AND {$User.status}!='Deactivated' AND {$workforce.statusId}!= 'workforceDeactivated'","models":["workforceWorkGroup","workforce","User"],"inputs":{"idFilter":"@pageContext.workGroupId"},"columns":{"workforceWorkGroupRecver":"workforceWorkGroup.recver","userName":"User.name","workforceUserId":"workforce.userId","workGroupId":"workforceWorkGroup.workGroupId"},"orderBy":"userName ASC","links":{"workforceWorkGroup":"workforce","User":"workforce"}}},{"name":"setInitialData","type":"script","actionDef":"function(pageContext) { pageContext.initialSelectedRowIdsArray = []; if (typeof pageContext.selectedUserList !== 'undefined' && pageContext.selectedUserList !== '' && pageContext.selectedUserList.length!==0) { for (var i = 0; i < pageContext.selectedUserList.length; i++) { pageContext.initialSelectedRowIdsArray.push({ 'workforceUserId': pageContext.selectedUserList[i].workforceUserId }); } } }"},{"name":"comparePreviousUserId","type":"script","actionDef":"function(pageContext){pageContext.selectedMembersList=[];pageContext.selectedRowIds.map(select=>pageContext.selectedMembersList.push({workforceUserId:select.workforceUserId}));pageContext.unSelectedMembersList=[];var props=['workforceUserId','workGroupId','workforceWorkGroupRecver'];var result=pageContext.selectedUserList.filter(function(o1){return!pageContext.selectedRowIds.some(function(o2){return o1.workforceUserId===o2.workforceUserId})}).map(function(o){return props.reduce(function(newo,name){newo[name]=o[name];return newo},{})});pageContext.unSelectedMembersList=result;}"},{"name":"closePanel","type":"closePanel"},{"name":"refreshDataGrid","type":"refreshDataGrid"}]}