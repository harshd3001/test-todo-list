{"pageContext":{},"actionOnLoad":["@actions.fetchInProgressSchedulerLogData","@actions.decisionIfSchedulerInProgress"],"children":[{"size":"L","id":"workOrderDispatchScheduler","type":"dispatchSchedulerWidget","jsonDef":{"componentType":"DispatchScheduler","customTooltip":{"task":{"footer":[{"buttonType":"primary","hidden":"@jslib.isDispatchButtonHidden","actionOnClick":["@actions.setTaskStatusToDispatched","@actions.fetchTaskDependencyDataForDispatch","@actions.processDependencyDataForDispatch","@actions.fetchTechnicianOnCrew","@actions.decisionActionForTechnicianOnCrew","@actions.refreshScheduler"],"type":"button","title":"@lang.['dtaa1','Dispatch to Appraiser / Analyst']"},{"buttonType":"primary","hidden":"@jslib.showForScheduledStatus","actionOnClick":["@actions.setInitialLoad","@actions.setActionOpenTask","@actions.openScheduleAndAssignSidePanel"],"type":"button","title":"@lang.['vtd','View Task Details']"},{"buttonType":"primary","hidden":"@jslib.showForDispatchedStatus","actionOnClick":["@actions.setInitialLoad","@actions.setActionDispatch","@actions.openScheduleAndAssignSidePanel"],"type":"button","title":"@lang.['vtd','View Task Details']"},{"buttonType":"primary","hidden":"@jslib.showForInProgressStatus","actionOnClick":["@actions.setInitialLoad","@actions.setActionView","@actions.openScheduleAndAssignSidePanel"],"type":"button","title":"@lang.['vtd','View Task Details']"},{"buttonType":"primary","hidden":"@jslib.showForPendingReviewStatus","actionOnClick":["@actions.setActionPendingReview","@actions.setPendingReviewTaskPageId","@actions.openTaskViewSidePanel"],"type":"button","title":"@lang.['tr1','Task Review']"},{"buttonType":"primary","hidden":"@jslib.showForDiscontinuedReviewStatus","actionOnClick":["@actions.setActionPendingReview","@actions.openIncidentReviewSidePanel"],"type":"button","title":"@lang.['ir','Incident Review']"},{"buttonType":"primary","hidden":"@jslib.showForCompletedStatus","actionOnClick":["@actions.setActionCompleted","@actions.setCompletedTaskPageId","@actions.openTaskViewSidePanel"],"type":"button","title":"@lang.['vtd','View Task Details']"}],"header":[{"labelType":"cardHeading","type":"text","value":"taskTypeName"},{"labelType":"cardHeading","type":"text","value":"id"}],"body":[{"hidden":"@jslib.isWarningHidden","type":"alert","value":"alert"},{"statusColor":"statusColor","label":"@lang.['ts2','Task Status']","type":"status","value":"status"},{"label":"@lang.['c16','Customer']","type":"text","value":"customerCompanyName"},{"label":"@lang.['cs','Customer Site']","type":"text","value":"siteName"},{"label":"@lang.['m12','Market']","type":"text","value":"RegionName"},{"hidden":true,"showStartDate":true,"startTime":"scheduledStartTime","label":"@lang.['sset','Scheduled Start & End Time']","endTime":"scheduledEndTime","type":"timeSlot"},{"hidden":"@jslib.isActualTimeHidden","showStartDate":true,"startTime":"actualStartTime","label":"@lang.['aset','Actual Start & End Time']","endTime":"actualEndTime","type":"timeSlot"}]},"emptyCell":{"footer":[{"buttonType":"primary","hidden":true,"actionOnClick":[],"disabled":"@jslib.isFutureTimeFrame","type":"button","title":"@lang.['as2','Auto Schedule']"},{"buttonType":"secondary","actionOnClick":["@actions.openAllOpenTaksSP"],"disabled":"@jslib.isFutureTimeFrame","type":"button","title":"@lang.['oat','Open All Tasks']"}],"header":[{"staticValue":"@lang.['faets','For an empty time slot']","labelType":"cardHeading","label":"@lang.['st10','Schedule Task']","type":"text","value":"id"}],"body":[{"staticValue":"@lang.['ycsiaptf','You cannot schedule in a past time frame']","hidden":"@jslib.isPastTimeFrame","type":"alert","value":"alertValue"},{"label":"@lang.['st7','Start Time']","type":"time","value":"startTime"}]}},"filterIconClick":["@actions.openFilterTechniciansSP"],"dataToBeSent":{"processId":"TG8NYP8B10","apiResponseFormat":true,"contextVar":{"assignedToUserId":"abc"},"apiResponseObject":"techAndTaskData"},"endHour":"23:59","dataSourceId":"process/start","sourceType":"api","startHour":"00:00","jslib":{"isPastTimeFrame":"function(pageContext) { const currentDate = new Date().toISOString().replace(/T/, ' ').replace(/\\..+/, '').replace(/Z/, ''); const selectedDate = new Date(pageContext.startTime).toISOString().replace(/T/, ' ').replace(/\\..+/, '').replace(/Z/, ''); if (selectedDate > currentDate) { return true } else { return false } }","showForInProgressStatus":"function(pageContext){return !(pageContext.statusId==='workOrderTaskInProgress'||pageContext.statusId==='workOrderTaskInTransit'||pageContext.statusId==='workOrderTaskIncident'||pageContext.statusId==='workOrderTaskDelayed');}","showForDispatchedStatus":"function(pageContext){ if(pageContext.statusId !== 'workOrderTaskDispatched'){return true;}return false}","showForPendingReviewStatus":"function(pageContext){ if(pageContext.statusId !== 'workOrderTaskPendingReview'){return true;}return false}","isActualTimeHidden":"function(pageContext){ return true;/* remove the line before this comment when the UTC to local time fixes are done by platform*/ if(pageContext.statusId !== 'workOrderTaskCompleted' && pageContext.statusId !== 'workOrderTaskPendingReview'){return true;}return false}","showForCompletedStatus":"function(pageContext){ if(pageContext.statusId !== 'workOrderTaskCompleted'){return true;}return false}","showLatLng":"function(pageContext){const coords=[0,0];if((typeof pageContext.selectedRowIds!==undefined)&&(pageContext.selectedRowIds.length>0)){if((typeof pageContext.selectedRowIds[0].latitude!==undefined)&&(typeof pageContext.selectedRowIds[0].longitude!==undefined)){coords[0]=pageContext.selectedRowIds[0].latitude;coords[1]=pageContext.selectedRowIds[0].longitude;}return coords;}return coords;}","showForDiscontinuedReviewStatus":"function(pageContext){ if(pageContext.statusId !== 'workOrderTaskDiscontinued'){return true;}return false}","isDispatchButtonHidden":"function(pageContext) { const currentDate = new Date().toISOString().replace(/T/, ' ').replace(/\\..+/, '').replace(/Z/, ''); const selectedDate = new Date(pageContext.startTime).toISOString().replace(/T/, ' ').replace(/\\..+/, '').replace(/Z/, ''); if (selectedDate < currentDate || pageContext.statusId !== 'workOrderTaskScheduled' || (typeof pageContext.crewTask !== 'undefined' && pageContext.crewTask)) { return true; } else { return false; } }","isWarningHidden":"function(pageContext){ if(typeof pageContext.alert === 'undefined' || pageContext.alert === ''){return true;}return false}","isFutureTimeFrame":"function(pageContext) { const currentDate = new Date().toISOString().replace(/T/, ' ').replace(/\\..+/, '').replace(/Z/, ''); const selectedDate = new Date(pageContext.startTime).toISOString().replace(/T/, ' ').replace(/\\..+/, '').replace(/Z/, ''); if (selectedDate < currentDate) { return true } else { return false } }","showForScheduledStatus":"function(pageContext){ if(pageContext.statusId !== 'workOrderTaskScheduled'){return true;}return false}","isRegionHidden":"function(pageContext){ if(pageContext.statusId !== 'workOrderTaskScheduled' || pageContext.statusId !== 'workOrderTaskDispatched'){return true;}return false}"},"header":{"subHeaderText":"@lang.['aa1','Appraiser / Analyst']","headerText":"@lang.['s3','Scheduler']"},"actions":[{"name":"openTaskViewSidePanel","type":"openPanel","pageId":"@pageContext.workOrderTaskPageId"},{"name":"setCompletedTaskPageId","type":"script","actionDef":"function(pageContext){pageContext.workOrderTaskPageId=pageContext.resultWebPageId;}"},{"name":"setPendingReviewTaskPageId","type":"script","actionDef":"function(pageContext){pageContext.workOrderTaskPageId=pageContext.resultWebPageId;}"},{"name":"openTaskReviewSidePanel","type":"openPanel","pageId":"GEZKCPA4BA"},{"name":"openIncidentReviewSidePanel","type":"openPanel","pageId":"FLHOCXCBSP"},{"name":"openWorkforceTechnicianSP","type":"openPanel","pageId":"PFFMZV6SKT"},{"name":"openFilterTechniciansSP","type":"openPanel","pageId":"I0QB1R8NCE"},{"name":"openAllOpenTaksSP","type":"openPanel","pageId":"Q9RC6198JY"},{"name":"setViewTaskParams","type":"script","actionDef":"function(pageContext){pageContext.workOrderTaskAction='completed'; pageContext.subAction= 'calendarViewTask';}"},{"name":"setInitialLoad","type":"script","actionDef":"function(pageContext){pageContext.initialLoad=true;pageContext.statusName=pageContext.status;pageContext.status=pageContext.statusId;}"},{"name":"setActionOpenTask","type":"script","actionDef":"function(pageContext){pageContext.action='openTask';}"},{"name":"openScheduleAndAssignSidePanel","type":"openPanel","pageId":"acTaskSchedulingAndAssignSP"},{"name":"setActionDispatch","type":"script","actionDef":"function(pageContext){pageContext.action='dispatch';}"},{"name":"setActionView","type":"script","actionDef":"function(pageContext){pageContext.workOrderTaskAction='view';}"},{"name":"setActionPendingReview","type":"script","actionDef":"function(pageContext){pageContext.workOrderTaskAction='pendingReview';pageContext.status=pageContext.statusId;}"},{"name":"setActionCompleted","type":"script","actionDef":"function(pageContext){pageContext.workOrderTaskAction='completed';pageContext.actionHeader = 'completed';pageContext.status=pageContext.statusId;}"},{"name":"setTaskStatusToDispatched","type":"script","actionDef":"function(pageContext){pageContext.statusId = 'workOrderTaskDispatched'; pageContext.eventType = 'workOrderTaskDispatched'; pageContext.workOrderTaskAssignedToUserId = pageContext.userId;}"},{"endPoint":"process/start","name":"fetchTaskDependencyDataForDispatch","outputVarMap":{"data":"@pageContext.dependencyCheckData"},"type":"api","actionDef":{"data":[{"processId":"taskSchedulingTaskDependencyCheckWF","contextVar":{"dependentTaskStatusId":"@pageContext.statusId","workOrderTaskId":"@pageContext.workOrderTaskId","workOrderId":"@pageContext.workOrderId"}}]}},{"name":"processDependencyDataForDispatch","type":"script","actionDef":"function (pageContext) { if (typeof pageContext.dependencyCheckData !== 'undefined' && pageContext.dependencyCheckData !== '') { pageContext.dependencyCheck = pageContext.dependencyCheckData[0].outputVar.dependencyCheck; } }"},{"name":"fetchTechnicianOnCrew","outputVarMap":{"data":"@pageContext.techCrewData"},"type":"query","actionDef":{"filter":"((({$crew.startDate} BETWEEN {@startDate} AND {@endDate}) OR ({$crew.endDate} BETWEEN {@startDate} AND {@endDate}) OR ({@startDate} BETWEEN {$crew.startDate} AND {$crew.endDate}) OR ({@endDate} BETWEEN {$crew.startDate} AND {$crew.endDate})) AND {$workforceCrew.statusId}=\"workforceCrewOnCrew\" AND {$crew.statusId}!=\"crewDeactivated\")AND {$workforceCrew.workforceUserId} ={@workforceUserId}","models":["workforceCrew","crew"],"inputs":{"endDate":"@pageContext.scheduledEndTime","workforceUserId":"@pageContext.userId","startDate":"@pageContext.scheduledStartTime"},"columns":{"crewId":"workforceCrew.crewId"},"links":{"workforceCrew":"crew"}}},{"falseStep":["@actions.decisionAction"],"trueStep":["@actions.openModalOverrideTechnicianOnCrewDispatchConsole"],"name":"decisionActionForTechnicianOnCrew","type":"decision","actionDef":"function(pageContext){if(typeof pageContext.techCrewData !== 'undefined' && pageContext.techCrewData.length > 0){return true;} else { return false;}}"},{"subTitle":"@lang.['taaaabtacambatotaysywtatttt','The assigned Appraiser / Analyst already belongs to a crew and may be assigned to other tasks. Are you sure you want to assign this task to them?']","name":"openModalOverrideTechnicianOnCrewDispatchConsole","options":[{"buttonType":"secondary","name":"no","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.closeModal","@actions.decisionAction"],"type":"button","title":"@lang.['c13','Continue']"}],"type":"openModal","title":"@lang.['aaoc','Appraiser / Analyst on Crew']"},{"falseStep":["@actions.fireProcessEventUpsertTask","@actions.refreshScheduler","@actions.closePanel"],"trueStep":["@actions.openModalOverrideDependency"],"name":"decisionAction","type":"decision","actionDef":"function(pageContext){return pageContext.dependencyCheck;}"},{"endPoint":"event/start","name":"fireProcessEventUpsertTask","outputVarMap":{"data":"@pageContext.workFlowData"},"type":"api","actionDef":{"data":[{"eventId":"BM58GU7UNT","contextVar":{"workOrderTask":{"statusId":"@pageContext.statusId","id":"@pageContext.workOrderTaskId","eventType":"@pageContext.eventType"},"subAction":"upsertWorkOrderTask"}}]}},{"subTitle":"@lang.['dspwftpttctdootp','Dependency still pending. Wait for the preceding task to clear the dependency or override to proceed.']","name":"openModalOverrideDependency","options":[{"buttonType":"secondary","name":"no","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.openOverrideNSP","@actions.closeModal"],"type":"button","title":"@lang.['c13','Continue']"}],"type":"openModal","title":"@lang.['dt3','Dispatch Task']"},{"name":"closeModal","type":"closeModal"},{"name":"openOverrideNSP","type":"openPanel","pageId":"7EXQWZDPS8"},{"name":"refreshScheduler","type":"refreshScheduler"},{"name":"refreshDataGrid","type":"refreshDataGrid"}],"taskBarClickAction":{"name":"edit","actionOnClick":["@actions.openFilterTechniciansSP"]},"dataForDragAndDrop":{"dataSourceId":"process/start","sourceType":"api","dataToBeSent":{"inputVar":{},"processId":"QIFGIU7FDJ","apiResponseFormat":true,"contextVar":{"scheduledDate":"@pageContext.startTime","id":"@pageContext.workOrderTaskId"},"apiResponseObject":"workOrderTaskId"}}},"widgetType":"compWidget"},{"size":"T","id":"workOrderGrid","type":"dataGrid","jsonDef":{"isScrollAble":true,"deleteAllowed":false,"searchAllowed":true,"tableWidth":"170rem","searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY']","type":"noData"},"rowActions":{"children":[{"activeIcon":"@iconlib.MenuWorkOrdersSolidPurple","name":"@lang.['v','viewWorkOrder']","tooltip":"@lang.['vwo','View Work Order']","icon":"@iconlib.MenuWorkOrdersSolidGrey","actionOnClick":["@actions.setWorkOrderActionView","@actions.openViewWorkOrderSidePanel"],"type":"buttonIcon"},{"activeIcon":"@iconlib.ActionsScheduleAssignPurple","hidden":{"status":["workOrderTaskInTransit","workOrderTaskDelayed","workOrderTaskIncident","workOrderTaskDiscontinued","workOrderTaskDispatched","workOrderTaskInProgress","workOrderTaskPendingReview","workOrderTaskRejected","workOrderTaskCompleted","workOrderTaskSiteChangeRequest","workOrderTaskCancelled","workOrderTaskAutoScheduling"]},"name":"@lang.['s8','schedulingAssign']","icon":"@iconlib.ActionsScheduleAssignGrey","tooltip":"@lang.['sa','Schedule & Assign']","actionOnClick":["@actions.setInitialLoad","@actions.setActionSchedule","@actions.openEditScheduleSidePanel"],"type":"buttonIcon"},{"activeIcon":"@iconlib.ActionsTaskReviewPurple","hidden":{"status":["workOrderTaskDiscontinued","workOrderTaskOpen","workOrderTaskScheduled","workOrderTaskReopened","workOrderTaskDispatched","workOrderTaskInProgress","workOrderTaskInTransit","workOrderTaskDelayed","workOrderTaskIncident","workOrderTaskCompleted","workOrderTaskAutoScheduling"]},"name":"@lang.['t4','taskReviewForPendingReview']","icon":"@iconlib.ActionsTaskReviewGrey","tooltip":"@lang.['tr1','Task Review']","actionOnClick":["@actions.setActionReviewView","@actions.openSidePanelForTaskReview"],"type":"buttonIcon"},{"activeIcon":"https://d122pusslfmuhu.cloudfront.net/field-service-elements/icons/incident-review-purple.svg","hidden":{"status":["workOrderTaskPendingReview","workOrderTaskSiteChangeRequest","workOrderTaskOpen","workOrderTaskScheduled","workOrderTaskReopened","workOrderTaskDispatched","workOrderTaskInProgress","workOrderTaskInTransit","workOrderTaskDelayed","workOrderTaskCompleted","workOrderTaskAutoScheduling"]},"name":"@lang.['ir','Incident Review']","icon":"https://d122pusslfmuhu.cloudfront.net/field-service-elements/icons/incident-review-grey.svg","tooltip":"@lang.['ir','Incident Review']","actionOnClick":["@actions.setActionReviewView","@actions.openSidePanelForIncidentReport"],"type":"buttonIcon"},{"activeIcon":"@iconlib.ActionsTechnicianEditPurple","hidden":{"status":["workOrderTaskInProgress","workOrderTaskInTransit","workOrderTaskDelayed","workOrderTaskIncident","workOrderTaskOpen","workOrderTaskScheduled","workOrderTaskReopened","workOrderTaskDiscontinued","workOrderTaskPendingReview","workOrderTaskSiteChangeRequest","workOrderTaskCompleted","workOrderTaskAutoScheduling"]},"name":"@lang.['s5','schedulingEdit']","icon":"@iconlib.ActionsTechnicianEditGrey","tooltip":"@lang.['e1','Edit']","actionOnClick":["@actions.setInitialLoad","@actions.setActionDispatchedSchedule","@actions.openScheduleSidePanel"],"type":"buttonIcon"},{"activeIcon":"@iconlib.ActionsVisiblePurple","hidden":{"status":["workOrderTaskDispatched","workOrderTaskOpen","workOrderTaskScheduled","workOrderTaskReopened","workOrderTaskDiscontinued","workOrderTaskPendingReview","workOrderTaskSiteChangeRequest","workOrderTaskCompleted"]},"name":"@lang.['s6','schedulingViewTask']","icon":"@iconlib.ActionsVisibleGrey","tooltip":"@lang.['vt','View Task']","actionOnClick":["@actions.setInitialLoad","@actions.setWorkOrderTaskActionView","@actions.openScheduleSidePanel"],"type":"buttonIcon"},{"activeIcon":"@iconlib.ActionsVisiblePurple","hidden":{"status":["workOrderTaskOpen","workOrderTaskScheduled","workOrderTaskReopened","workOrderTaskDispatched","workOrderTaskInProgress","workOrderTaskInTransit","workOrderTaskDelayed","workOrderTaskIncident","workOrderTaskDiscontinued","workOrderTaskPendingReview","workOrderTaskSiteChangeRequest","workOrderTaskAutoScheduling"]},"name":"@lang.['s6','schedulingViewTask']","icon":"@iconlib.ActionsVisibleGrey","tooltip":"@lang.['vt','View Task']","actionOnClick":["@actions.setInitialLoad","@actions.setActionCompleted","@actions.openSidePanelForTaskReview"],"type":"buttonIcon"},{"activeIcon":"https://d122pusslfmuhu.cloudfront.net/field-service-elements/icons/dispatch-truck-purple.svg","hidden":{"status":["workOrderTaskOpen","workOrderTaskReopened","workOrderTaskDispatched","workOrderTaskInProgress","workOrderTaskInTransit","workOrderTaskDelayed","workOrderTaskIncident","workOrderTaskDiscontinued","workOrderTaskPendingReview","workOrderTaskCompleted","workOrderTaskSiteChangeRequest","workOrderTaskAutoScheduling"]},"name":"@lang.['d26','Dispatch']","icon":"https://d122pusslfmuhu.cloudfront.net/field-service-elements/icons/dispatch-truck-grey.svg","tooltip":"@lang.['d26','Dispatch']","actionOnClick":["@actions.setTaskStatusToDispatch","@actions.decisionActionCheckCrewTask","@actions.fetchValidationCheckData","@actions.processValidationCheckData","@actions.decisionActionForScheduledStartDate"],"type":"buttonIcon"}]},"modifyRowActions":[],"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"transparent":true,"actionOnLoad":["@actions.parseData"],"dataSourceId":"process/start","jslib":{"isDeleteDisabled":"function(pageContext){const currentDate=new Date().toISOString().replace(/T/,' ').replace(/\\..+/,'').replace(/Z/,'');const selectedDate=new Date(pageContext.startTime).toISOString().replace(/T/,' ').replace(/\\..+/,'').replace(/Z/,'');if(selectedDate>currentDate){pageContext.currentDate=currentDate;}else{return false}}","actionDropdownTitle":"function(pageContext) {if (pageContext && pageContext.selectedRowIds.length) {var userStatus = [],selectedUsers = [];selectedUsers = _.uniqBy(pageContext.selectedRowIds, function(row) {return row.statusName;});userStatus = selectedUsers.map((row) => {return row.statusName;});if (userStatus.length != 0 && pageContext.selectedRowIds[i].statusName === 'Scheduled' && (new Date(pageContext.selectedRowIds[i].workOrderTaskScheduledDate) < new Date(pageContext.currentDate))) {return '@lang.[\"select_action\",\"Select Action\"]';} else {return '@lang.[\"no_bulk_actions\",\"No Bulk Actions\"]';}}}","isDispatchAllHidden":"function(pageContext){if(typeof pageContext!='undefined'){if(typeof pageContext.selectedRowIds=='undefined'||(typeof pageContext.selectedRowIds!='undefined'&&!pageContext.selectedRowIds.length)){return true;} return false;} else{return true;}}","isDeactivateDisabled":"function(pageContext) { if (typeof pageContext != 'undefined' && typeof pageContext.selectedRowIds != 'undefined' && pageContext.selectedRowIds.length) { for(let i = 0; i<pageContext.selectedRowIds.length; i++){ if (pageContext.selectedRowIds[i].status == 'Draft' || pageContext.selectedRowIds[i].status == 'Invited' || pageContext.selectedRowIds[i].status == 'Deactivated') { return true; } }return false;} else {return true;}}","isDispatchButtonHidden":"function(pageContext){ const currentDate = new Date().toISOString().replace(/T/, ' ').replace(/\\..+/, '').replace(/Z/, ''); const selectedDate = new Date(pageContext.startTime).toISOString().replace(/T/, ' ').replace(/\\..+/, '').replace(/Z/, ''); if (selectedDate < currentDate || pageContext.statusId !== 'workOrderTaskScheduled') { return true } else { return false } }","isBulkActionHidden":"function(pageContext){if(typeof pageContext!='undefined'){if(typeof pageContext.selectedRowIds=='undefined'||(typeof pageContext.selectedRowIds!='undefined'&&!pageContext.selectedRowIds.length)){return false;}return true;} else{return true;}}","dispatchSelectedTasks":"function(pageContext) {pageContext.currentDate = new Date().toISOString().replace('T', ' ').replace('Z', '');if (typeof pageContext != 'undefined' && typeof pageContext.selectedRowIds != 'undefined' && pageContext.selectedRowIds.length < 0) {for (let i = 0; i < pageContext.selectedRowIds.length; i++) {if (pageContext.selectedRowIds[i].statusName === 'Scheduled' && (new Date(pageContext.selectedRowIds[i].workOrderTaskScheduledDate) < new Date(pageContext.currentDate))) {return false} else {return true;}}} else {return true;}}"},"id":"taskSchedulingOpenTaskDataGridId","updateAllowed":true,"isSelectable":false,"searchKeys":["statusName","workOrderId","workOrderTaskId","taskTypeName","userName"],"dynamicFilter":{"workOrderDeadline":"Date","customerCompanyName":"string","regionName":"string","statusName":"string","workOrderTaskId":"string","siteName":"string","workOrderId":"string","taskTypeName":"string","userName":"string"},"gridRefreshId":"taskSchedulingOpenTaskDataGrid","tableHeader":[{"name":"@lang.['s','Status']","options":{"flex":1.5,"sortOrder":"ASC","currentSorted":false,"colorCode":"statusNameColor","sortable":true,"showLabel":true},"key":"statusName","primaryKey":true},{"name":"@lang.['as01','Anow Status']","options":{"hidden":true,"flex":2,"sortOrder":"ASC","currentSorted":false,"sortable":true,"showLabel":true},"key":"anowStatus","primaryKey":true},{"name":"@lang.['priority','Priority']","options":{"isSlaPauseDisplayed":"false","flex":1.5,"slaTextColor":"slaTextColor","slaColor":"priorityColor","sortable":false,"zTimer":true,"iconUrl":"iconUrl","showLabel":true},"key":"priorityName"},{"name":"@lang.['pa3','Primary Appraiser']","options":{"flex":2,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"primaryApprasier"},{"name":"@lang.['taskId','Task ID']","options":{"flex":1.5,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"workOrderTaskId","primaryKey":true},{"name":"@lang.['WorkOrderId','Work Order ID']","options":{"flex":1.5,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"workOrderId"},{"name":"@lang.['dueDate','Due Date']","options":{"flex":2,"sortOrder":"ASC","sortable":true,"type":"dateTime","showLabel":true},"key":"workOrderDeadline"},{"name":"@lang.['navAW','Appointment Window']","options":{"flex":2,"sortOrder":"ASC","dateRangeType":"datetime","type":"dateRange","showLabel":true},"key":"workOrderTaskAppointmentWindow"},{"name":"@lang.['sd02','Scheduled Date']","options":{"flex":2,"sortOrder":"ASC","dateRangeType":"datetime","type":"dateRange","showLabel":true},"key":"workOrderTaskScheduledTime"},{"name":"@lang.['taskType','Task Type']","options":{"flex":1.7,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"taskTypeName"},{"name":"@lang.['aa2','Appraiser / Analyst']","options":{"flex":2,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"userName"},{"name":"@lang.['reportType','Report Type']","options":{"flex":2,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"reportType"},{"name":"@lang.['ob01','Ordered by']","options":{"flex":2,"showLabel":true},"key":"customerCompanyName"},{"name":"@lang.['lender','Lender']","options":{"flex":2,"showLabel":true},"key":"lenderName"},{"name":"@lang.['created','Created']","options":{"flex":2.5,"showLabel":true},"key":"created"},{"name":"@lang.['m12','Market']","options":{"flex":2,"showLabel":true},"key":"regionName"},{"name":"@lang.['contact','Contact']","options":{"flex":2,"align":"center","showLabel":true},"key":"contactName"},{"name":"@lang.['contactInformation','Contact Information']","options":{"flex":2,"showLabel":true},"key":"contactInformation"},{"name":"@lang.['t01','Tags']","options":{"flex":2,"showLabel":true},"key":"tags"}],"dataToBeSent":{"apiResponseParams":["count"],"processId":"acTaskSchedulingAndDispatchDataWF","apiResponseFormat":true,"contextVar":{"statusFilter":["workOrderTaskOpen","workOrderTaskScheduled","workOrderTaskReopened","workOrderTaskDispatched","workOrderTaskInProgress","workOrderTaskInTransit","workOrderTaskDelayed","workOrderTaskIncident","workOrderTaskDiscontinued","workOrderTaskSiteChangeRequest","workOrderTaskAutoScheduling"]},"apiResponseObject":"schedulingAndDispatchData"},"sourceType":"api","rowTextLength":20,"header":{"filterAllowed":true,"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['navAT','All Tasks']","children":[{"data":[{"buttonType":"secondary","actionOnClick":["@actions.setTodayTimeFilter","@actions.openModalForDispatchTasks"],"id":"today","type":"button","title":"@lang.['t15','Today']"},{"buttonType":"secondary","actionOnClick":["@actions.setTomorrowTimeFilter","@actions.openModalForDispatchTasks"],"id":"tomorrow","type":"button","title":"@lang.['t16','Tomorrow']"},{"buttonType":"secondary","actionOnClick":["@actions.setNext3DaysTimeFilter","@actions.openModalForDispatchTasks"],"id":"next3days","type":"button","title":"@lang.['n3d','Next 3 Days']"},{"buttonType":"secondary","actionOnClick":["@actions.setNext7DaysTimeFilter","@actions.openModalForDispatchTasks"],"id":"next7days","type":"button","title":"@lang.['n7d','Next 7 Days']"}],"type":"actionDropdown","title":"@lang.['dt7','Dispatch Tasks']"},{"buttonType":"primary","hidden":true,"actionOnClick":["@actions.openAutoScheduleSidePanel"],"id":"autoSchedule","type":"button","title":"@lang.['as2','Auto Schedule']"}]},"enableSidePanelFilter":true,"isMultiColumn":true,"dataSource":[],"actions":[{"subTitle":"@jslib.popUpText","name":"openModalForDispatchTasks","options":[{"buttonType":"secondary","name":"no","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.closeModal","@actions.fetchTasksAndDispatch","@actions.ifTasksNotAvailableForDispatch"],"type":"button","title":"@lang.['yp','Yes, Proceed']"}],"type":"openModal","title":"@lang.['dt7','Dispatch Tasks']"},{"name":"setTodayTimeFilter","type":"script","actionDef":"function(pageContext){pageContext.timeFrameFilter='today'; pageContext.timezoneOffset=new Date().getTimezoneOffset();}"},{"name":"setTomorrowTimeFilter","type":"script","actionDef":"function(pageContext){pageContext.timeFrameFilter='tomorrow'; pageContext.timezoneOffset=new Date().getTimezoneOffset();}"},{"name":"setNext3DaysTimeFilter","type":"script","actionDef":"function(pageContext){pageContext.timeFrameFilter='next3Days'; pageContext.timezoneOffset=new Date().getTimezoneOffset();}"},{"name":"setNext7DaysTimeFilter","type":"script","actionDef":"function(pageContext){pageContext.timeFrameFilter='next7Days'; pageContext.timezoneOffset=new Date().getTimezoneOffset();}"},{"endPoint":"process/start","name":"fetchTasksAndDispatch","outputVarMap":{"data":"@pageContext.queryData"},"type":"api","actionDef":{"data":[{"inputVar":{},"processId":"taskSchedulingBulkDispatchTasksFilterWF","contextVar":{"timezoneOffset":"@pageContext.timezoneOffset","timeFrameFilter":"@pageContext.timeFrameFilter"}}]}},{"name":"setActionDispatchedSchedule","type":"script","actionDef":"function(pageContext){pageContext.action='dispatch';}"},{"name":"setInitialLoad","type":"script","actionDef":"function(pageContext){pageContext.initialLoad=true;}"},{"name":"setWorkOrderTaskActionView","type":"script","actionDef":"function (pageContext) { if(pageContext.status === 'workOrderTaskAutoScheduling') { pageContext.action = 'view';} else { pageContext.workOrderTaskAction = 'view'; } }"},{"falseStep":["@actions.refreshDataGrid"],"trueStep":["@actions.openModalNoTasksAvailable"],"name":"ifTasksNotAvailableForDispatch","type":"decision","actionDef":"function (pageContext) {return(typeof pageContext.queryData[0].outputVar.tasksData === 'undefined' || pageContext.queryData[0].outputVar.tasksData.length === 0)}"},{"subTitle":"@lang.['nstrtbd','No scheduled tasks remained to be dispatched.']","name":"openModalNoTasksAvailable","options":[{"buttonType":"primary","name":"ok","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['o2','OK']"}],"type":"openModal","title":"@lang.['dt7','Dispatch Tasks']"},{"name":"setTaskStatusToDispatch","type":"script","actionDef":"function(pageContext) { pageContext.directDispatch = true; pageContext.workOrderTaskStatusId = 'workOrderTaskDispatched'; pageContext.eventType = 'workOrderTaskDispatched'; pageContext.subAction = 'upsertWorkOrderTask'; }"},{"name":"setActionCompleted","type":"script","actionDef":"function(pageContext){pageContext.workOrderTaskAction='completed';pageContext.actionHeader = 'completed';}"},{"falseStep":[],"trueStep":["@actions.fetchCrewLeadUserId","@actions.setCrewLeadId"],"name":"decisionActionCheckCrewTask","type":"decision","actionDef":"function(pageContext){return pageContext.taskTypeCrewTask}"},{"name":"fetchCrewLeadUserId","outputVarMap":{"data":"@pageContext.crewData"},"type":"query","actionDef":{"filter":"{$crew.id} = {@crewId}","models":["crew"],"inputs":{"crewId":"@pageContext.workOrderTaskAssignedToCrewId"},"columns":{"crewLeadUserId":"crew.leadUserId","crewStatusId":"crew.statusId"}}},{"name":"setCrewLeadId","type":"script","actionDef":"function (pageContext) { if(Array.isArray(pageContext.crewData) && pageContext.crewData.length > 0){ pageContext.workOrderTaskAssignedToUserId = pageContext.crewData[0].crewLeadUserId; pageContext.crewStatusId  = pageContext.crewData[0].crewStatusId;} }"},{"endPoint":"event/start","name":"fetchValidationCheckData","outputVarMap":{"data":"@pageContext.validationCheckData"},"type":"api","actionDef":{"data":[{"eventId":"taskSchedulingDispatchValidationCheckProcessEvent","inputVar":{},"apiResponseFormat":true,"contextVar":{"dependentTaskStatusId":"@pageContext.workOrderTaskStatusId","workOrderTaskId":"@pageContext.workOrderTaskId","workOrderId":"@pageContext.workOrderId"}}]}},{"async":true,"name":"processValidationCheckData","type":"script","actionDef":"function (pageContext) {pageContext.enable = true; if (Array.isArray(pageContext.validationCheckData) && pageContext.validationCheckData.length > 0) { pageContext.crewIssue = pageContext.validationCheckData[0].data[0].crewIssue; pageContext.dependencyIssue = pageContext.validationCheckData[0].data[0].dependencyIssue; pageContext.scheduledDateIssue = pageContext.validationCheckData[0].data[0].scheduledDateIssue; } }"},{"falseStep":["@actions.decisionActionForTechnicianOnCrew"],"trueStep":["@actions.openModalUnableToDispatchTechnician"],"name":"decisionActionForScheduledStartDate","type":"decision","actionDef":"function(pageContext){return pageContext.scheduledDateIssue}"},{"falseStep":["@actions.taskDependencyDecision"],"trueStep":["@actions.openModalOverrideTechnicianOnCrew"],"name":"decisionActionForTechnicianOnCrew","type":"decision","actionDef":"function(pageContext){return pageContext.crewIssue}"},{"falseStep":["@actions.openModalDispatchToTechnician"],"trueStep":["@actions.openModalOverrideDependency"],"name":"taskDependencyDecision","type":"decision","actionDef":"function(pageContext){return pageContext.dependencyIssue}"},{"name":"openOverrideNSP","type":"openPanel","pageId":"7EXQWZDPS8"},{"subTitle":"@lang.['tthapddywtotdadtt','This task has a pending dependency. Do you want to override the dependency and dispatch this task?']","name":"openModalOverrideDependency","options":[{"buttonType":"secondary","name":"no","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.closeModal","@actions.setDependencyOverrideSourceDispatch","@actions.openOverrideNSP"],"type":"button","title":"@lang.['c13','Continue']"}],"type":"openModal","title":"@lang.['dt3','Dispatch Task']"},{"subTitle":"@lang.['aysywtdtt','Are you sure you want to dispatch this task?']","name":"openModalDispatchToTechnician","options":[{"buttonType":"secondary","name":"no","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes ","actionOnClick":["@actions.fireProcessEventForWorkOrderTask","@actions.closeModal","@actions.refreshDataGrid"],"type":"button","title":"@lang.['yp1','Yes Proceed']"}],"type":"openModal","title":"@lang.['dt3','Dispatch Task']"},{"endPoint":"event/start","name":"fireProcessEventForWorkOrderTask","type":"api","actionDef":{"data":[{"eventId":"BM58GU7UNT","contextVar":{"workOrderTask":{"assignedToUserId":"@pageContext.workOrderTaskAssignedToUserId","statusId":"@pageContext.workOrderTaskStatusId","statusTargetModel":"workOrderTask","eventType":"@pageContext.eventType","id":"@pageContext.workOrderTaskId","assignedToCrewId":"@pageContext.workOrderTaskAssignedToCrewId"},"subAction":"upsertWorkOrderTask"}}]}},{"name":"setDependencyOverrideSourceDispatch","type":"script","actionDef":"function(pageContext){pageContext.dependencyOverrideSource = 'dispatch';pageContext.directDispatch = true;}"},{"name":"closeModal","type":"closeModal"},{"subTitle":"@lang.['taaaabtacambatotaysywtatttt','The assigned Appraiser / Analyst already belongs to a crew and may be assigned to other tasks. Are you sure you want to assign this task to them?']","name":"openModalOverrideTechnicianOnCrew","options":[{"buttonType":"secondary","name":"no","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.closeModal","@actions.taskDependencyDecision"],"type":"button","title":"@lang.['c13','Continue']"}],"type":"openModal","title":"@lang.['aaoc','Appraiser / Analyst on Crew']"},{"subTitle":"@lang.['ssdotthepeandtc','Scheduled start date of the task has expired. Please enter a new date to continue']","name":"openModalUnableToDispatchTechnician","options":[{"buttonType":"secondary","name":"no","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.closeModal","@actions.openTaskSP"],"type":"button","title":"@lang.['vd','View Details']"}],"type":"openModal","title":"@lang.['utd1','Unable to dispatch']"},{"name":"openTaskSP","type":"openPanel","pageId":"acTaskSchedulingAndAssignSP"},{"name":"openAutoScheduleSidePanel","type":"openPanel","pageId":"F9Y5EC974I"},{"name":"setActionSchedule","type":"script","actionDef":"function(pageContext){pageContext.action='openTask';}"},{"name":"setInitialLoad","type":"script","actionDef":"function(pageContext){pageContext.initialLoad=true;}"},{"name":"openViewWorkOrderSidePanel","type":"openPanel","pageId":"acWorkOrderSP"},{"name":"openEditScheduleSidePanel","type":"openPanel","pageId":"acTaskSchedulingAndAssignSP"},{"name":"openScheduleSidePanel","type":"openPanel","pageId":"acTaskSchedulingAndAssignSP"},{"name":"refreshDataGrid","type":"refreshDataGrid"},{"name":"openSidePanelForIncidentReport","type":"openPanel","pageId":"FLHOCXCBSP"},{"name":"setActionReviewView","type":"script","actionDef":"function(pageContext){pageContext.workOrderTaskAction='pendingReview';}"},{"name":"openSidePanelForTaskReview","type":"openPanel","pageId":"@rowData.resultWebPageId"},{"name":"setWorkOrderActionView","type":"script","actionDef":"function(pageContext){pageContext.workOrderAction='showWorkOrder';pageContext.subAction='viewWorkOrder';}"}]},"widgetType":"compWidget"},{"size":"SL","type":"rcLayout","jsonDef":{"componentType":"RC_CARD","size":"M"},"widgetType":"compWidget"}],"subject":["workOrderDispatchScheduler"],"jslib":{"isDeleteDisabled":"function(pageContext){const currentDate=new Date().toISOString().replace(/T/,' ').replace(/\\..+/,'').replace(/Z/,'');const selectedDate=new Date(pageContext.startTime).toISOString().replace(/T/,' ').replace(/\\..+/,'').replace(/Z/,'');if(selectedDate>currentDate){pageContext.currentDate=currentDate;}else{return false}}","actionDropdownTitle":"function(pageContext) {if (pageContext && pageContext.selectedRowIds.length) {var userStatus = [],selectedUsers = [];selectedUsers = _.uniqBy(pageContext.selectedRowIds, function(row) {return row.statusName;});userStatus = selectedUsers.map((row) => {return row.statusName;});if (userStatus.length != 0 && pageContext.selectedRowIds[i].statusName === 'Scheduled' && (new Date(pageContext.selectedRowIds[i].workOrderTaskScheduledDate) < new Date(pageContext.currentDate))) {return '@lang.[\"select_action\",\"Select Action\"]';} else {return '@lang.[\"no_bulk_actions\",\"No Bulk Actions\"]';}}}","isDispatchAllHidden":"function(pageContext){if(typeof pageContext!='undefined'){if(typeof pageContext.selectedRowIds=='undefined'||(typeof pageContext.selectedRowIds!='undefined'&&!pageContext.selectedRowIds.length)){return true;} return false;} else{return true;}}","popUpText":"function (pageContext) { if (pageContext.timeFrameFilter === 'today') { return('@lang.[\"aysywtdatsfttaaawbni1\",\"Are you sure you want to dispatch all tasks scheduled for today? The assigned Appraiser / Analyst will be notified immediately.\"]'); } else if (pageContext.timeFrameFilter === 'tomorrow') { return('@lang.[\"aysywtdatsfttaaawbni2\",\"Are you sure you want to dispatch all tasks scheduled for tomorrow? The assigned Appraiser / Analyst will be notified immediately.\"]'); } else if (pageContext.timeFrameFilter === 'next3Days') { return('@lang.[\"aysywtdatfn3dtaaawbni\",\"Are you sure you want to dispatch all tasks scheduled for next 3 days? The assigned Appraiser / Analyst will be notified immediately.\"]'); } else if (pageContext.timeFrameFilter === 'next7Days') { return('@lang.[\"arsywtdatfn7dtaaawbni\",\"Are you sure you want to dispatch all tasks scheduled for next 7 days? The assigned Appraiser / Analyst will be notified immediately.\"]'); } }","isDeactivateDisabled":"function(pageContext) { if (typeof pageContext != 'undefined' && typeof pageContext.selectedRowIds != 'undefined' && pageContext.selectedRowIds.length) { for(let i = 0; i<pageContext.selectedRowIds.length; i++){ if (pageContext.selectedRowIds[i].status == 'Draft' || pageContext.selectedRowIds[i].status == 'Invited' || pageContext.selectedRowIds[i].status == 'Deactivated') { return true; } }return false;} else {return true;}}","isDispatchButtonHidden":"function(pageContext){ const currentDate = new Date().toISOString().replace(/T/, ' ').replace(/\\..+/, '').replace(/Z/, ''); const selectedDate = new Date(pageContext.startTime).toISOString().replace(/T/, ' ').replace(/\\..+/, '').replace(/Z/, ''); if (selectedDate < currentDate || pageContext.statusId !== 'workOrderTaskScheduled') { return true } else { return false } }","isBulkActionHidden":"function(pageContext){if(typeof pageContext!='undefined'){if(typeof pageContext.selectedRowIds=='undefined'||(typeof pageContext.selectedRowIds!='undefined'&&!pageContext.selectedRowIds.length)){return false;}return true;} else{return true;}}","dispatchSelectedTasks":"function(pageContext){pageContext.currentDate = new Date().toISOString().replace('T', ' ').replace('Z', '');if (typeof pageContext != 'undefined' && typeof pageContext.selectedRowIds != 'undefined' && pageContext.selectedRowIds.length) {for (let i = 0; i < pageContext.selectedRowIds.length; i++) {pageContext.currentDate = new Date().toISOString().replace('T', ' ').replace('Z', '');if (pageContext.selectedRowIds[i].statusName === 'Scheduled') {return ((typeof pageContext.selectedRowIds[i].workOrderTaskScheduledDate === 'undefined' || pageContext.selectedRowIds[i].workOrderTaskScheduledDate === '') || (typeof pageContext.currentDate === 'undefined' || pageContext.currentDate === '') || (new Date(pageContext.selectedRowIds[i].workOrderTaskScheduledDate) < new Date(pageContext.currentDate)));} else return true;}return false;} else {return true;}}"},"isServerSideMCL":true,"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"actions":[{"name":"setActionDispatchedSchedule","type":"script","actionDef":"function(pageContext){pageContext.action='dispatch';}"},{"falseStep":[],"trueStep":["@actions.showWarningBanner"],"name":"decisionIfSchedulerInProgress","type":"decision","actionDef":"function(pageContext){return (typeof pageContext.inProgressSchedulerLogData !== 'undefined' && Array.isArray(pageContext.inProgressSchedulerLogData) && pageContext.inProgressSchedulerLogData.length > 0)}"},{"alertMessage":"@lang.['asriip','Auto scheduling run is in progress.']","alertType":"warning","name":"showWarningBanner","type":"showAlert"},{"name":"fetchInProgressSchedulerLogData","outputVarMap":{"data":"@pageContext.inProgressSchedulerLogData"},"type":"query","actionDef":{"filter":"{$schedulerLogStatus} = 'schedulerLogInProgress'","models":["schedulerLog"],"columns":{"schedulerLogStatus":"schedulerLog.status","schedulerLogId":"schedulerLog.id"},"distinct":true,"getCount":true}},{"name":"closeModal","type":"closeModal"},{"name":"setTaskStatusToDispatch","type":"script","actionDef":"function(pageContext) { pageContext.directDispatch = true; pageContext.workOrderTaskStatusId = 'workOrderTaskDispatched'; pageContext.eventType = 'workOrderTaskDispatched'; pageContext.subAction = 'upsertWorkOrderTask'; }"},{"falseStep":[],"trueStep":["@actions.fetchCrewLeadUserId","@actions.setCrewLeadId"],"name":"decisionActionCheckCrewTask","type":"decision","actionDef":"function(pageContext){return pageContext.taskTypeCrewTask}"},{"name":"fetchCrewLeadUserId","outputVarMap":{"data":"@pageContext.crewData"},"type":"query","actionDef":{"filter":"{$crew.id} = {@crewId}","models":["crew"],"inputs":{"crewId":"@pageContext.workOrderTaskAssignedToCrewId"},"columns":{"crewLeadUserId":"crew.leadUserId","crewStatusId":"crew.statusId"}}},{"name":"setCrewLeadId","type":"script","actionDef":"function (pageContext) { if(Array.isArray(pageContext.crewData) && pageContext.crewData.length > 0){ pageContext.workOrderTaskAssignedToUserId = pageContext.crewData[0].crewLeadUserId; pageContext.crewStatusId  = pageContext.crewData[0].crewStatusId;} }"},{"endPoint":"event/start","name":"fetchValidationCheckData","outputVarMap":{"data":"@pageContext.validationCheckData"},"type":"api","actionDef":{"data":[{"eventId":"taskSchedulingDispatchValidationCheckProcessEvent","inputVar":{},"apiResponseFormat":true,"contextVar":{"dependentTaskStatusId":"@pageContext.workOrderTaskStatusId","workOrderTaskId":"@pageContext.workOrderTaskId","workOrderId":"@pageContext.workOrderId"}}]}},{"async":true,"name":"processValidationCheckData","type":"script","actionDef":"function (pageContext) {pageContext.enable = true; if (Array.isArray(pageContext.validationCheckData) && pageContext.validationCheckData.length > 0) { pageContext.crewIssue = pageContext.validationCheckData[0].data[0].crewIssue; pageContext.dependencyIssue = pageContext.validationCheckData[0].data[0].dependencyIssue; pageContext.scheduledDateIssue = pageContext.validationCheckData[0].data[0].scheduledDateIssue; } }"},{"falseStep":["@actions.decisionActionForTechnicianOnCrew"],"trueStep":["@actions.openModalUnableToDispatchTechnician"],"name":"decisionActionForScheduledStartDate","type":"decision","actionDef":"function(pageContext){return pageContext.scheduledDateIssue}"},{"falseStep":["@actions.taskDependencyDecision"],"trueStep":["@actions.openModalOverrideTechnicianOnCrew"],"name":"decisionActionForTechnicianOnCrew","type":"decision","actionDef":"function(pageContext){return pageContext.crewIssue}"},{"falseStep":["@actions.openModalDispatchToTechnician"],"trueStep":["@actions.openModalOverrideDependency"],"name":"taskDependencyDecision","type":"decision","actionDef":"function(pageContext){return pageContext.dependencyIssue}"},{"name":"openOverrideNSP","type":"openPanel","pageId":"7EXQWZDPS8"},{"subTitle":"@lang.['tthapddywtotdadtt','This task has a pending dependency. Do you want to override the dependency and dispatch this task?']","name":"openModalOverrideDependency","options":[{"buttonType":"secondary","name":"no","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.closeModal","@actions.setDependencyOverrideSourceDispatch","@actions.openOverrideNSP"],"type":"button","title":"@lang.['c13','Continue']"}],"type":"openModal","title":"@lang.['dt3','Dispatch Task']"},{"subTitle":"@lang.['aysywtdtt','Are you sure you want to dispatch this task?']","name":"openModalDispatchToTechnician","options":[{"buttonType":"secondary","name":"no","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes ","actionOnClick":["@actions.fireProcessEventForWorkOrderTask","@actions.closeModal","@actions.refreshDataGrid"],"type":"button","title":"@lang.['yp1','Yes Proceed']"}],"type":"openModal","title":"@lang.['dt3','Dispatch Task']"},{"endPoint":"event/start","name":"fireProcessEventForWorkOrderTask","type":"api","actionDef":{"data":[{"eventId":"BM58GU7UNT","contextVar":{"workOrderTask":{"assignedToUserId":"@pageContext.workOrderTaskAssignedToUserId","statusId":"@pageContext.workOrderTaskStatusId","statusTargetModel":"workOrderTask","eventType":"@pageContext.eventType","id":"@pageContext.workOrderTaskId","assignedToCrewId":"@pageContext.workOrderTaskAssignedToCrewId"},"subAction":"upsertWorkOrderTask"}}]}},{"name":"setDependencyOverrideSourceDispatch","type":"script","actionDef":"function(pageContext){pageContext.dependencyOverrideSource = 'dispatch';pageContext.directDispatch = true;}"},{"subTitle":"@lang.['taaaabtacambatotaysywtatttt','The assigned Appraiser / Analyst already belongs to a crew and may be assigned to other tasks. Are you sure you want to assign this task to them?']","name":"openModalOverrideTechnicianOnCrew","options":[{"buttonType":"secondary","name":"no","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.closeModal","@actions.taskDependencyDecision"],"type":"button","title":"@lang.['c13','Continue']"}],"type":"openModal","title":"@lang.['aaoc','Appraiser / Analyst on Crew']"},{"subTitle":"@jslib.popUpText","name":"openModalForDispatchTasks","options":[{"buttonType":"secondary","name":"no","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.closeModal","@actions.fetchTasksAndDispatch","@actions.ifTasksNotAvailableForDispatch"],"type":"button","title":"@lang.['yp','Yes, Proceed']"}],"type":"openModal","title":"@lang.['dt7','Dispatch Tasks']"},{"name":"setTodayTimeFilter","type":"script","actionDef":"function(pageContext){pageContext.timeFrameFilter='today'; pageContext.timezoneOffset=new Date().getTimezoneOffset();}"},{"name":"setTomorrowTimeFilter","type":"script","actionDef":"function(pageContext){pageContext.timeFrameFilter='tomorrow'; pageContext.timezoneOffset=new Date().getTimezoneOffset();}"},{"name":"setNext3DaysTimeFilter","type":"script","actionDef":"function(pageContext){pageContext.timeFrameFilter='next3Days'; pageContext.timezoneOffset=new Date().getTimezoneOffset();}"},{"name":"setNext7DaysTimeFilter","type":"script","actionDef":"function(pageContext){pageContext.timeFrameFilter='next7Days'; pageContext.timezoneOffset=new Date().getTimezoneOffset();}"},{"endPoint":"process/start","name":"fetchTasksAndDispatch","outputVarMap":{"data":"@pageContext.queryData"},"type":"api","actionDef":{"data":[{"inputVar":{},"processId":"taskSchedulingBulkDispatchTasksFilterWF","contextVar":{"timezoneOffset":"@pageContext.timezoneOffset","timeFrameFilter":"@pageContext.timeFrameFilter"}}]}},{"falseStep":["@actions.refreshDataGrid"],"trueStep":["@actions.openModalNoTasksAvailable"],"name":"ifTasksNotAvailableForDispatch","type":"decision","actionDef":"function (pageContext) {return(typeof pageContext.queryData[0].outputVar.tasksData === 'undefined' || pageContext.queryData[0].outputVar.tasksData.length === 0)}"},{"subTitle":"@lang.['nstrtbd','No scheduled tasks remained to be dispatched.']","name":"openModalNoTasksAvailable","options":[{"buttonType":"primary","name":"ok","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['o2','OK']"}],"type":"openModal","title":"@lang.['dt7','Dispatch Tasks']"},{"subTitle":"@lang.['ssdotthepeandtc','Scheduled start date of the task has expired. Please enter a new date to continue']","name":"openModalUnableToDispatchTechnician","options":[{"buttonType":"secondary","name":"no","actionOnClick":["@actions.closeModal"],"type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.closeModal","@actions.openTaskSP"],"type":"button","title":"@lang.['vd','View Details']"}],"type":"openModal","title":"@lang.['utd1','Unable to dispatch']"},{"name":"openTaskSP","type":"openPanel","pageId":"acTaskSchedulingAndAssignSP"},{"name":"openAutoScheduleSidePanel","type":"openPanel","pageId":"F9Y5EC974I"},{"falseStep":["@actions.showWarningAlert"],"trueStep":["@actions.showSuccessAlert"],"name":"alertDecisionOnselecteddaysBulk","type":"decision","actionDef":"function(pageContext){if(pageContext.bulkAPIResponse){let status = true; pageContext.bulkAPIResponse.data.forEach(element => {if(element[Object.keys(element)[0]].status === false) {status = false;}});return status;}}"},{"alertMessage":"@lang.[\"user_bulk_action_warning\",\"No tasks were found to dispatch.\"]","alertType":"warning","name":"showWarningAlert","type":"showAlert"},{"alertMessage":"@lang.[\"some_tasks_pending_dependency_warning\",\"Some of the task were not dispatched because they had a Task Dependency.\"]","alertType":"warning","name":"showDependencyAlert","type":"showAlert"},{"alertMessage":"@lang.[\"Selected_bulk_action_success\",\" Selected tasks have been dispatched.\"]","alertType":"success","name":"showSuccessAlert","type":"showAlert"},{"falseStep":["@actions.showWarningAlert"],"trueStep":["@actions.showTodaysTaskSuccessAlert"],"name":"alertDecisionOnTodaysBulk","type":"decision","actionDef":"function(pageContext){if(pageContext.bulkAPIResponse){let status = true; pageContext.bulkAPIResponse.data.forEach(element => {if(element[Object.keys(element)[0]].status === false) {status = false;}});return status;}}"},{"falseStep":["@actions.alertDecisionOnselecteddaysBulk"],"trueStep":["@actions.showDependencyAlert"],"name":"alertShowDependencyAlert","type":"decision","actionDef":"function(pageContext){ return pageContext.bulkAPIResponse.data[0].data[0].dependencyCheckReturn===true;}"},{"falseStep":["@actions.alertDecisionOnTodaysBulk"],"trueStep":["@actions.showDependencyAlert"],"name":"alertShowDependencyAlertToday","type":"decision","actionDef":"function(pageContext){ return pageContext.bulkAPIResponse.data[0].data[0].dependencyCheckReturn===true;}"},{"falseStep":["@actions.alertDecisionOn3daysBulk"],"trueStep":["@actions.showDependencyAlert"],"name":"alertShowDependencyAlert3days","type":"decision","actionDef":"function(pageContext){ return pageContext.bulkAPIResponse.data[0].data[0].dependencyCheckReturn===true;}"},{"falseStep":["@actions.alertDecisionOn7daysBulk"],"trueStep":["@actions.showDependencyAlert"],"name":"alertShowDependencyAlert7days","type":"decision","actionDef":"function(pageContext){ return pageContext.bulkAPIResponse.data[0].data[0].dependencyCheckReturn===true;}"},{"alertMessage":"@lang.[\"TodaysTask_bulk_action_success\",\"Tasks for today have been dispatched.\"]","alertType":"success","name":"showTodaysTaskSuccessAlert","type":"showAlert"},{"falseStep":["@actions.showWarningAlert"],"trueStep":["@actions.show3TodaysTaskSuccessAlert"],"name":"alertDecisionOn3daysBulk","type":"decision","actionDef":"function(pageContext){if(pageContext.bulkAPIResponse){let status = true; pageContext.bulkAPIResponse.data.forEach(element => {if(element[Object.keys(element)[0]].status === false) {status = false;}});return status;}}"},{"alertMessage":"@lang.[\"3TodaysTask_bulk_action_success\",\"Tasks for the next three days have been dispatched.\"]","alertType":"success","name":"show3TodaysTaskSuccessAlert","type":"showAlert"},{"falseStep":["@actions.showWarningAlert"],"trueStep":["@actions.show7daysTaskSuccessAlert"],"name":"alertDecisionOn7daysBulk","type":"decision","actionDef":"function(pageContext){if(pageContext.bulkAPIResponse){let status = true; pageContext.bulkAPIResponse.data.forEach(element => {if(element[Object.keys(element)[0]].status === false) {status = false;}});return status;}}"},{"alertMessage":"@lang.[\"7daysTask_bulk_action_success\",\"Tasks for the next seven days have been dispatched.\"]","alertType":"success","name":"show7daysTaskSuccessAlert","type":"showAlert"},{"name":"closeModal1","type":"closeModal"},{"name":"refreshDataGrid1","type":"refreshDataGrid"},{"subTitle":"@lang.[\"task_bulk_action_confirmation\",\"Are you sure you want to perform this bulk actions on selected Task ?\"]","name":"openModal1","options":[{"buttonType":"secondary","name":"no","actionOnClick":"@actions.closeModal1","type":"button","title":"@lang.[\"cancel\",\"Cancel\"]"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.generateBulkPayload","@actions.dispatchSelectedTaskWFaction","@actions.closeModal1","@actions.alertShowDependencyAlert","@actions.refreshDataGrid1"],"type":"button","title":"@lang.[\"Yes, Continue\",\"Yes, Continue\"]"}],"type":"openModal","title":"@lang.[\"Confirm_bulk_action\",\"Confirm Bulk Action\"]"},{"name":"generateBulkPayload","type":"script","actionDef":"function(pageContext){if (typeof pageContext.selectedRowIds != 'undefined' && pageContext.selectedRowIds.length != 0) {var currentDate = new Date().toISOString().replace('T', ' ').replace('Z', '');pageContext.currentDate = currentDate;var bulkPayload = [];var records;for (let index = 0; index < pageContext.selectedRowIds.length; index++) {if (pageContext.selectedRowIds[index].statusName == 'Scheduled' && (new Date(pageContext.selectedRowIds[index].workOrderTaskScheduledDate) > new Date(pageContext.currentDate))) {records = pageContext.selectedRowIds[index].workOrderTaskId;bulkPayload.push(records);}}pageContext.bulkPayload = bulkPayload;}console.log(pageContext.bulkPayload); pageContext.bulkPayload = bulkPayload;}"},{"name":"setInitialLoad","type":"script","actionDef":"function(pageContext){pageContext.initialLoad=true;}"},{"name":"openAutoScheduleSidePanel","type":"openPanel","pageId":"F9Y5EC974I"},{"name":"setActionSchedule","type":"script","actionDef":"function(pageContext){pageContext.action='openTask';}"},{"name":"setInitialLoad","type":"script","actionDef":"function(pageContext){pageContext.initialLoad=true;}"},{"name":"openViewWorkOrderSidePanel","type":"openPanel","pageId":"acWorkOrderSP"},{"name":"openEditScheduleSidePanel","type":"openPanel","pageId":"acTaskSchedulingAndAssignSP"},{"name":"openScheduleSidePanel","type":"openPanel","pageId":"acTaskSchedulingAndAssignSP"},{"name":"refreshDataGrid","type":"refreshDataGrid"},{"name":"openSidePanelForIncidentReport","type":"openPanel","pageId":"FLHOCXCBSP"},{"name":"setActionReviewView","type":"script","actionDef":"function(pageContext){pageContext.workOrderTaskAction='pendingReview';}"},{"name":"openSidePanelForTaskReview","type":"openPanel","pageId":"@rowData.resultWebPageId"},{"falseStep":["@actions.fireProcessEventUpsertTask","@actions.refreshScheduler","@actions.closePanel"],"trueStep":["@actions.openModalOverrideDependency"],"name":"decisionAction","type":"decision","actionDef":"function(pageContext){return pageContext.dependencyCheck;}"},{"endPoint":"event/start","name":"fireProcessEventUpsertTask","outputVarMap":{"data":"@pageContext.workFlowData"},"type":"api","actionDef":{"data":[{"eventId":"BM58GU7UNT","contextVar":{"workOrderTask":{"statusId":"@pageContext.statusId","id":"@pageContext.workOrderTaskId","eventType":"@pageContext.eventType"},"subAction":"upsertWorkOrderTask"}}]}},{"name":"refreshScheduler","type":"refreshScheduler"},{"name":"setWorkOrderActionView","type":"script","actionDef":"function(pageContext){pageContext.workOrderAction='showWorkOrder';pageContext.subAction='viewWorkOrder';}"}],"observers":["workOrderGrid"]}