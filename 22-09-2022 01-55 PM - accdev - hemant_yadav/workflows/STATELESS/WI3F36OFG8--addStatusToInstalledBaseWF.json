{"fetchInstalledBaseData":{"filter":"{$installedBase.statusId} IS NULL","models":["installedBase"],"connectors":[{"exitPortType":"NextStep","nodeId":"areInstalledBasePresent"}],"columns":{"decommDate":"installedBase.decommDate","id":"installedBase.id"},"name":"fetchAssetData","description":"fetchAssetData","inputVarMap":{"customBatchSize":"batchSize"},"outputVarMap":{"data":"installedBaseData","count":"installedBaseCount","batchNumber":"installedBaseBatchNumber"},"batchSize":"batchSize","nodeType":"QUERY","getCount":true},"areMoreBatchesPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"getMoreInstalledBaseData"},{"exitPortType":"FalseStep","nodeId":"processInstalledBaseData"}],"name":"areMoreBatchesPresent","description":"areMoreBatchesPresent","processRule":"(contextVar.noOfInstalledBaseBatches >= 2 && contextVar.noOfInstalledBaseBatches >= contextVar.installedBaseBatchNumber)","nodeType":"DECISION"},"upsertInstalledBase":{"eventId":"QPYBKL7WY1","connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"name":"upsertInstalledBase","description":"upsertInstalledBase","inputVarMap":{"subAction":"subAction","installedBaseData":"installedBase"},"outputVarMap":{},"nodeType":"PUBLISH"},"workflowContext":{"customBatchSize":1000,"subAction":"upsertInstalledBase","noOfInstalledBaseBatches":0},"findNumberOfBatches":{"connectors":[{"exitPortType":"NextStep","nodeId":"areMoreBatchesPresent"}],"contextChangePermitted":true,"name":"findNumberOfBatches","description":"findNumberOfBatches","processRule":"{ contextVar.noOfInstalledBaseBatches = Math.ceil(contextVar.installedBaseCount/contextVar.customBatchSize); contextVar.installedBaseBatchNumber++; }","nodeType":"PROCESS"},"appendInstalledBase":{"connectors":[{"exitPortType":"NextStep","nodeId":"areMoreBatchesPresent"}],"contextChangePermitted":true,"name":"appendInstalledBase","description":"appendInstalledBase","processRule":"{ if (Array.isArray(contextVar.moreInstalledBaseData)) { contextVar.installedBaseData = contextVar.installedBaseData.concat(contextVar.moreInstalledBaseData); } contextVar.noOfInstalledBaseBatches++; }","nodeType":"PROCESS"},"processInstalledBaseData":{"connectors":[{"exitPortType":"NextStep","nodeId":"upsertInstalledBase"}],"contextChangePermitted":true,"name":"processInstalledBaseData","description":"processInstalledBaseData","processRule":"{ if (Array.isArray(contextVar.installedBaseData) && contextVar.installedBaseData.length > 0) { contextVar.installedBaseData.forEach(element => { element.statusTargetModel = 'installedBase'; if(typeof element.decommDate !== 'undefined' && element.decommDate !== ''){ element.statusId = 'installedBaseDecommissioned'; } else { element.statusId = 'installedBaseActive'; } }); } }","nodeType":"PROCESS","jsEngine":"es6"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchInstalledBaseData"}],"name":"start","description":"start","nodeType":"START"},"getMoreInstalledBaseData":{"filter":"{$installedBase.statusId} IS NULL","models":["installedBase"],"connectors":[{"exitPortType":"NextStep","nodeId":"appendInstalledBase"}],"columns":{"decommDate":"installedBase.decommDate","id":"installedBase.id"},"name":"getMoreInstalledBaseData","description":"getMoreInstalledBaseData","inputVarMap":{"customBatchSize":"batchSize","installedBaseBatchNumber":"batchNumber"},"outputVarMap":{"data":"moreInstalledBaseData"},"batchSize":"batchSize","nodeType":"QUERY","getCount":true,"batchNumber":"batchNumber"},"end":{"name":"End","description":"end","inputVarMap":{},"outputVarMap":{},"nodeType":"END"},"workflowNodes":["start","fetchInstalledBaseData","areInstalledBasePresent","findNumberOfBatches","areMoreBatchesPresent","getMoreInstalledBaseData","appendInstalledBase","processInstalledBaseData","upsertInstalledBase","end"],"areInstalledBasePresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"findNumberOfBatches"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"areInstalledBasePresent","description":"areInstalledBasePresent","processRule":"(typeof contextVar.installedBaseData !== 'undefined' &&  contextVar.installedBaseData !=='')","nodeType":"DECISION"}}