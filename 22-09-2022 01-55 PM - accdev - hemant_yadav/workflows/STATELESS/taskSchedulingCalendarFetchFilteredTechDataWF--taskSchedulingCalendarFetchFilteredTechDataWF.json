{"processTechs":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"processTechs","description":"processTechs","processRule":"{if (Array.isArray(contextVar.allTechnicianData)) { contextVar.allTechnicianData.forEach(function(obj){contextVar.dispatcherTechs.push(obj.id);}); }}","id":"appendTechs","nodeType":"PROCESS"},"findNumberOfBatches":{"connectors":[{"exitPortType":"NextStep","nodeId":"areMoreTechsPresent"}],"contextChangePermitted":true,"name":"findNumberOfBatches","description":"findNumberOfBatches","processRule":"contextVar.noOfBatches = Math.ceil(contextVar.allTechnicianCount / contextVar.customBatchSize);contextVar.techBatchNumber = contextVar.techBatchNumber + 1;","nodeType":"PROCESS"},"areMoreTechsPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"fetchMoreTechsData"},{"exitPortType":"FalseStep","nodeId":"processTechs"}],"name":"areMoreTechsPresent","description":"areMoreTechsPresent","processRule":"contextVar.noOfBatches >= 2 && contextVar.noOfBatches >= contextVar.techBatchNumber","id":"areMoreTechsPresent","nodeType":"DECISION"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"getLoggedInUser"}],"name":"Start","description":"Start","id":"start","nodeType":"START"},"fetchTechnicianData":{"models":["workforce","User","calendar"],"connectors":[{"exitPortType":"NextStep","nodeId":"findNumberOfBatches"}],"columns":{"calendarName":"calendar.name","userEmail":"User.emailId","userName":"User.name","workforceStatusId":"workforce.statusId","workforceUserId":"workforce.userId","userId":"User.id"},"distinct":true,"orderBy":"orderBy","description":"fetchTechnicianData","outerJoinOnModel":"workforce","inputVarMap":{"customBatchSize":"batchSize","workGroupFilter":"filter","finalFilteredUserIdList":"finalFilteredUserIdList","workforceStatusFilter":"workforceStatusFilter","workforceType":"workforceType","orderBy":"orderBy","userStatusFilter":"userStatusFilter"},"nodeType":"QUERY","filter":"filter","name":"fetchTechnicianData","links":{"calendar":"workforce","workforce":"User"},"outputVarMap":{"data":"allTechnicianData","count":"allTechnicianCount","batchNumber":"techBatchNumber"},"batchSize":"batchSize","getCount":true},"getFilteredUserIdList":{"connectors":[{"exitPortType":"NextStep","nodeId":"areFilteredUserIdPresent"}],"processId":"workGroupFilterForTechniciansAndTasksWF","name":"getFilteredUserIdList","description":"getFilteredUserIdList","inputVarMap":{"userList":"userList"},"outputVarMap":{"finalFilteredUserIdList":"finalFilteredUserIdList"},"nodeType":"WORKFLOW"},"areFilteredUserIdPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"createFilter"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"areFilteredUserIdPresent","description":"areFilteredUserIdPresent","processRule":"contextVar.finalFilteredUserIdList[contextVar.userList[0]].length>0","id":"areFilteredUserIdPresent","nodeType":"DECISION"},"createFilter":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchTechnicianData"}],"contextChangePermitted":true,"name":"createFilter","description":"createFilter","processRule":"{ contextVar.finalFilteredUserIdList = contextVar.finalFilteredUserIdList[contextVar.userList[0]]; contextVar.workGroupFilter = contextVar.searchFilter+ 'AND ({$workforceStatusId} = {@workforceStatusFilter}) AND ({$User.status}!= {@userStatusFilter}) AND ({$workforce.workforceType} IS NULL OR {$workforce.workforceType} != {@workforceType}) AND ({$workforce.userId} IN {@finalFilteredUserIdList})'; }","nodeType":"PROCESS"},"fetchMoreTechsData":{"models":["workforce","User","calendar"],"connectors":[{"exitPortType":"NextStep","nodeId":"findNumberOfBatches"}],"columns":{"calendarName":"calendar.name","userEmail":"User.emailId","userName":"User.name","workforceStatusId":"workforce.statusId","workforceUserId":"workforce.userId","userId":"User.id"},"distinct":true,"orderBy":"orderBy","description":"fetchMoreTechsData","outerJoinOnModel":"workforce","inputVarMap":{"customBatchSize":"batchSize","techBatchNumber":"batchNumber","workGroupFilter":"filter","finalFilteredUserIdList":"finalFilteredUserIdList","workforceStatusFilter":"workforceStatusFilter","workforceType":"workforceType","orderBy":"orderBy","userStatusFilter":"userStatusFilter"},"nodeType":"QUERY","filter":"filter","name":"fetchMoreTechsData","links":{"calendar":"workforce","workforce":"User"},"outputVarMap":{"data":"techDataToAppend","count":"count"},"batchSize":"batchSize","getCount":true,"batchNumber":"batchNumber"},"workflowNodes":["start","getLoggedInUser","processUserId","getFilteredUserIdList","areFilteredUserIdPresent","createFilter","fetchTechnicianData","findNumberOfBatches","areMoreTechsPresent","fetchMoreTechsData","appendTechs","processTechs","end"],"appendTechs":{"connectors":[{"exitPortType":"NextStep","nodeId":"areMoreTechsPresent"}],"contextChangePermitted":true,"name":"appendTechs","description":"appendTechs","processRule":"{ if (Array.isArray(contextVar.techDataToAppend)) { contextVar.allTechnicianData = contextVar.allTechnicianData.concat(contextVar.techDataToAppend); } contextVar.techBatchNumber = contextVar.techBatchNumber + 1; }","id":"appendTechs","nodeType":"PROCESS"},"workflowContext":{"customBatchSize":1000,"workforceStatusFilter":"workforceActive","dispatcherTechs":[],"workforceType":"webUser","noOfBatchesOfTech":0,"userStatusFilter":"Deactivated","allTechnicianData":[]},"processUserId":{"connectors":[{"exitPortType":"NextStep","nodeId":"getFilteredUserIdList"}],"contextChangePermitted":true,"name":"processUserId","description":"processUserId","processRule":"if (typeof contextVar.currentUserDetail !=='undefined') { contextVar.userList=[];contextVar.userList.push(contextVar.currentUserDetail[0].userId) };contextVar.searchFilter=contextVar.filter","nodeType":"PROCESS"},"getLoggedInUser":{"filter":"{$userId}={@userId}","models":["User"],"connectors":[{"exitPortType":"NextStep","nodeId":"processUserId"}],"columns":{"userName":"User.name","userId":"User.id"},"name":"getLoggedInUser","description":"getLoggedInUser","inputVarMap":{"{@userId}":"userId"},"outputVarMap":{"data":"currentUserDetail"},"nodeType":"QUERY"},"end":{"name":"end","description":"end","inputVarMap":{"allTechnicianCount":"count","allTechnicianData":"technicianQueryList"},"outputVarMap":{"count":"count","allTechnicianData":"technicianQueryList"},"id":"end","nodeType":"END"}}