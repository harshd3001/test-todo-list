{"workflowContext":{"crewStatusFilter":["crewDeactivated","crewDraft"]},"fetchCrewsList":{"models":["crewWorkGroup","crew","User","workforce","region","calendar"],"connectors":[{"exitPortType":"NextStep","nodeId":"processCrewListData"}],"columns":{"calendarName":"calendar.name","crewLeadUserId":"crew.leadUserId","regionName":"region.name","crewId":"crew.id","crewDescription":"crew.description","crewStatusId":"crew.statusId","crewName":"crew.name","crewStartDate":"crew.startDate","userName":"User.name","crewEndDate":"crew.endDate"},"orderBy":"orderBy","distinct":true,"description":"fetchCrewsList","inputVarMap":{"crewStatusFilter":"crewStatusFilter","searchText":"searchText","orderBy":"orderBy","crewWorkGroupIds":"crewWorkGroupIds"},"nodeType":"QUERY","filter":"{$crewWorkGroup.workGroupId} in {@crewWorkGroupIds} AND {$crew.statusId} not in {@crewStatusFilter} AND {$crewName} like {@searchText} ","name":"fetchCrewsList","links":{"calendar":"crew","crewWorkGroup":"crew","workforce":"User","region":"crew","crew":"workforce"},"outputVarMap":{"data":"crewListData","count":"count"},"getCount":true},"fetchWorkOrderTaskData":{"filter":"{$workOrderTask.id} = {@workOrderTaskId}","models":["workOrderTask","site","workOrder"],"connectors":[{"exitPortType":"NextStep","nodeId":"processWorkOrderTaskData"}],"columns":{"siteRegionId":"site.regionId","workOrderWorkOrderTypeId":"workOrder.workOrderTypeId","workOrderTaskTaskTypeId":"workOrderTask.taskTypeId","workOrderCustomerId":"workOrder.customerId"},"name":"fetchWorkOrderTaskData","description":"fetchWorkOrderTaskData","links":{"workOrder":"workOrderTask","site":"workOrderTask"},"inputVarMap":{"workOrderTaskId":"workOrderTaskId"},"outputVarMap":{"data":"workOrderTaskData"},"nodeType":"QUERY"},"processWorkOrderTaskData":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchWorkGroupsForCrews"}],"contextChangePermitted":true,"name":"processWorkOrderTaskData","description":"processWorkOrderTaskData","processRule":"{ contextVar.workOrderTaskWorkGroupFilter = '{$workGroup.id}=\"all\"'; contextVar.workOrderTaskData = contextVar.workOrderTaskData[0]; Object.keys(contextVar.workOrderTaskData) .forEach(function (key) { contextVar[key + 'List'] = [contextVar.workOrderTaskData[key]]; contextVar.workOrderTaskWorkGroupFilter += ' OR {$workGroupFilter.filterId} in (\"' + contextVar[key + 'List'].join('\",\"') + '\")'; }); }","nodeType":"PROCESS"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"processFilterForCrew"}],"name":"start","description":"Start","nodeType":"START"},"processFilterForCrew":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchWorkOrderTaskData"}],"contextChangePermitted":true,"name":"processFilterForCrew","description":"processing  filter for CrewDataGrid ","processRule":"if(typeof contextVar.filter !== 'undefined' && contextVar.filter !== '') { if(contextVar.filter.indexOf('crewName') !== -1){ contextVar.filter=contextVar.filter.replace('{$crewName} like ',''); var index=contextVar.filter.indexOf('\\''); var lastIndex=contextVar.filter.lastIndexOf('\\''); contextVar.searchText=contextVar.filter.slice(index+1,lastIndex); }}","nodeType":"PROCESS"},"end":{"name":"end","description":"end","inputVarMap":{"crewListData":"crewListData","count":"count"},"outputVarMap":{"crewListData":"crewListData","count":"count"},"nodeType":"END"},"fetchWorkGroupsForCrews":{"models":["workGroup","workGroupFilter","crewWorkGroup"],"connectors":[{"exitPortType":"NextStep","nodeId":"getCrewWorkGroupIds"}],"columns":{"filterId":"workGroupFilter.filterId","crewWorkGroupId":"crewWorkGroup.workGroupId","id":"workGroup.id"},"outerJoinOnModel":"workGroup","distinct":true,"description":"fetchWorkGroupsForCrews","inputVarMap":{"workOrderTaskWorkGroupFilter":"filter"},"nodeType":"QUERY","filter":"filter","name":"fetchWorkGroupsForCrews","links":{"workGroup":"workGroupFilter","crewWorkGroup":"workGroup"},"outputVarMap":{"data":"crewListData"},"getCount":true},"workflowNodes":["start","processFilterForCrew","fetchWorkOrderTaskData","processWorkOrderTaskData","fetchWorkGroupsForCrews","getCrewWorkGroupIds","fetchCrewsList","processCrewListData","end"],"getCrewWorkGroupIds":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchCrewsList"}],"contextChangePermitted":true,"name":"getCrewWorkGroupIds","description":"getCrewWorkGroupIds","processRule":"{ contextVar.crewWorkGroupIds = [];contextVar.crewListData.forEach(function (ids) { contextVar.crewWorkGroupIds.push(ids.crewWorkGroupId); }); }","nodeType":"PROCESS"},"processCrewListData":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"processCrewListData","description":"processCrewListData","processRule":"{if(!Array.isArray(contextVar.crewListData)){contextVar.crewListData = []; }}","nodeType":"PROCESS"}}