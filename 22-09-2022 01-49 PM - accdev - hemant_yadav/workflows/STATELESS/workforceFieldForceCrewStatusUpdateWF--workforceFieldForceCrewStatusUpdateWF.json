{"updateCrewModel":{"modelName":"crew","connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"multirecord":true,"name":"updateCrewModel","description":"updateCrewModel","inputVarMap":{"jsonObj":"data"},"nodeType":"MODEL","operation":2},"processData":{"connectors":[{"exitPortType":"NextStep","nodeId":"checkIfAnyCrewToBeUpdated"}],"contextChangePermitted":true,"name":"processData","description":"process queryCrewData to set the status","processRule":"{ if (typeof contextVar.queryCrewData != 'undefined' && contextVar.queryCrewData != '' && contextVar.queryCrewData.length > 0) { contextVar.jsonObj = []; var updated = false; var currentDate = new Date(); var startDate, endDate; contextVar.queryCrewData.forEach(function (element) { startDate = new Date(element.startDate); endDate = new Date(element.endDate); updated = false; if (startDate < currentDate && endDate > currentDate) { element.statusId = 'crewActive'; updated = true; } if (endDate < currentDate) { element.statusId = 'crewDeactivated'; updated = true; } if (updated) { contextVar.jsonObj.push(element); } }); } }","nodeType":"PROCESS"},"workflowContext":{},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"queryCrewData"}],"name":"start","description":"Start","nodeType":"START"},"checkIfAnyCrewToBeUpdated":{"connectors":[{"exitPortType":"TrueStep","nodeId":"updateCrewModel"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"checkIfAnyCrewToBeUpdated","description":"checkIfAnyCrewToBeUpdated","processRule":"typeof contextVar.jsonObj !== 'undefined' && contextVar.jsonObj.length>0","nodeType":"DECISION"},"queryCrewData":{"filter":"({$statusId} = 'crewNotStarted' || {$statusId} = 'crewActive') && {$leadUserId} IS NOT NULL","models":["crew","workforceCrew"],"connectors":[{"exitPortType":"NextStep","nodeId":"processData"}],"columns":{"statusId":"crew.statusId","endDate":"crew.endDate","id":"crew.id","leadUserId":"crew.leadUserId","startDate":"crew.startDate"},"name":"queryCrewData ","distinct":true,"description":"queryCrewData","links":{"crew":"workforceCrew"},"inputVarMap":{},"outputVarMap":{"data":"queryCrewData"},"nodeType":"QUERY","getCount":true},"end":{"name":"End","description":"end","nodeType":"END"},"workflowNodes":["start","queryCrewData","processData","checkIfAnyCrewToBeUpdated","updateCrewModel","end"]}