{"setHolidayFilter":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchHolidays"}],"contextChangePermitted":true,"name":"setHolidayFilter","description":"setHolidayFilter","processRule":"{ contextVar.holidayStartDate = new Date(contextVar.startDate); contextVar.holidayStartDate.setDate(contextVar.holidayStartDate.getDate() - 1); contextVar.holidayStartDate = contextVar.holidayStartDate.toISOString().replace('T', ' ').replace('Z', ''); contextVar.holidayEndDate = new Date(contextVar.endDate); contextVar.holidayEndDate.setDate(contextVar.holidayEndDate.getDate() + 1); contextVar.holidayEndDate = contextVar.holidayEndDate.toISOString().replace('T', ' ').replace('Z', ''); }","nodeType":"PROCESS","jsEngine":"es6"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchWeeklySchedule"}],"name":"start","description":"Start","id":"start","nodeType":"START"},"fetchWeeklySchedule":{"models":["weeklySchedule"],"connectors":[{"exitPortType":"NextStep","nodeId":"setHolidayFilter"}],"columns":{"lunchBreakSchedule":"weeklySchedule.lunchBreakSchedule","schedule":"weeklySchedule.schedule","calendarId":"weeklySchedule.calendarId","displayOrder":"weeklySchedule.displayOrder","allDayShift":"weeklySchedule.isAllDay"},"description":"fetchWeeklySchedule","distinct":true,"inputVarMap":{"calendarIdArray":"calendarIdArray"},"nodeType":"QUERY","filter":"{$weeklySchedule.calendarId} IN {@calendarIdArray}","name":"fetchWeeklySchedule","links":{},"outputVarMap":{"data":"shiftData"},"batchSize":1000,"getCount":true},"end":{"name":"end","description":"End","inputVarMap":{"technicians":"technicians","jobs":"jobs","sites":"sites"},"outputVarMap":{"technicians":"technicians","jobs":"jobs","sites":"sites"},"id":"end","nodeType":"END"},"fetchHolidays":{"models":["calendarHoliday","holiday"],"connectors":[{"exitPortType":"NextStep","nodeId":"processZRule"}],"columns":{"calendarId":"calendarHoliday.calendarId","startTime":"holiday.date","endTime":"CONCAT(DATE_ADD({$holiday.date}, INTERVAL CAST(1439 AS UNSIGNED) MINUTE),'.000')"},"description":"fetchHolidays","distinct":true,"inputVarMap":{"holidayEndDate":"holidayEndDate","calendarIdArray":"calendarIdArray","holidayStartDate":"holidayStartDate"},"nodeType":"QUERY","filter":"{$calendarHoliday.calendarId} IN {@calendarIdArray} AND ({$startTime} >= {@holidayStartDate} AND {$startTime} <= {@holidayEndDate})","name":"fetchHolidays","links":{"holiday":"calendarHoliday"},"outputVarMap":{"data":"techHolidayData"},"batchSize":1000,"getCount":true},"processZRule":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"processZRule","description":"processZRule","processRule":"@3JZP4LO8NV","nodeType":"PROCESS","jsEngine":"es6"},"workflowNodes":["start","fetchWeeklySchedule","setHolidayFilter","fetchHolidays","processZRule","end"]}