{"pageContext":{},"actionOnLoad":["@actions.setWorkforceUserId","@actions.getTimeZone","@actions.fireProcessEventForWebUserFetchData","@actions.normalizeWorkflowData","@actions.setInitialPageContext","@actions.enableRecordGrid","@actions.refreshDataGrid","@actions.refreshWorkScheduleDataGrid"],"jslib":{"isSaveContinueDisabled":"function(pageContext) { return (!(typeof pageContext.selectUser !== 'undefined' && pageContext.selectUser.length > 0 && pageContext.workforceCalendarId !== '' && typeof pageContext.selectWorkGroup !== 'undefined' && pageContext.selectWorkGroup.length > 0)) }","isAddressPopulated":"function(pageContext){return (typeof pageContext.workforceAddress==='undefined' || pageContext.workforceAddress==='') || (pageContext.webUserAction==='view') ||(pageContext.statusId=='workforceDeactivated')}","isDeactivateHidden":"function(pagecontext){if(pageContext.modalAction=='deactivateWebUser' && pageContext.statusId !='workforceDeactivated' ){return false}else{return true}}","showUser":"function(pageContext) {if (pageContext.webUserAction != 'undefined' && (pageContext.webUserAction === 'edit' || pageContext.webUserAdded === true || pageContext.webUserAction === 'view')) {return false}return true}","showUserDetails":"function(pageContext) {if (pageContext.webUserAction != 'add' && pageContext.webUserAction != 'view' && pageContext.webUserAdded === true && pageContext.AddNext != 'undefined') {return false}else if (pageContext.webUserAction === 'edit'){return false}return true}","hideEmail":"function(pageContext){if(typeof pageContext.selectUser == 'undefined') {return true;} else { return false;}}","isSaveDisabled":"function (pageContext) { pageContext.workGroupCheck = true; if (typeof pageContext.selectWorkGroup !== 'undefined' && pageContext.selectWorkGroup !== '' && pageContext.selectWorkGroup.length > 0 && typeof pageContext.initialSelectWorkGroup !== 'undefined' && pageContext.initialSelectWorkGroup !== '' && pageContext.selectWorkGroup.length !== pageContext.initialSelectWorkGroup.length) { pageContext.workGroupCheck = false; } else { for (var i in pageContext.selectWorkGroup) { for (var j in pageContext.initialSelectWorkGroup) { if (typeof pageContext.selectWorkGroup !== 'undefined' && pageContext.selectWorkGroup !== '' && pageContext.selectWorkGroup.length > 0 && typeof pageContext.initialSelectWorkGroup !== 'undefined' && pageContext.initialSelectWorkGroup !== '' && pageContext.initialSelectWorkGroup.indexOf(pageContext.selectWorkGroup[i].value) == -1) { pageContext.workGroupCheck = false; break; } } } } pageContext.workforceAddressCheck = true; if (pageContext.workforceAddress !== '' || (pageContext.initialWorkforceAddress !=='' && typeof pageContext.initialWorkforceAddress !== 'undefined')) { if ((pageContext.initialWorkforceAddress !== pageContext.workforceAddress) || (pageContext.initialWorkforceCity !== pageContext.addressObj.city) || (pageContext.initialWorkforceState !== pageContext.addressObj.state) || (pageContext.initialWorkforceCountry !== pageContext.addressObj.country) || (pageContext.initialWorkforcePostalCode !== pageContext.addressObj.zipCode)) { pageContext.workforceAddressCheck = false; } } return ((pageContext.webUserAction === 'edit') && (((pageContext.workGroupCheck) && (pageContext.initialWorkforceUserId === pageContext.selectUser[0].value) && (pageContext.initialWorkforceCalendarId === pageContext.workforceCalendarId) && (pageContext.initialWorkforceRoleId === pageContext.workforceRoleId) && (pageContext.initialUserPhoneNumber === pageContext.userPhoneNumber) && pageContext.workforceAddressCheck) || (pageContext.workforceCalendarId === '') || (pageContext.selectWorkGroup == ''))); }","isActionEdit":"function(pageContext){return(pageContext.webUserAction==='edit')}","isActionAdd":"function(pageContext){return(pageContext.webUserAction==='add')|| (pageContext.webUserAction=== 'addInitial')}","isViewDisabled":"function(pageContext){if(pageContext.webUserAction=='view' || pageContext.statusId=='workforceDeactivated'){return true;}else {return false;}}","isReactivateHidden":"function(pageContext){return (typeof pageContext.statusId === 'undefined' || pageContext.statusId === 'workforceActive' || pageContext.userStatus === 'Deactivated')}","showUserList":"function(pageContext){return(typeof pageContext.webUserAction==='undefined'||pageContext.webUserAction==='edit' || (pageContext.webUserAction==='add' &&  pageContext.webUserAdded===true) || pageContext.webUserAction==='view')}","dynamicHeaderText":"function(pageContext){ if(pageContext.webUserAction === 'addInitial' || pageContext.webUserAction === 'add'){return '@lang.[\"anwu\",\"Add New Web User\"]'}else if(pageContext.webUserAction === 'edit'){return '@lang.[\"edit\",\"Edit\"] ' + pageContext.userName}}"},"header":{"children":[{"hidden":"@jslib.isActionAdd","statusColor":"@pageContext.statusNameColor","id":"status","type":"status","value":"@pageContext.statusName"},{"buttonType":"secondary","hidden":"@jslib.isDeactivateHidden","actionOnClick":["@actions.deactivateWebUser"],"id":"deactivate","type":"button","title":"@lang.['d10','Deactivate']"},{"buttonType":"secondary","hidden":"@jslib.isReactivateHidden","actionOnClick":"@actions.reactivateWebUser","id":"reactivate","type":"button","title":"@lang.['r6','Reactivate']"},{"buttonType":"primary","hidden":"@jslib.showUserList","actionOnClick":["@actions.setSubActionUpsertWorkforce","@actions.fireProcessEvent","@actions.setActionEdit","@actions.setInitialDataSaveAndContinue","@actions.processApiOutput","@actions.fireProcessEventForWebUserFetchData","@actions.normalizeWorkflowData","@actions.refreshDataGrid"],"disabled":"@jslib.isSaveContinueDisabled","id":"saveAndContinue","type":"button","title":"@lang.['sc1','Save & Continue']"},{"buttonType":"primary","hidden":"@jslib.showUserDetails","actionOnClick":["@actions.setSubActionUpsertWorkforce","@actions.fireProcessEvent","@actions.closePanel","@actions.refreshDataGrid"],"disabled":"@jslib.isSaveDisabled","id":"submit","type":"button","title":"@lang.['s12','Save']"},{"icon":"@iconlib.NavigationCloseGrey","actionOnClick":["@actions.closePanel","@actions.clearPageContext","@actions.refreshDataGrid"],"id":"Close","type":"buttonIcon"}],"title":"@jslib.dynamicHeaderText"},"body":{"children":[{"children":[{"children":[{"children":[{"actionOnChange":["@actions.decisionActionForUserData"],"hidden":"@jslib.isActionEdit","optLabelMap":"userName","optValueMap":"userId","isMultiSelect":false,"searchByOptions":{"dataSourceId":"query/read","sourceType":"query","dataToBeSent":{"filter":"(({$workforceUserId} IS NULL) OR ({$workforceUserId} IS NOT NULL AND {$workforce.statusId} = 'workforceDeactivated' AND ({$workforce.workforceType} != 'webUser' OR {$workforce.workforceType} IS NULL))) AND {$roleId}!='mobile_user' AND {$userStatus}!='Deactivated' AND {$userName} like {@filter}","models":["User","workforce","Role"],"columns":{"userStatus":"User.status","roleId":"Role.id","userPhoneNumber":"User.phoneNumber","userEmail":"User.emailId","userName":"User.name","workforceUserId":"workforce.userId","userId":"User.id"},"inputs":{},"outerJoinOnModel":"User","orderBy":"userName ASC","distinct":true}},"isMainPage":false,"isAdvanceSearch":{"rowsToSelect":{"filter":"{$userId} = {@selectedUserId}","models":["User","workforce","Role"],"columns":{"userStatus":"User.status","roleId":"Role.id","userPhoneNumber":"User.phoneNumber","userEmail":"User.emailId","userName":"User.name","workforceUserId":"workforce.userId","userId":"User.id"},"inputs":{"selectedUserId":"@pageContext.selectedUserId"},"outerJoinOnModel":"User"},"columnsToBeHidden":["userStatus","roleId","userPhoneNumber","workforceUserId","userId"],"selectedRowAdvanceGrid":"AdvancedGridUser","rowsToBeSelect":"selectedUserId","sidePanelTitle":"@lang.['selectUser','Select User']","gridHeaderText":"@lang.['users','Users']","customColumns":{"userEmail":"@lang.['e4','Email']","userName":"@lang.['n','Name']"},"searchKeys":["userName"]},"label":"@lang.['n','Name']","id":"selectUser","type":"selectDropdown","value":"@pageContext.selectUser"},{"hidden":"@jslib.isActionAdd","disabled":true,"inputType":"text","id":"name","label":"@lang.['n','Name']","type":"input","value":"@pageContext.userName"},{"hidden":"@jslib.hideEmail","disabled":"true","id":"email","label":"@lang.['e4','Email']","type":"input","value":"@pageContext.userEmail","placeHolder":"@lang.['eiabosn','Email is autofilled based on selected name']"},{"options":"@pageContext.workforceRoleList","disabled":"@jslib.isViewDisabled","id":"roleId","optTitleKey":"workforceRole","optValueKey":"listOptionAnswerId","title":"@lang.['r9','Role (Optional)']","type":"select","value":"@pageContext.workforceRoleId","placeHolder":"@lang.['sr4','Select Role']"}],"id":"generalInformation","label":"@lang.['gi','General Information']","type":"section"},{"children":[{"isRequired":true,"options":"@pageContext.calendarList","disabled":"@jslib.isViewDisabled","id":"shiftId","optTitleKey":"calendarName","optValueKey":"calendarId","title":"@lang.['s4','Shift']","type":"select","value":"@pageContext.workforceCalendarId","placeHolder":"@lang.['ss5','Select Shift']"},{"actionOnChange":["@actions.setWorkGroup"],"optLabelMap":"workGroupName","optValueMap":"workGroupId","isMainPage":false,"label":"@lang.['wg1','Work Group']","type":"selectDropdown","isMultiSelect":true,"searchByOptions":{"dataSourceId":"query/read","sourceType":"query","dataToBeSent":{"filter":"{$workGroupName} like {@filter}","models":["workGroup"],"columns":{"filterMethod":"workGroup.filterMethod","description":"workGroup.description","workGroupName":"workGroup.name","workGroupId":"workGroup.id"},"inputs":{},"orderBy":"workGroupName ASC","distinct":true}},"isAdvanceSearch":{"rowsToSelect":{"filter":"{$workGroupId} IN {@selectedGroupId}","models":["workGroup"],"columns":{"filterMethod":"workGroup.filterMethod","description":"workGroup.description","workGroupName":"workGroup.name","workGroupId":"workGroup.id"},"inputs":{"selectedGroupId":"@pageContext.selectedId"}},"columnsToBeHidden":["workGroupId"],"selectedRowAdvanceGrid":"AdvancedGridWorkGroup","dataSourceId":"query/read","rowsToBeSelect":"selectedId","sourceType":"query","sidePanelTitle":"@lang.['as4','Advance Search']","gridHeaderText":"@lang.['wg1','Work Group']","customColumns":{"filterMethod":"@lang.['fm','Filter Method']","description":"@lang.['d','Description']","workGroupName":"@lang.['n','Name']"},"searchKeys":["workGroupName","filterMethod"]},"disabled":"@jslib.isViewDisabled","id":"selectWorkGroup","value":"@pageContext.selectWorkGroup","hoverText":{"title":"@lang.['atutoomwgtnttattsittsmbortteatttgatbatvadatatiyo','Add this user to one or more work groups to narrow the tasks and technicians they see in the Task Scheduling module based on region, task type, etc. Add them to the All group and they will be able to view and dispatch all tasks and technicians in your organization.']"}}],"id":"shiftSection","label":"@lang.['swg','Shift & Work Group']","type":"section"},{"children":[{"actionOnChange":["@actions.checkAddressAttributes"],"disabled":"@jslib.isViewDisabled","id":"address","label":"@lang.['address','Address']","placeholder":"@lang.['eca1','Enter contact address']","type":"address","value":"@pageContext.workforceAddress"},{"disabled":"@jslib.isAddressPopulated","id":"city","label":"@lang.['c','City']","placeholder":"@lang.['cibosa','City is based on selected address']","type":"input","value":"@pageContext.addressObj.city"},{"disabled":"@jslib.isAddressPopulated","id":"state","label":"@lang.['s11','State']","placeholder":"@lang.['sibosa','State is based on selected address']","type":"input","value":"@pageContext.addressObj.state"},{"disabled":"@jslib.isAddressPopulated","id":"postalCode","label":"@lang.['pc','Postal Code']","placeholder":"@lang.['pcibosa','Postal code is based on selected address']","type":"input","value":"@pageContext.addressObj.zipCode"},{"disabled":"@jslib.isAddressPopulated","id":"country","label":"@lang.['c1','Country']","placeholder":"@lang.['cibosa1','Country is based on selected address']","type":"input","value":"@pageContext.addressObj.country"},{"disabled":"@jslib.isViewDisabled","id":"phoneNumber","label":"@lang.['cp','Contact Phone']","type":"phoneNumber","value":"@pageContext.userPhoneNumber"}],"id":"contactInformation","label":"@lang.['ci3','Contact Information (Optional)']","type":"section"}],"label":"@lang.['wui','Web User Information']","type":"tab"},{"hidden":"@jslib.showUser","children":[{"children":[{"disabled":true,"id":"workforceShift","label":"@lang.['s4','Shift']","title":"@lang.['s4','Shift']","type":"input","value":"@pageContext.calendarName","placeHolder":"@lang.['ss5','Select Shift']"}],"id":"ShiftSection","label":"@lang.['s4','Shift']","type":"section"},{"children":[{"id":"workforceWeeklySchedule","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.calendarData"}},"isScrollAble":false,"rowActions":{"children":[]},"tableWidth":"50rem","header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['ws','Weekly Schedule']","children":[]},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSelectable":false,"actions":[],"tableHeader":[{"name":"@lang.['d12','Day']","options":{"flex":1.2,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"weeklyScheduleDay"},{"name":"@lang.['s','Status']","options":{"flex":1,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"shiftWeeklyScheduleIsOpen"},{"name":"@lang.['set','Start - End Time']","options":{"flex":3,"dateRangeType":"absoluteTime","sortable":false,"type":"dateRange","showLabel":true},"key":"weeklyScheduleTimings"},{"name":"@lang.['tt2','Total Time']","options":{"flex":1.3,"sortable":false,"showLabel":true},"key":"weeklyScheduleTotalHours"},{"name":"@lang.['b2','Break']","options":{"flex":3,"dateRangeType":"absoluteTime","sortable":true,"type":"dateRange","showLabel":true},"key":"weeklyScheduleLunchBreakSchedule"},{"name":"@lang.['mbd','Min Break Duration (Minutes)']","options":{"sortable":true,"showLabel":true},"key":"minimumBreakDuration"}]}}],"id":"WeeklyScheduleSection","label":"@lang.['ws','Weekly Schedule']","type":"section","transparent":true},{"children":[{"id":"workforcePublicHoliday","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.calendarHolidayData"}},"isScrollAble":true,"rowActions":{"children":[]},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['navPH','Public Holidays']","children":[]},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSelectable":false,"actions":[],"tableHeader":[{"name":"@lang.['n','Name']","options":{"sortable":false,"showLabel":true},"key":"holidayName"},{"name":"@lang.['d3','Date']","options":{"sortOrder":"ASC","sortable":true,"type":"date","showLabel":true},"key":"holidayDate"}]}}],"id":"PublicHolidaysSection","label":"@lang.['navPH',' Public Holidays']","type":"section","transparent":true},{"children":[{"id":"workforceLeave","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.leaveData"}},"isScrollAble":false,"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsEditPurple","hidden":"@jslib.isAddOrEditLeaveHidden","name":"@lang.['e1','Edit']","tooltip":"@lang.['e1','Edit']","icon":"@iconlib.ActionsEditGrey","actionOnClick":["@actions.setWorkforceLeaveActionEdit","@actions.openLeaveNestedSidePanel"],"type":"buttonIcon"}]},"jslib":{"isAddOrEditLeaveHidden":"function(pageContext){if(pageContext.webUserAction=='view' || pageContext.statusId=='workforceDeactivated'){return true;}else {return false;}}"},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['l4','Leave']","children":[{"buttonType":"primary","hidden":"@jslib.isAddOrEditLeaveHidden","actionOnClick":["@actions.setWorkforceLeaveActionAdd","@actions.openLeaveNestedSidePanel"],"id":"addNewLeave","type":"button","title":"@lang.['addNew','Add New']"}]},"gridRefreshId":"workforceLeave","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSelectable":false,"actions":[{"name":"openLeaveNestedSidePanel","type":"openPanel","pageId":"WOVORVCQJ9"},{"name":"setWorkforceLeaveActionAdd","type":"script","actionDef":"function(pageContext){pageContext.leaveAction='add';}"},{"name":"setWorkforceLeaveActionEdit","type":"script","actionDef":"function(pageContext){pageContext.leaveAction='edit';}"}],"tableHeader":[{"name":"@lang.['r5','Reason']","options":{"sortable":false,"showLabel":true},"key":"listOptionAnswerAnswerOptionText"},{"name":"@lang.['sdt','Start Date & Time']","options":{"sortOrder":"ASC","sortable":true,"type":"dateTime","showLabel":true},"key":"workforceLeaveStartDate"},{"name":"@lang.['edt','End Date & Time']","options":{"sortOrder":"ASC","sortable":true,"type":"dateTime","showLabel":true},"key":"workforceLeaveEndDate"}]}}],"id":"LeaveSection","label":"@lang.['l4','Leave']","type":"section","transparent":true},{"children":[{"id":"workforceOvertime","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.overTimeData"}},"isScrollAble":false,"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsEditPurple","hidden":"@jslib.isAddOrEditOverTimeHidden","name":"@lang.['e1','Edit']","tooltip":"@lang.['e1','Edit']","icon":"@iconlib.ActionsEditGrey","actionOnClick":["@actions.setWorkforceOvertimeActionEdit","@actions.clearBannerType","@actions.openOvertimeNestedSidePanel"],"type":"buttonIcon"}]},"jslib":{"isAddOrEditOverTimeHidden":"function(pageContext){if(pageContext.webUserAction=='view' || pageContext.statusId=='workforceDeactivated'){return true;}else {return false;}}"},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['o','Overtime']","children":[{"buttonType":"primary","hidden":"@jslib.isAddOrEditOverTimeHidden","actionOnClick":["@actions.setWorkforceOvertimeActionAdd","@actions.openOvertimeNestedSidePanel"],"id":"addNewOvertime","type":"button","title":"@lang.['addNew','Add New']"}]},"gridRefreshId":"workforceOvertime","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSelectable":false,"actions":[{"name":"openOvertimeNestedSidePanel","type":"openPanel","pageId":"AZLPRVCFGA"},{"name":"clearBannerType","type":"script","actionDef":"function(pageContext){pageContext.bannerType ='hide';}"},{"name":"setWorkforceOvertimeActionAdd","type":"script","actionDef":"function(pageContext){pageContext.overtimeAction='add';}"},{"name":"setWorkforceOvertimeActionEdit","type":"script","actionDef":"function(pageContext){pageContext.overtimeAction='edit';}"}],"tableHeader":[{"name":"@lang.['sdt','Start Date & Time']","options":{"sortOrder":"ASC","sortable":true,"type":"dateTime","showLabel":true},"key":"workforceOvertimeStartDate"},{"name":"@lang.['edt','End Date & Time']","options":{"sortOrder":"ASC","sortable":true,"type":"dateTime","showLabel":true},"key":"workforceOvertimeEndDate"},{"name":"@lang.['tt2','Total Time']","options":{"sortable":false,"showLabel":true},"key":"workforceOvertimeTotalTime"}]}}],"id":"OvertimeSection","label":"@lang.['o','Overtime']","type":"section","transparent":true}],"label":"@lang.['ws1','Work Schedule']","type":"tab"}],"label":"","type":"tab"}]},"actions":[{"name":"checkAddressAttributes","type":"script","actionDef":"function(pageContext) {if (pageContext.workforceAddress === '') {pageContext.addressObj.city=''; pageContext.addressObj.state=''; pageContext.addressObj.zipCode=''; pageContext.addressObj.country='';} }"},{"endPoint":"event/start","name":"fireProcessEvent","outputVarMap":{"data":"@pageContext.data"},"type":"api","actionDef":{"data":[{"eventId":"workforceTechnicianProcessEvent","contextVar":{"workforceWorkGroup":[{"workforceUserId":"@pageContext.selectUser[0].value","workGroupId":"@pageContext.selectWorkGroup"}],"User":[{"phoneNumber":"@pageContext.userPhoneNumber","emailId":"@pageContext.userEmail","id":"@pageContext.selectUser[0].value"}],"subAction":"@pageContext.subAction","workforce":[{"country":"@pageContext.addressObj.country","role":"@pageContext.workforceRoleId","address":"@pageContext.workforceAddress","statusTargetModel":"@pageContext.statusTargetModel","city":"@pageContext.addressObj.city","postalCode":"@pageContext.addressObj.zipCode","latitude":"@pageContext.addressObj.latitude","workforceUserId":"@pageContext.workforceUserId","userId":"@pageContext.selectUser[0].value","calendarId":"@pageContext.workforceCalendarId","statusId":"@pageContext.statusId","recver":"@pageContext.workforceRecver","workforceType":"webUser","state":"@pageContext.addressObj.state","longitude":"@pageContext.addressObj.longitude"}],"workforceUserId":"@pageContext.workforceUserId","userId":"@pageContext.workforceUserId"}}]}},{"name":"getTimeZone","type":"script","actionDef":"function(pageContext) {pageContext.timezoneOffset=new Date().getTimezoneOffset();}"},{"name":"setWorkGroup","type":"script","actionDef":"function(pageContext){ if(typeof pageContext.selectedRowIds!=='undefined' && pageContext.selectedRowIds!=='' && pageContext.selectedRowIds.length>0){ pageContext.selectWorkGroup = []; for (var i = 0; i < pageContext.selectedRowIds.length; i++) { pageContext.selectWorkGroup.push({ 'label': pageContext.selectedRowIds[i].workGroupName, 'value': pageContext.selectedRowIds[i].workGroupId });} } }"},{"name":"enableRecordGrid","type":"script","actionDef":"function(pageContext){pageContext.enable=true;}"},{"name":"clearPageContext","type":"clearPageContext"},{"name":"closePanel","type":"closePanel"},{"name":"closeModal","type":"closeModal"},{"name":"refreshWorkScheduleDataGrid","gridId":["workforceLeave","workforceOvertime"],"type":"RefreshGridOnSidePanel"},{"name":"processApiOutput","type":"script","actionDef":"function(pageContext){pageContext.webUserAdded=true;pageContext.workforceUserId=pageContext.data[0].data[0].workforceUserId;}"},{"name":"refreshDataGrid","type":"refreshDataGrid"},{"name":"setInitialPageContext","type":"script","actionDef":"function (pageContext) {if (typeof pageContext.webUserAdded === 'undefined') { pageContext.webUserAdded = false; } if (pageContext.webUserAction == 'edit') { pageContext.statusTargetModel = 'workforce'; pageContext.selectUser = []; pageContext.selectUser.push({ 'value': pageContext.workforceUserId, 'label': pageContext.userName });  if (typeof pageContext.selectedId === 'undefined') { pageContext.initialSelectWorkGroup = []; if (typeof pageContext.selectWorkGroup !== 'undefined') { for (var i = 0; i < pageContext.selectWorkGroup.length; i++) { pageContext.initialSelectWorkGroup.push(pageContext.selectWorkGroup[i].value); } }} pageContext.initialWorkforceUserId = pageContext.workforceUserId; pageContext.initialWorkforceCalendarId = pageContext.workforceCalendarId; pageContext.initialWorkforceRoleId = pageContext.workforceRoleId; pageContext.initialWorkforceAddress = pageContext.workforceAddress; pageContext.initialWorkforceCity = pageContext.addressObj.city; pageContext.initialWorkforceState = pageContext.addressObj.state; pageContext.initialWorkforceCountry = pageContext.addressObj.country; pageContext.initialWorkforcePostalCode = pageContext.addressObj.zipCode; pageContext.initialUserPhoneNumber = pageContext.userPhoneNumber;pageContext.initialUserEmail = pageContext.userEmail; pageContext.modalAction = 'deactivateWebUser' } else if (pageContext.webUserAction === 'addInitial') { pageContext.webUserAction = 'add';pageContext.statusTargetModel = 'workforce'; pageContext.workforceCalendarId = ''; pageContext.workforceRoleId = ''; pageContext.userPhoneNumber = '';  pageContext.workforceAddress = ''; pageContext.workforceUserId = ''; pageContext.selectWorkGroup = ''; pageContext.statusId = 'workforceActive';} }"},{"name":"normalizeWorkflowData","type":"script","actionDef":"function (pageContext) { if (pageContext.webUserAction === 'edit' || pageContext.webUserAction === 'view') { pageContext.workforceAddress = pageContext.responseData[0].data[0].workforceData[0].workforceAddress; pageContext.addressObj = {}; pageContext.addressObj.city = pageContext.responseData[0].data[0].workforceData[0].workforceCity; pageContext.addressObj.state = pageContext.responseData[0].data[0].workforceData[0].workforceState; pageContext.addressObj.zipCode = pageContext.responseData[0].data[0].workforceData[0].workforcePostalCode; pageContext.addressObj.country = pageContext.responseData[0].data[0].workforceData[0].workforceCountry; pageContext.userPhoneNumber = pageContext.responseData[0].data[0].workforceData[0].userPhoneNumber; pageContext.userEmail = pageContext.responseData[0].data[0].workforceData[0].userEmail; pageContext.workforceCalendarId = pageContext.responseData[0].data[0].workforceData[0].workforceCalendarId;   pageContext.workforceRoleId = pageContext.responseData[0].data[0].workforceData[0].workforceRoleId; pageContext.calendarName = pageContext.responseData[0].data[0].workforceData[0].calendarName; pageContext.workforceUserId = pageContext.responseData[0].data[0].workforceData[0].workforceUserId; pageContext.userName = pageContext.responseData[0].data[0].workforceData[0].userName; pageContext.workforcePostalCode = pageContext.responseData[0].data[0].workforceData[0].workforcePostalCode;pageContext.statusId = pageContext.responseData[0].data[0].workforceData[0].workforceStatusId; pageContext.calendarList = pageContext.responseData[0].data[0].calendarList; pageContext.workforceRoleList = pageContext.responseData[0].data[0].workforceRoleList; pageContext.calendarData = pageContext.responseData[0].data[0].calendarData; pageContext.calendarHolidayData = pageContext.responseData[0].data[0].calendarHolidayData; pageContext.leaveData = pageContext.responseData[0].data[0].leaveData; pageContext.overTimeData = pageContext.responseData[0].data[0].overTimeData; pageContext.userStatus = pageContext.responseData[0].data[0].workforceData[0].userStatus; pageContext.statusName = pageContext.responseData[0].data[0].workforceData[0].statusName; pageContext.statusNameColor = pageContext.responseData[0].data[0].workforceData[0].statusNameColor; pageContext.selectUser = []; pageContext.selectUser.push({ 'label': pageContext.userName, 'value': pageContext.workforceUserId }); pageContext.workGroupData = []; pageContext.workGroupData = pageContext.responseData[0].data[0].workGroup; if (typeof pageContext.selectedId === 'undefined') { pageContext.selectWorkGroup = []; for (var i in pageContext.workGroupData) { pageContext.selectWorkGroup.push({ 'value': pageContext.workGroupData[i].workGroupId, 'label': pageContext.workGroupData[i].workGroupName }); } } } else if (pageContext.webUserAction === 'add' || pageContext.webUserAction === 'addInitial') { pageContext.calendarList = pageContext.responseData[0].data[0].calendarList; pageContext.workforceRoleList = pageContext.responseData[0].data[0].workforceRoleList; }} "},{"name":"setSubActionDeactivateTechnician","type":"script","actionDef":"function(pageContext){pageContext.subAction='deactivateTechnician'; pageContext.statusId='workforceDeactivated'}"},{"name":"setSubActionReactivateTechnician","type":"script","actionDef":"function(pageContext){pageContext.subAction='reactivateTechnician'; pageContext.statusId='workforceActive'}"},{"subTitle":"@lang.['aysywtdtwu','Are you sure you want to deactivate this web user?']","name":"deactivateWebUser","options":[{"buttonType":"secondary","name":"no","actionOnClick":"@actions.closeModal","type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.setSubActionDeactivateTechnician","@actions.fireProcessEvent","@actions.closeModal","@actions.closePanel","@actions.refreshDataGrid"],"type":"button","title":"@lang.['d10','Deactivate']"}],"type":"openModal","title":"@lang.['dwu','Deactivate Web User']"},{"subTitle":"@lang.['aysywtrtwu','Are you sure you want to reactivate this web user?']","name":"reactivateWebUser","options":[{"buttonType":"secondary","name":"no","actionOnClick":"@actions.closeModal","type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.setSubActionReactivateTechnician","@actions.fireProcessEvent","@actions.closeModal","@actions.closePanel","@actions.refreshDataGrid"],"type":"button","title":"@lang.['r6','Reactivate']"}],"type":"openModal","title":"@lang.['rwu','Reactivate Web User']"},{"endPoint":"event/start","name":"fireProcessEventForWebUserFetchData","outputVarMap":{"data":"@pageContext.responseData"},"type":"api","actionDef":{"data":[{"eventId":"workforceWebUserProcessEvent","contextVar":{"timezoneOffset":"@pageContext.timezoneOffset","webUserAction":"@pageContext.webUserAction","workforceUserId":"@pageContext.workforceUserId"}}]}},{"name":"setSubActionUpsertWorkforce","type":"script","actionDef":"function(pageContext){pageContext.subAction='upsertWorkforce';}"},{"name":"setActionEdit","type":"script","actionDef":"function(pageContext){pageContext.webUserAction='edit';pageContext.isStatusHidden = false;pageContext.modalAction='deactivateWebUser'}"},{"name":"setInitialDataSaveAndContinue","type":"script","actionDef":"function(pageContext) { pageContext.userName = pageContext.selectUser[0].label; if (pageContext.workforceAddress !== '') { pageContext.initialWorkforceCity = pageContext.addressObj.city; pageContext.initialWorkforceState = pageContext.addressObj.state; pageContext.initialWorkforceCountry = pageContext.addressObj.country; pageContext.initialWorkforcePostalCode = pageContext.addressObj.zipCode; pageContext.initialWorkforceAddress = pageContext.workforceAddress; pageContext.workforceCity = pageContext.addressObj.city; pageContext.workforceState = pageContext.addressObj.state; pageContext.workforceCountry = pageContext.addressObj.country; pageContext.workforcePostalCode = pageContext.addressObj.zipCode; } pageContext.initialWorkforceCalendarId = pageContext.workforceCalendarId; pageContext.initialWorkforceRoleId = pageContext.workforceRoleId; pageContext.initialWorkforceUserId = pageContext.selectUser[0].value; pageContext.initialUserPhoneNumber = pageContext.userPhoneNumber; pageContext.workforceUserId = pageContext.selectUser[0].value; pageContext.initialSelectWorkGroup = []; if (typeof pageContext.selectWorkGroup !== 'undefined') { for (var i = 0; i < pageContext.selectWorkGroup.length; i++) { pageContext.initialSelectWorkGroup.push(pageContext.selectWorkGroup[i].value); } } }"},{"name":"setWorkforceUserId","type":"script","actionDef":"function(pageContext){if(pageContext.webUserAction==='view'){ pageContext.workforceUserId=pageContext.userId}}"},{"name":"setUserId","type":"script","actionDef":"function(pageContext){if(typeof pageContext.selectUser != 'undefined' && pageContext.selectUser.length >0) {pageContext.selectedUserId=pageContext.selectUser[0].value;}}"},{"name":"setPhoneNumberAndEmail","type":"script","actionDef":"function(pageContext) { if(typeof pageContext.userPhoneNumberData !== 'undefined' && pageContext.userPhoneNumberData.length > 0) { if(typeof pageContext.userPhoneNumberData[0].userPhoneNumber !== 'undefined'){pageContext.userPhoneNumber=pageContext.userPhoneNumberData[0].userPhoneNumber;} pageContext.userEmail=pageContext.userPhoneNumberData[0].userEmail;} }"},{"falseStep":["@actions.clearUserData"],"trueStep":["@actions.setUserId","@actions.fetchPhoneNumberAndEmail","@actions.setPhoneNumberAndEmail"],"name":"decisionActionForUserData","type":"decision","actionDef":"function(pageContext){if(Array.isArray(pageContext.selectUser) && pageContext.selectUser.length > 0 && pageContext.selectUser[0] !== null) {return true;} return false;}"},{"name":"clearUserData","type":"script","actionDef":"function(pageContext){pageContext.selectUserId='';pageContext.selectUser='';}"},{"name":"fetchPhoneNumberAndEmail","outputVarMap":{"data":"@pageContext.userPhoneNumberData"},"type":"query","actionDef":{"filter":"{$userId} = {@selectedUserId}","models":["User"],"columns":{"userPhoneNumber":"User.phoneNumber","userEmail":"User.emailId","userName":"User.name","userId":"User.id"},"inputs":{"selectedUserId":"@pageContext.selectedUserId"}}}]}