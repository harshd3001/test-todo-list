{"isMoreDataPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"fetchMoreData"},{"exitPortType":"FalseStep","nodeId":"clearValues"}],"name":"isMoreDataPresent","description":"isMoreDataPresent","processRule":"contextVar.noOfAllBatches >= 2 && contextVar.noOfAllBatches >= contextVar.newdataBatchNumber","nodeType":"DECISION"},"appendData":{"connectors":[{"exitPortType":"NextStep","nodeId":"isMoreDataPresent"}],"contextChangePermitted":true,"name":"appendData","description":"appendData","processRule":"{if (Array.isArray(contextVar.dataToAppend)) { contextVar[contextVar['dataVar']] = contextVar[contextVar['dataVar']].concat(contextVar.dataToAppend); } contextVar.newdataBatchNumber = contextVar.newdataBatchNumber + 1;}","id":"appendData","nodeType":"PROCESS","jsEngine":"es6"},"clearValues":{"connectors":[{"exitPortType":"NextStep","nodeId":"processFileName"}],"contextChangePermitted":true,"name":"clearValues","description":"clearValues","processRule":"contextVar.dataToAppend='';contextVar.dataVar='';contextVar.dataFilter='';","id":"clearValues","nodeType":"PROCESS"},"workflowContext":{"customBatchSize":1000,"dataFilter":"{$workOrderTaskInstalledBase.workOrderTaskId} = {@workOrderTaskId} AND {$installedBaseId} = {$workOrderTaskInstalledBase.installedBaseId} AND {$catalogTypeId} = 'partAndAsset' AND {$installedBaseStatusId} = 'installedBaseActive'","noOfBatches":0,"dataVar":"fetchSuggestedPartsForServ","newBatchNumber":0,"noOfAllBatches":0},"findNumberOfBatches":{"connectors":[{"exitPortType":"NextStep","nodeId":"isMoreDataPresent"}],"contextChangePermitted":true,"name":"findNumberOfBatches","description":"findNumberOfBatches","processRule":"contextVar.noOfAllBatches = Math.ceil(contextVar.dataCount / contextVar.customBatchSize);contextVar.newdataBatchNumber = contextVar.dataBatchNumber + 1;","id":"findNumberOfBatches","nodeType":"PROCESS"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"getData"}],"name":"start","description":"Start","nodeType":"START"},"end":{"name":"End","description":"end","inputVarMap":{"fetchSuggestedPartsForServ":"fetchSuggestedPartsForServ"},"outputVarMap":{"fetchSuggestedPartsForServ":"fetchSuggestedPartsForServ"},"id":"end","nodeType":"END"},"fetchMoreData":{"models":["catalog","manufacturer","stockUnit","category","catalogType","installedBase","workOrderTaskInstalledBase","assetCategory"],"connectors":[{"exitPortType":"NextStep","nodeId":"appendData"}],"columns":{"catalogModifiedDate":"catalog.modifiedDate","manufacturerName":"manufacturer.name","displayName":"CONCAT({$catalog.name},'-',{$catalog.modelNumber},'-',{$manufacturer.name},' ({%suggested})')","assetCategory":"assetCategory.name","catalogModelNumber":"catalog.modelNumber","catalogStockUnitId":"catalog.stockUnitId","categoryName":"category.name","stockUnitName":"stockUnit.name","installedBaseStatusId":"installedBase.statusId","catalogId":"catalog.id","catalogManufacturerId":"catalog.manufacturerId","fileUrl":"catalog.pdfUrl","displayNameWtSerialNo":"CONCAT({$catalog.name},'-',{$installedBase.serialNo},'-',{$manufacturer.name},' ({%suggested})')","catalogUnitPrice":"catalog.unitPrice","catalogDescription":"catalog.description","categoryTaxRate":"category.taxRate","serialNumber":"installedBase.serialNo","catalogCategoryId":"catalog.categoryId","catalogTypeId":"catalog.catalogTypeId","catalogName":"catalog.name","catalogRecver":"catalog.recver","catalogCustomerPrice":"catalog.customerPrice","assetCategoryId":"assetCategory.id","installedBaseId":"installedBase.id","suggestedFlag":"IF({$catalog.domainId} IS NULL, true, false)","categoryId":"category.id"},"outerJoinOnModel":"catalog","orderBy":"catalogName","description":"Fetch Details","distinct":true,"inputVarMap":{"customBatchSize":"batchSize","dataFilter":"filter","workOrderTaskId":"workOrderTaskId","newdataBatchNumber":"batchNumber"},"nodeType":"QUERY","filter":"filter","name":"fetchMoreData","links":{"catalogType":"catalog","installedBase":"catalog","assetCategory":"catalog","workOrderTaskInstalledBase":"installedBase","category":"catalog","manufacturer":"catalog","stockUnit":"catalog"},"id":"fetchMoreData","outputVarMap":{"data":"dataToAppend"},"batchSize":"batchSize","getCount":true,"batchNumber":"batchNumber"},"processFileName":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"processFileName","description":"processFileName","processRule":"if (typeof contextVar.fetchSuggestedPartsForServ !== 'undefined' && contextVar.fetchSuggestedPartsForServ != '' && contextVar.fetchSuggestedPartsForServ.length > 0 && Array.isArray(contextVar.fetchSuggestedPartsForServ) === true) { contextVar.fetchSuggestedPartsForServ.map(function(item) { let fileName, splitFileName; if (typeof item.fileUrl !== 'undefined' && item.fileUrl !== '') { splitFileName = item.fileUrl.split('/'); fileName = splitFileName[splitFileName.length - 1]; } else { fileName = '{%assetManual}'; } item.fileName = fileName; return item; }); }","id":"processFileName","nodeType":"PROCESS","jsEngine":"es6"},"workflowNodes":["start","getData","findNumberOfBatches","isMoreDataPresent","fetchMoreData","appendData","clearValues","processFileName","end"],"getData":{"models":["catalog","manufacturer","stockUnit","category","catalogType","installedBase","workOrderTaskInstalledBase","assetCategory"],"connectors":[{"exitPortType":"NextStep","nodeId":"findNumberOfBatches"}],"columns":{"catalogModifiedDate":"catalog.modifiedDate","manufacturerName":"manufacturer.name","displayName":"CONCAT({$catalog.name},'-',{$catalog.modelNumber},'-',{$manufacturer.name},' ({%suggested})')","assetCategory":"assetCategory.name","catalogModelNumber":"catalog.modelNumber","catalogStockUnitId":"catalog.stockUnitId","categoryName":"category.name","stockUnitName":"stockUnit.name","installedBaseStatusId":"installedBase.statusId","catalogId":"catalog.id","catalogManufacturerId":"catalog.manufacturerId","fileUrl":"catalog.pdfUrl","displayNameWtSerialNo":"CONCAT({$catalog.name},'-',{$installedBase.serialNo},'-',{$manufacturer.name},' ({%suggested})')","catalogUnitPrice":"catalog.unitPrice","catalogDescription":"catalog.description","categoryTaxRate":"category.taxRate","serialNumber":"installedBase.serialNo","catalogCategoryId":"catalog.categoryId","catalogTypeId":"catalog.catalogTypeId","catalogName":"catalog.name","catalogRecver":"catalog.recver","catalogCustomerPrice":"catalog.customerPrice","assetCategoryId":"assetCategory.id","installedBaseId":"installedBase.id","suggestedFlag":"IF({$catalog.domainId} IS NULL, true, false)","categoryId":"category.id"},"outerJoinOnModel":"catalog","orderBy":"catalogName","description":"getData","distinct":true,"inputVarMap":{"customBatchSize":"batchSize","dataFilter":"filter","workOrderTaskId":"workOrderTaskId"},"nodeType":"QUERY","filter":"filter","name":"getData","links":{"catalogType":"catalog","installedBase":"catalog","assetCategory":"catalog","workOrderTaskInstalledBase":"installedBase","category":"catalog","manufacturer":"catalog","stockUnit":"catalog"},"outputVarMap":{"data":"fetchSuggestedPartsForServ","count":"dataCount","batchNumber":"dataBatchNumber"},"batchSize":"batchSize","getCount":true}}