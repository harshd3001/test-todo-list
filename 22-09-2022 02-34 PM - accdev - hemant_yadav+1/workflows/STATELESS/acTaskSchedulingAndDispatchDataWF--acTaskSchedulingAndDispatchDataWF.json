{"getSiteIds":{"filter":"filter","models":["customer","site","region"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionIfWOTypeIdsPresent"}],"columns":{"customerCompanyName":"customer.companyName","regionName":"region.name","siteName":"site.name","siteId":"site.id"},"name":"getSiteIds","description":"fetch site ids for given regions ids and customer ids","inputVarMap":{"maxBatchSize":"batchSize","siteQueryFilter":"filter","region":"region","customer":"customer"},"links":{"site":"customer","region":"site"},"outputVarMap":{"data":"siteIds"},"batchSize":"batchSize","nodeType":"QUERY"},"processTaskData":{"connectors":[{"exitPortType":"NextStep","nodeId":"emptyResult"}],"contextChangePermitted":true,"name":"processTaskData","description":"Process task data","processRule":"{ function checkForData(a) { return (typeof a !== 'undefined' && a !== ''); } var taskCustRegion = {}; if (Array.isArray(contextVar.customerRegionData)) { contextVar.customerRegionData.forEach(function(obj) { taskCustRegion[obj.workOrderTaskId] = { 'customer': obj.customerCompanyName, 'region': obj.regionName }; }); var priorityColorMap = {}; var priorityTextMap = {}; if (checkForData(contextVar.priorityData)) { contextVar.priorityData.forEach(function(element) { priorityColorMap[element.priority] = element.colorCode; priorityTextMap[element.priority] = element.name; }); } contextVar.schedulingAndDispatchData.forEach(function(obj) { obj.customerCompanyName = taskCustRegion[obj.workOrderTaskId] ? taskCustRegion[obj.workOrderTaskId]['customer'] : ''; obj.regionName = taskCustRegion[obj.workOrderTaskId] ? taskCustRegion[obj.workOrderTaskId]['region'] : ''; obj.priorityColor = priorityColorMap[obj.workOrderPriority]; obj.priorityName = priorityTextMap[obj.workOrderPriority]; var taskScheduledTime = { 'start': checkForData(obj.workOrderTaskScheduledDate) ? obj.workOrderTaskScheduledDate : '', 'end': checkForData(obj.workOrderTaskDueDate) ? obj.workOrderTaskDueDate : '', }; obj.workOrderTaskScheduledTime = checkForData(obj.workOrderTaskScheduledDate) && checkForData(obj.workOrderTaskDueDate) ? [taskScheduledTime] : ''; }); } if (typeof contextVar.schedulingAndDispatchData != 'undefined' && contextVar.schedulingAndDispatchData != '' && contextVar.schedulingAndDispatchData.length > 0) { if (typeof contextVar.accLenderData != 'undefined' && contextVar.accLenderData != '' && contextVar.accLenderData.length > 0) { for (var i = 0; i < contextVar.schedulingAndDispatchData.length; i++) { for (var j = 0; j < contextVar.accLenderData.length; j++) { if (typeof contextVar.schedulingAndDispatchData[i].acLenderId != 'undefined' && contextVar.schedulingAndDispatchData[i].acLenderId != '' && typeof contextVar.accLenderData[j].id != 'undefined' && contextVar.accLenderData[j].id != '') { if(contextVar.schedulingAndDispatchData[i].acLenderId === contextVar.accLenderData[j].id){ contextVar.schedulingAndDispatchData[i]['lenderName'] = contextVar.accLenderData[j].lenderName; } } } } } } }","id":"processTaskData","nodeType":"PROCESS"},"processworkOrderTaskScheduleBreakdown":{"connectors":[{"exitPortType":"NextStep","nodeId":"areTasksPresent"}],"contextChangePermitted":true,"name":"processworkOrderTaskScheduleBreakdown","description":"processworkOrderTaskScheduleBreakdown","processRule":"for (j = 0; j < contextVar.fetchworkOrderTaskScheduleBreakdown.length; j++) { for (i = 0; i < contextVar.schedulingAndDispatchData.length; i++) { contextVar.woid1 = contextVar.fetchworkOrderTaskScheduleBreakdown[j].workOrderTaskId; contextVar.woid2 = contextVar.schedulingAndDispatchData[i].workOrderTaskId; contextVar.dataToInsert = contextVar.fetchworkOrderTaskScheduleBreakdown[j].workOrderTaskScheduleBreakdown; if (contextVar.woid1 == contextVar.woid2) { contextVar.schedulingAndDispatchData[i].workOrderTaskScheduleBreakdown = contextVar.dataToInsert; } } }","nodeType":"PROCESS","jsEngine":"es6"},"getWorkforceWorkGroupDataForLoggedInUser":{"filter":"{$workforceWorkGroupWorkforceUserId}={@userId}","models":["workforceWorkGroup","workGroupFilter","workGroup"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionIfWorkforceWorkGroupDataPresent"}],"columns":{"workforceWorkGroupWorkforceUserId":"workforceWorkGroup.workforceUserId","workGroupFilterFilterId":"workGroupFilter.filterId","workGroupFilterId":"workGroupFilter.id","workforceWorkGroupWorkGroupId":"workforceWorkGroup.workGroupId","workGroupId":"workGroup.id","workGroupFilterMethod":"workGroup.filterMethod"},"name":"getWorkforceWorkGroupDataForLoggedInUser","outerJoinOnModel":"workGroup","distinct":true,"description":"fetch work group data for logged in user (dispatcher)","links":{"workforceWorkGroup":"workGroup","workGroup":"workGroupFilter"},"inputVarMap":{"{@userId}":"userId"},"outputVarMap":{"data":"workforceWorkGroupData"},"nodeType":"QUERY"},"processFilterForSiteQuery":{"connectors":[{"exitPortType":"NextStep","nodeId":"getSiteIds"}],"contextChangePermitted":true,"name":"processFilterForSiteQuery","description":"create a filter for fetching site ids","processRule":"contextVar.siteQueryFilter = ' '; if (typeof contextVar.region != 'undefined' && contextVar.region.length > 0) { contextVar.siteQueryFilter = contextVar.siteQueryFilter + '({$site.regionId} IN {@region})'; if (typeof contextVar.customer != 'undefined' && contextVar.customer.length > 0) { contextVar.siteQueryFilter = contextVar.siteQueryFilter + ' AND ({$site.customerId} IN {@customer})'; } } else if (typeof contextVar.customer != 'undefined' && contextVar.customer.length > 0) { contextVar.siteQueryFilter = contextVar.siteQueryFilter + '({$site.customerId} IN {@customer})'; }","nodeType":"PROCESS"},"processSiteIdsAndWorkOrderIds":{"connectors":[{"exitPortType":"NextStep","nodeId":"checkIfCustomerPortalOrderDetailsModelPresentWF"}],"contextChangePermitted":true,"name":"processSiteIdsAndWorkOrderIds","description":"process fetched site ids and workOrder ids","processRule":"contextVar.siteIdsToFilterWith = []; contextVar.WorkOrderIdsToFilterWith = []; if(typeof contextVar.siteIds != 'undefined' && contextVar.siteIds.length > 0) { contextVar.siteIds.forEach(function (element) { contextVar.siteIdsToFilterWith.push(element.siteId); }); } if(typeof contextVar.workOrderIds != 'undefined' && contextVar.workOrderIds.length > 0) { contextVar.workOrderIds.forEach(function (ele) { contextVar.WorkOrderIdsToFilterWith.push(ele.workOrderId); }); }","id":"initializeParams","nodeType":"PROCESS"},"addTasksIntoArray":{"connectors":[{"exitPortType":"NextStep","nodeId":"queryCustomerRegion"}],"contextChangePermitted":true,"name":"addTasksIntoArray","description":"Add tasks into array","processRule":"{ contextVar.schedulingAndDispatchData.forEach(function (obj) { contextVar.taskData.push(obj.workOrderTaskId); }); }","id":"addTasksIntoArray","nodeType":"PROCESS"},"areTasksPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"addTasksIntoArray"},{"exitPortType":"FalseStep","nodeId":"emptyResult"}],"name":"areTasksPresent","description":"check if tasks exist","processRule":"(typeof contextVar.schedulingAndDispatchData != 'undefined' && contextVar.schedulingAndDispatchData != '' && contextVar.schedulingAndDispatchData.length>0)","id":"areTasksPresent","nodeType":"DECISION"},"decisionIfAllGroupApplied":{"connectors":[{"exitPortType":"TrueStep","nodeId":"checkIfCustomerPortalOrderDetailsModelPresentWF"},{"exitPortType":"FalseStep","nodeId":"decisionIfRegionIdsOrCustomerIdsPresent"}],"name":"decisionIfAllGroupApplied","description":"decides if ALL group filter added","processRule":"(typeof contextVar.isAllFilterApplied !== 'undefined' && contextVar.isAllFilterApplied ===true)","id":"decisionIfAllGroupApplied","nodeType":"DECISION"},"checkIfCustomerPortalOrderDetailsModelPresentWF":{"connectors":[{"exitPortType":"NextStep","nodeId":"processZRule"}],"contextChangePermitted":true,"name":"checkIfCustomerPortalOrderDetailsModelPresentWF","description":"checkIfCustomerPortalOrderDetailsModelPresentWF","inputVarMap":{"customerPortalOrderDetailsModelPresentProcessId":"processId"},"outputVarMap":{"isCustomerPortalOrderDetailsModelPresent":"isCustomerPortalOrderDetailsModelPresent"},"nodeType":"WORKFLOW"},"fetchWorkOrderPriority":{"filter":"{$ZPriority.targetModel} = 'workOrder'","models":["ZPriority"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchAccLenderData"}],"columns":{"name":"ZPriority.name","colorCode":"ZPriority.colorCode","priority":"ZPriority.priority"},"name":"fetchWorkOrderPriority","description":"Query customer and region data","inputVarMap":{},"id":"fetchWorkOrderPriority","outputVarMap":{"data":"priorityData"},"nodeType":"QUERY","getCount":true},"workflowContext":{"openIcon":"https://d122pusslfmuhu.cloudfront.net/Open+%26+Draft+%26+Reopend+-+Task+Status.svg","maxBatchSize":1000,"count":0,"taskData":[],"cancelledIcon":"https://d122pusslfmuhu.cloudfront.net/Cancelled+-+Task+Status.svg","regionFilterString":"","discontinuedIcon":"https://d122pusslfmuhu.cloudfront.net/Discontinued+-+Task+Status.svg","pendingReviewIcon":"https://d122pusslfmuhu.cloudfront.net/Pending+Review+-+Task+Status.svg","scheduledIcon":"https://d122pusslfmuhu.cloudfront.net/Scheduled+-+Task+Status.svg","customerPortalOrderDetailsModelPresentProcessId":"checkIfCustomerPortalOrderDetailsModelPresentWF","delayedIcon":"https://d122pusslfmuhu.cloudfront.net/Delayed+-+Task+Status.svg","incidentIcon":"https://d122pusslfmuhu.cloudfront.net/Incident+-+Task+Status.svg","customerFilterString":"","inTransitIcon":"https://d122pusslfmuhu.cloudfront.net/In+Transit+-+Task+Status.svg","dispatchedIcon":"https://d122pusslfmuhu.cloudfront.net/Dispatched+-+Task+Status.svg","inProgressIcon":"https://d122pusslfmuhu.cloudfront.net/In+Progress+-+Task+Status.svg","completedIcon":"https://d122pusslfmuhu.cloudfront.net/Completed+-+Task+Status.svg"},"IfCustomerPortalInstalled":{"connectors":[{"exitPortType":"TrueStep","nodeId":"fetchSchedulingDataWithCP"},{"exitPortType":"FalseStep","nodeId":"fetchSchedulingData"}],"name":"IfCustomerPortalInstalled","description":"IfCustomerPortalInstalled","processRule":"(typeof contextVar.isCustomerPortalOrderDetailsModelPresent != 'undefined' && contextVar.isCustomerPortalOrderDetailsModelPresent == true)","id":"areTasksPresent","nodeType":"DECISION"},"end":{"name":"end","description":"end","inputVarMap":{"count":"count","schedulingAndDispatchData":"schedulingAndDispatchData","batchNumber":"batchNumber"},"outputVarMap":{"count":"count","schedulingAndDispatchData":"schedulingAndDispatchData","batchNumber":"batchNumber"},"id":"end","nodeType":"END"},"getWorkOrderIds":{"filter":"{$workOrderWorkOrderTypeId} IN {@workOrderType}","models":["workOrder"],"connectors":[{"exitPortType":"NextStep","nodeId":"processSiteIdsAndWorkOrderIds"}],"columns":{"workOrderWorkOrderTypeId":"workOrder.workOrderTypeId","workOrderId":"workOrder.id"},"name":"getWorkOrderIds","description":"fetch workOrder ids for given workOrderType ids","inputVarMap":{"workOrderType":"workOrderType","maxBatchSize":"batchSize"},"outputVarMap":{"data":"workOrderIds"},"batchSize":"batchSize","nodeType":"QUERY"},"fetchworkOrderTaskScheduleBreakdown":{"models":["workOrderTask"],"connectors":[{"exitPortType":"NextStep","nodeId":"processworkOrderTaskScheduleBreakdown"}],"columns":{"workOrderTaskScheduleBreakdown":"[taskScheduleBreakdown](workOrderTaskId,id,startDate,endDate,duration)","workOrderTaskId":"workOrderTask.id"},"name":"fetchworkOrderTaskScheduleBreakdown","outerJoinOnModel":"workOrderTask","distinct":true,"inputVarMap":{"batchSize":"batchSize","batchNumber":"batchNumber"},"id":"fetchworkOrderTaskScheduleBreakdown","outputVarMap":{"data":"fetchworkOrderTaskScheduleBreakdown","batchNumber":"batchNumber"},"nodeType":"QUERY","getCount":true},"processZRule":{"connectors":[{"exitPortType":"NextStep","nodeId":"IfCustomerPortalInstalled"}],"contextChangePermitted":true,"name":"processZRule","description":"ZRule to create dynamic filter","processRule":"@PUQ89KC4I4","nodeType":"PROCESS","jsEngine":"es6"},"processDates":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchworkOrderTaskScheduleBreakdown"}],"contextChangePermitted":true,"name":"processDates","description":"processDates","processRule":"{ for (i = 0; i < contextVar.schedulingAndDispatchData.length; i++) { contextVar.siteTimeZone = contextVar.schedulingAndDispatchData[i].siteTimezoneOffset; function formatDate(date) { if (date) { var d = new Date(new Date(date).getTime() - contextVar.siteTimeZone * 60 * 1000); return (d.getDate() < 10 ? '0' + d.getDate() : d.getDate()) + '-' + (parseInt(d.getMonth() + 1) < 10 ? '0' + parseInt(d.getMonth() + 1) : parseInt(d.getMonth() + 1)) + '-' + d.getFullYear() + ' ' + (d.getHours() < 10 ? '0' + d.getHours() : d.getHours()) + ':' + (d.getMinutes() < 10 ? '0' + d.getMinutes() : d.getMinutes()) + ':00.000'; } else { return '-'; } } contextVar.workOrderTaskAppointmentWindowStartDate2 = formatDate(contextVar.schedulingAndDispatchData[i].workOrderTaskAppointmentWindowStartDate); contextVar.workOrderTaskAppointmentWindowEndDate2 = formatDate(contextVar.schedulingAndDispatchData[i].workOrderTaskAppointmentWindowEndDate); contextVar.workOrderTaskScheduledDate2 = formatDate(contextVar.schedulingAndDispatchData[i].workOrderTaskScheduledDate); contextVar.workOrderTaskDueDate2 = formatDate(contextVar.schedulingAndDispatchData[i].workOrderTaskDueDate); if (contextVar.workOrderTaskAppointmentWindowStartDate2 !== '-' && contextVar.workOrderTaskAppointmentWindowEndDate2 !== '-') { contextVar.workOrderTaskAppointmentWindow1 = contextVar.workOrderTaskAppointmentWindowStartDate2 + '-' + contextVar.workOrderTaskAppointmentWindowEndDate2; } else { contextVar.workOrderTaskAppointmentWindow1 = '-'; } if (contextVar.workOrderTaskDueDate2 !== '-' && contextVar.workOrderTaskScheduledDate2 !== '-') { contextVar.workOrderTaskScheduledTime1 = contextVar.workOrderTaskScheduledDate2 + '-' + contextVar.workOrderTaskDueDate2; } else { contextVar.workOrderTaskScheduledTime1 = '-'; } contextVar.schedulingAndDispatchData[i].workOrderTaskScheduledTime1 = contextVar.workOrderTaskScheduledTime1; contextVar.schedulingAndDispatchData[i].workOrderTaskAppointmentWindow1 = contextVar.workOrderTaskAppointmentWindow1; } }","nodeType":"PROCESS","jsEngine":"es6"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"getWorkforceWorkGroupDataForLoggedInUser"}],"name":"start","description":"start","id":"start","nodeType":"START"},"processWorkforceWorkGroupData":{"connectors":[{"exitPortType":"NextStep","nodeId":"decisionIfAllGroupApplied"}],"contextChangePermitted":true,"name":"processWorkforceWorkGroupData","description":"process work group data","processRule":"contextVar.isAllFilterApplied = false; var filters = []; if (typeof contextVar.workforceWorkGroupData != 'undefined' && contextVar.workforceWorkGroupData.length > 0) { if (contextVar.isAllFilterApplied != true) { contextVar.workforceWorkGroupData.forEach(function (element) { if (typeof contextVar[element.workGroupFilterMethod] === 'undefined') { if (element.workGroupFilterMethod === 'all') { contextVar.isAllFilterApplied = true; } contextVar[element.workGroupFilterMethod] = []; filters.push(element.workGroupFilterMethod); } if(contextVar[element.workGroupFilterMethod].indexOf(element.workGroupFilterFilterId) == -1) { contextVar[element.workGroupFilterMethod].push(element.workGroupFilterFilterId); } });} }","id":"processWorkforceWorkGroupData","nodeType":"PROCESS"},"queryCustomerRegion":{"models":["customer","workOrderTask","site","region"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchWorkOrderPriority"}],"columns":{"customerCompanyName":"customer.companyName","regionId":"site.regionId","regionName":"region.name","customerId":"site.customerId","workOrderTaskId":"workOrderTask.id","siteName":"site.name"},"description":"Query customer and region data","outerJoinOnModel":"site","inputVarMap":{"maxBatchSize":"batchSize","taskData":"taskData"},"nodeType":"QUERY","filter":"{$workOrderTaskId} in {@taskData}","name":"queryCustomerRegion","links":{"workOrderTask":"site","site":"customer","region":"site"},"id":"queryCustomerRegion","outputVarMap":{"data":"customerRegionData"},"batchSize":"batchSize","getCount":true},"fetchSchedulingData":{"models":{"tt":"taskType","tts":"taskScheduleBreakdown","wotaw":"workOrderTaskAppointmentWindow","s":"site","c":"crew","u":"User","wo":"workOrder","zst":"ZStatus","u1":"User","wot":"workOrderTask","wf":"workforce"},"connectors":[{"exitPortType":"NextStep","nodeId":"processDates"}],"columns":{"processStatus":"wot.acProcessStatus","acLenderId":"wo.acLenderId","rural":"wo.acTagRural","userPhoneNumber":"u.phoneNumber","historical":"wo.acTagHistorical","workOrderTaskAssignedToCrewId":"wot.assignedToCrewId","type":"IF({$wot.id} IS NULL,'','Task')","siteTimezoneOffset":"s.timezoneOffset","reportType":"wo.acReportType","contractValue":"wo.acContractValue","complex":"wo.acTagComplex","workOrderTaskId":"wot.id","taskIdTaskTypeName":"CONCAT({$wot.id},' - ',{$tt.name})","workOrderTaskModifiedDate":"wot.modifiedDate","gla":"wo.acTagGla","workOrderTaskEstimatedDurationMinutes":"wot.estimatedDuration","workOrderTaskCompletedDate":"wot.completedDate","longitude":"s.longitude","workOrderTaskLongDurationFlag":"wot.isLongDurationTask","contactName":"s.contactPerson","created":"wo.requestedDate","resultWebPageId":"tt.resultWebPageId","crewName":"c.name","taskTypeCrewTask":"tt.crewTask","tags":"wo.acTags","anowStatus":"wot.acProcessStatus","workOrderTaskTypeId":"wot.taskTypeId","incidentDetails":"wot.incidentDetails","modifiedDate":"wot.modifiedDate","workOrderId":"wo.id","assignee":"IF({$taskType.crewTask}=true,{$crew.name},{$User.name})","workOrderTaskScheduledDateMapView":"IF({$workOrderTask.scheduledDate} IS NULL,'-',{$workOrderTask.scheduledDate})","status":"wot.statusId","viewTravelStatus":"tt.viewTravelStatus","workOrderTaskAppointmentWindowStartDate":"wotaw.startDate","loanType":"wo.acLoanType","latitude":"s.latitude","primaryApprasierId":"wo.acPrimaryAppraiserId","icon":"IF({$workOrderTask.statusId} = 'workOrderTaskOpen',{@openIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskScheduled',{@scheduledIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskDispatched',{@dispatchedIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskInProgress',{@inProgressIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskIncident',{@incidentIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskInTransit',{@inTransitIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskDelayed',{@delayedIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskDiscontinued',{@discontinuedIcon}, (IF({$workOrderTask.statusId} = 'workOrderTaskPendingReview',{@pendingReviewIcon}, (IF({$workOrderTask.statusId} = 'workOrderTaskCompleted',{@completedIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskCancelled',{@cancelledIcon},'' ) ) ) )) )) ) ) ) ) ) ) ) ) ) ) ) ) ) )","siteName":"s.name","taskTypeName":"tt.name","workOrderPriority":"wo.priorityPriority","workOrderPrimaryAppraiser":"wo.acPrimaryAppraiserId","customerId":"s.customerId","statusName":"zst.name","workOrderTaskEstimatedDuration":"Round(({$workOrderTask.estimatedDuration})/60,2)","workOrderTaskResult":"wot.result","workOrderTaskAppointmentWindowEndDate":"wotaw.endDate","workOrderTaskAppointmentBasedFlag":"wot.isAppointmentBasedTask","address":"s.address","workOrderDeadline":"wo.deadline","workOrderTaskAppointmentWindow":"wotaw.startEndJson","workOrderTaskAppointmentWindowId":"wotaw.appointmentWindowId","primaryApprasier":"u1.name","userName":"u.name","statusNameColor":"zst.colorCode","workOrderTaskDueDate":"wot.dueDate","contactInformation":"s.contactPhone","createdDate":"wot.createdDate","regionId":"s.regionId","workOrderTaskScheduledDate":"wot.scheduledDate","acAddressTwo":"s.acAddressTwo"},"inputs":{"regionNames":{"filter":"{$regionName} like {@regionFilterString}","models":["region"],"columns":{"regionId":"region.id","regionName":"region.name"},"selectColumns":["regionId"]},"customerCompanyNames":{"filter":"{$customerCompanyName} like {@customerFilterString}","models":["customer"],"columns":{"customerCompanyName":"customer.companyName","customerId":"customer.id"},"selectColumns":["customerId"]}},"description":"Fetch Task Details","outerJoinOnModel":"workOrderTask","orderBy":"orderBy","distinct":true,"inputVarMap":{"statusFilter":"statusFilter","openIcon":"openIcon","orderBy":"orderBy","cancelledIcon":"cancelledIcon","regionFilterString":"regionFilterString","discontinuedIcon":"discontinuedIcon","customerFilter":"customerFilter","pendingReviewIcon":"pendingReviewIcon","filter":"filter","scheduledIcon":"scheduledIcon","delayedIcon":"delayedIcon","incidentIcon":"incidentIcon","customerFilterString":"customerFilterString","inTransitIcon":"inTransitIcon","taskFilter":"taskFilter","dispatchedIcon":"dispatchedIcon","workOrderFilter":"workOrderFilter","inProgressIcon":"inProgressIcon","region":"region","batchSize":"batchSize","completedIcon":"completedIcon","batchNumber":"batchNumber"},"nodeType":"QUERY","joinCondition":[{"wo":"wo.z2id= wot.z2work_order_id"},{"tts":"tts.z2work_order_task_id= wot.z2id"},{"wotaw":"wotaw.z2work_order_task_id= wot.z2id"},{"wf":"wf.z2user_id= wot.z2assigned_to_user_id"},{"zst":"zst.id= wot.z2status_id"},{"tt":"tt.z2id= wot.z2task_type_id"},{"u":"u.id= wot.z2assigned_to_user_id"},{"s":"s.z2id= wot.z2site_id"},{"c":"c.z2id= wot.z2assigned_to_crew_id"},{"u1":"u1.id= wo.z2ac_primary_appraiser_id"}],"filter":"filter","name":"fetchSchedulingData","id":"fetchSchedulingData","outputVarMap":{"data":"schedulingAndDispatchData","count":"count","batchNumber":"batchNumber"},"batchSize":"batchSize","getCount":true,"batchNumber":"batchNumber"},"fetchSchedulingDataWithCP":{"models":{"tt":"taskType","tts":"taskScheduleBreakdown","wotaw":"workOrderTaskAppointmentWindow","s":"site","c":"crew","u":"User","cpd":"customerPortalOrderDetails","wo":"workOrder","zst":"ZStatus","u1":"User","wot":"workOrderTask","wf":"workforce"},"connectors":[{"exitPortType":"NextStep","nodeId":"processDates"}],"columns":{"processStatus":"wot.acProcessStatus","acLenderId":"wo.acLenderId","rural":"wo.acTagRural","userPhoneNumber":"u.phoneNumber","historical":"wo.acTagHistorical","workOrderTaskAssignedToCrewId":"wot.assignedToCrewId","type":"IF({$wot.id} IS NULL,'','Task')","siteTimezoneOffset":"s.timezoneOffset","reportType":"wo.acReportType","contractValue":"wo.acContractValue","complex":"wo.acTagComplex","workOrderTaskId":"wot.id","taskIdTaskTypeName":"CONCAT({$wot.id},' - ',{$tt.name})","bookingStatus":" IF({$cpd.statusId} = 'fscx2_0_userBookingConfirmed','Confirmed',(IF({$cpd.statusId} = 'fscx2_0_userBookingUnconfirmed','Unconfirmed','-' ) ) )","workOrderTaskModifiedDate":"wot.modifiedDate","gla":"wo.acTagGla","workOrderTaskEstimatedDurationMinutes":"wot.estimatedDuration","workOrderTaskCompletedDate":"wot.completedDate","longitude":"s.longitude","workOrderTaskLongDurationFlag":"wot.isLongDurationTask","contactName":"s.contactPerson","created":"wo.requestedDate","resultWebPageId":"tt.resultWebPageId","crewName":"c.name","taskTypeCrewTask":"tt.crewTask","tags":"wo.acTags","UID":"cpd.UID","anowStatus":"wot.acProcessStatus","workOrderTaskTypeId":"wot.taskTypeId","incidentDetails":"wot.incidentDetails","bookingStatusId":"cpd.statusId","modifiedDate":"wot.modifiedDate","workOrderId":"wo.id","assignee":"IF({$taskType.crewTask}=true,{$crew.name},{$User.name})","workOrderTaskScheduledDateMapView":"IF({$workOrderTask.scheduledDate} IS NULL,'-',{$workOrderTask.scheduledDate})","status":"wot.statusId","viewTravelStatus":"tt.viewTravelStatus","workOrderTaskAppointmentWindowStartDate":"wotaw.startDate","loanType":"wo.acLoanType","latitude":"s.latitude","primaryApprasierId":"wo.acPrimaryAppraiserId","icon":"IF({$workOrderTask.statusId} = 'workOrderTaskOpen',{@openIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskScheduled',{@scheduledIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskDispatched',{@dispatchedIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskInProgress',{@inProgressIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskIncident',{@incidentIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskInTransit',{@inTransitIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskDelayed',{@delayedIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskDiscontinued',{@discontinuedIcon}, (IF({$workOrderTask.statusId} = 'workOrderTaskPendingReview',{@pendingReviewIcon}, (IF({$workOrderTask.statusId} = 'workOrderTaskCompleted',{@completedIcon},(IF({$workOrderTask.statusId} = 'workOrderTaskCancelled',{@cancelledIcon},'' ) ) ) )) )) ) ) ) ) ) ) ) ) ) ) ) ) ) )","siteName":"s.name","taskTypeName":"tt.name","workOrderPriority":"wo.priorityPriority","workOrderPrimaryAppraiser":"wo.acPrimaryAppraiserId","customerId":"s.customerId","statusName":"zst.name","workOrderTaskEstimatedDuration":"Round(({$workOrderTask.estimatedDuration})/60,2)","workOrderTaskResult":"wot.result","workOrderTaskAppointmentWindowEndDate":"wotaw.endDate","workOrderTaskAppointmentBasedFlag":"wot.isAppointmentBasedTask","address":"s.address","workOrderDeadline":"wo.deadline","workOrderTaskAppointmentWindow":"wotaw.startEndJson","workOrderTaskAppointmentWindowId":"wotaw.appointmentWindowId","primaryApprasier":"u1.name","userName":"u.name","statusNameColor":"zst.colorCode","workOrderTaskDueDate":"wot.dueDate","contactInformation":"s.contactPhone","createdDate":"wot.createdDate","regionId":"s.regionId","workOrderTaskScheduledDate":"wot.scheduledDate","acAddressTwo":"s.acAddressTwo"},"inputs":{"regionNames":{"filter":"{$regionName} like {@regionFilterString}","models":["region"],"columns":{"regionId":"region.id","regionName":"region.name"},"selectColumns":["regionId"]},"customerCompanyNames":{"filter":"{$customerCompanyName} like {@customerFilterString}","models":["customer"],"columns":{"customerCompanyName":"customer.companyName","customerId":"customer.id"},"selectColumns":["customerId"]}},"description":"Fetch Task Details","outerJoinOnModel":"workOrderTask","orderBy":"orderBy","distinct":true,"inputVarMap":{"statusFilter":"statusFilter","openIcon":"openIcon","orderBy":"orderBy","cancelledIcon":"cancelledIcon","regionFilterString":"regionFilterString","discontinuedIcon":"discontinuedIcon","customerFilter":"customerFilter","pendingReviewIcon":"pendingReviewIcon","filter":"filter","scheduledIcon":"scheduledIcon","delayedIcon":"delayedIcon","incidentIcon":"incidentIcon","customerFilterString":"customerFilterString","inTransitIcon":"inTransitIcon","taskFilter":"taskFilter","dispatchedIcon":"dispatchedIcon","workOrderFilter":"workOrderFilter","inProgressIcon":"inProgressIcon","region":"region","batchSize":"batchSize","completedIcon":"completedIcon","batchNumber":"batchNumber"},"nodeType":"QUERY","joinCondition":[{"cpd":"cpd.z2job_id = wot.z2id"},{"wo":"wo.z2id= wot.z2work_order_id"},{"tts":"tts.z2work_order_task_id= wot.z2id"},{"wotaw":"wotaw.z2work_order_task_id= wot.z2id"},{"wf":"wf.z2user_id= wot.z2assigned_to_user_id"},{"zst":"zst.id= wot.z2status_id"},{"tt":"tt.z2id= wot.z2task_type_id"},{"u":"u.id= wot.z2assigned_to_user_id"},{"s":"s.z2id= wot.z2site_id"},{"c":"c.z2id= wot.z2assigned_to_crew_id"},{"u1":"u1.id= wo.z2ac_primary_appraiser_id"}],"filter":"filter","name":"fetchSchedulingDataWithCP","id":"fetchSchedulingDataWithCP","outputVarMap":{"data":"schedulingAndDispatchData","count":"count","batchNumber":"batchNumber"},"batchSize":"batchSize","getCount":true,"batchNumber":"batchNumber"},"workflowNodes":["start","getWorkforceWorkGroupDataForLoggedInUser","decisionIfWorkforceWorkGroupDataPresent","processWorkforceWorkGroupData","decisionIfAllGroupApplied","decisionIfRegionIdsOrCustomerIdsPresent","processFilterForSiteQuery","getSiteIds","decisionIfWOTypeIdsPresent","getWorkOrderIds","processSiteIdsAndWorkOrderIds","checkIfCustomerPortalOrderDetailsModelPresentWF","processZRule","fetchSchedulingDataWithCP","IfCustomerPortalInstalled","fetchSchedulingData","processDates","fetchworkOrderTaskScheduleBreakdown","processworkOrderTaskScheduleBreakdown","areTasksPresent","addTasksIntoArray","queryCustomerRegion","fetchWorkOrderPriority","fetchAccLenderData","processTaskData","emptyResult","end"],"decisionIfWOTypeIdsPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"getWorkOrderIds"},{"exitPortType":"FalseStep","nodeId":"processSiteIdsAndWorkOrderIds"}],"name":"decisionIfWOTypeIdsPresent","description":"decisionIfWOTypeIdsPresent","processRule":"(typeof contextVar.workOrderType !== 'undefined' && contextVar.workOrderType !== '' && contextVar.workOrderType.length > 0 )","id":"decisionIfWOTypeIdsPresent","nodeType":"DECISION"},"fetchAccLenderData":{"models":["accLender"],"connectors":[{"exitPortType":"NextStep","nodeId":"processTaskData"}],"columns":{"lenderName":"accLender.lenderName","id":"accLender.id","lenderId":"accLender.lenderId"},"name":"fetchAccLenderData","description":"Query customer and region data","inputVarMap":{},"id":"fetchAccLenderData","outputVarMap":{"data":"accLenderData"},"nodeType":"QUERY","getCount":true},"emptyResult":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"emptyResult","description":"emptyResult","processRule":"if (contextVar.schedulingAndDispatchData == '') {contextVar.schedulingAndDispatchData = []}","id":"emptyResult","nodeType":"PROCESS"},"decisionIfWorkforceWorkGroupDataPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processWorkforceWorkGroupData"},{"exitPortType":"FalseStep","nodeId":"checkIfCustomerPortalOrderDetailsModelPresentWF"}],"name":"decisionIfWorkforceWorkGroupDataPresent","description":"check if work group data exists","processRule":"(typeof contextVar.workforceWorkGroupData !== 'undefined' && contextVar.workforceWorkGroupData !== '' && contextVar.workforceWorkGroupData.length > 0)","id":"decisionIfAllGroupApplied","nodeType":"DECISION"},"decisionIfRegionIdsOrCustomerIdsPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processFilterForSiteQuery"},{"exitPortType":"FalseStep","nodeId":"decisionIfWOTypeIdsPresent"}],"name":"decisionIfRegionIdsOrCustomerIdsPresent","description":"check if region ids or customer ids exist","processRule":"((typeof contextVar.region !== 'undefined' && contextVar.region !== '' && contextVar.region.length > 0 )|| (typeof contextVar.customer !== 'undefined' && contextVar.customer !== '' && contextVar.customer.length > 0))","id":"decisionIfRegionIdsOrCustomerIdsPresent","nodeType":"DECISION"}}