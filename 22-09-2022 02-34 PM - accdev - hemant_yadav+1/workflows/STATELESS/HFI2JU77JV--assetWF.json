{"getAllAssetsData":{"filter":"{$siteId} in {@siteIdList} AND {$installedBase.statusId}='installedBaseActive'","models":["installedBase","site"],"connectors":[{"exitPortType":"NextStep","nodeId":"areAssetsPresent"}],"columns":{"decommDate":"site.modifiedDate","statusId":"IF({$installedBase.id} IS NULL,'','installedBaseDecommissioned')","siteId":"installedBase.siteId","id":"installedBase.id"},"name":"getAllAssetsData","description":"getAllAssetsData","inputVarMap":{"customBatchSize":"batchSize","siteIdList":"siteIdList"},"outputVarMap":{"data":"installedBase","count":"assetsCount","batchNumber":"assetsBatchNumber"},"batchSize":"batchSize","nodeType":"QUERY","getCount":true},"upsertInstalledBase":{"modelName":"installedBase","connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"multirecord":true,"name":"upsertInstalledBase","description":"upsertInstalledBase","inputVarMap":{"jsonObj":"data"},"outputVarMap":{"catalogId":"catalogId","data":"data","serialNo":"serialNo"},"nodeType":"MODEL","operation":4},"findNumberOfBatches":{"connectors":[{"exitPortType":"NextStep","nodeId":"areMoreBatchesPresent"}],"contextChangePermitted":true,"name":"findNumberOfBatches","description":"findNumberOfBatches","processRule":"{ contextVar.noOfAssetsBatches = Math.ceil(contextVar.assetsCount / contextVar.customBatchSize);contextVar.assetsBatchNumber++; }","nodeType":"PROCESS"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"multiDecisionNodeUpsertOrDeactivate"}],"name":"start","description":"Start","nodeType":"START"},"areAssetsPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"findNumberOfBatches"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"areAssetsPresent","description":"areAssetsPresent","processRule":"(typeof contextVar.installedBase !== 'undefined' &&  contextVar.installedBase !=='')","nodeType":"DECISION"},"getMoreAssets":{"filter":"{$siteId} in {@siteIdList} AND {$installedBase.statusId}='installedBaseActive'","models":["installedBase","site"],"connectors":[{"exitPortType":"NextStep","nodeId":"appendAssets"}],"columns":{"decommDate":"site.modifiedDate","statusId":"IF({$installedBase.id} IS NULL,'','installedBaseDecommissioned')","siteId":"installedBase.siteId","id":"installedBase.id"},"name":"getMoreAssets","description":"getMoreAssets","inputVarMap":{"customBatchSize":"batchSize","siteIdList":"siteIdList","assetsBatchNumber":"batchNumber"},"outputVarMap":{"data":"moreInstalledBase"},"batchSize":"batchSize","nodeType":"QUERY","getCount":true,"batchNumber":"batchNumber"},"workflowNodes":["start","multiDecisionNodeUpsertOrDeactivate","getAllAssetsData","areAssetsPresent","findNumberOfBatches","areMoreBatchesPresent","getMoreAssets","appendAssets","processZRule","multiDecisionNode","upsertInstalledBase","end"],"areMoreBatchesPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"getMoreAssets"},{"exitPortType":"FalseStep","nodeId":"processZRule"}],"name":"areMoreBatchesPresent","description":"areMoreBatchesPresent","processRule":"(contextVar.noOfAssetsBatches >= 2 && contextVar.noOfAssetsBatches >= contextVar.assetsBatchNumber)","nodeType":"DECISION"},"workflowContext":{"customBatchSize":1000,"noOfAssetsBatches":0},"multiDecisionNode":{"connectors":[{"condition":"contextVar.subAction === 'upsertInstalledBase' || contextVar.subAction === 'deactivateInstalledBase'","exitPortType":"NextStep","nodeId":"upsertInstalledBase"},{"DefaultStep":true,"condition":"contextVar.subAction===''","exitPortType":"NextStep","nodeId":"end"}],"name":"multiDecisionNode","description":"multiDecisionNode","nodeType":"MULTIDECISION"},"appendAssets":{"connectors":[{"exitPortType":"NextStep","nodeId":"areMoreBatchesPresent"}],"contextChangePermitted":true,"name":"appendAssets","description":"appendAssets","processRule":"{ if (Array.isArray(contextVar.moreInstalledBase)) { contextVar.installedBase = contextVar.installedBase.concat(contextVar.moreInstalledBase); } contextVar.assetsBatchNumber++; }","nodeType":"PROCESS"},"end":{"name":"End","description":"end","inputVarMap":{"data":"data"},"outputVarMap":{"data":"data"},"nodeType":"END"},"processZRule":{"connectors":[{"exitPortType":"NextStep","nodeId":"multiDecisionNode"}],"contextChangePermitted":true,"name":"processZRule","description":"processZRule","processRule":"@LXRPOL7SJP","nodeType":"PROCESS"},"multiDecisionNodeUpsertOrDeactivate":{"connectors":[{"condition":"contextVar.subAction === 'upsertInstalledBase'","exitPortType":"NextStep","nodeId":"processZRule"},{"condition":"contextVar.subAction === 'deactivateInstalledBase'","exitPortType":"NextStep","nodeId":"getAllAssetsData"},{"DefaultStep":true,"condition":"contextVar.subAction===''","exitPortType":"NextStep","nodeId":"end"}],"name":"multiDecisionNodeUpsertOrDeactivate","description":"multiDecisionNodeUpsertOrDeactivate","nodeType":"MULTIDECISION"}}