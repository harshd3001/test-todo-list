{"pageContext":{},"actionOnLoad":["@actions.fireProcessEventForTaskReviewFetchData","@actions.fireProcessEventForSiteChangeLogData","@actions.processResponseData","@actions.calculateActualTaskDuration","@actions.getCurrentLatLong","@actions.processSiteChangeData","@actions.getUpdatedLatLong","@actions.setCoordinate","@actions.setInitialData","@actions.isHidden"],"localPageContext":true,"jslib":{"isSumbitDisabled":"function(pageContext){if (pageContext.taskReviewResult === '' || typeof pageContext.taskReviewResult === 'undefined') {return true;} else if (pageContext.taskReviewResult === 'approve') {return false;}else if (pageContext.taskReviewResult === 'reject') {return false;}}","isNotesHidden":"function(pageContext){if (pageContext.taskReviewResult === '' || typeof pageContext.taskReviewResult === 'undefined') {return true;}return false;}","isDisabled":"function(pageContext){return (pageContext.status === 'workOrderTaskCompleted' || pageContext.status === 'workOrderTaskCancelled' );}","isTaskCompeletedOrCancelled":"function(pageContext) { return (pageContext.status==='workOrderTaskCompleted'|| pageContext.status==='workOrderTaskCancelled'); }","getLocationCoordinates":"function(pageContext){if((typeof pageContext.siteAddress!=='undefined'&&pageContext.siteAddress!=='')&&((typeof pageContext.siteLatitude!=='undefined'&&pageContext.siteLatitude!=='')&&(typeof pageContext.siteLongitude!=='undefined'&&pageContext.siteLongitude!==''))){return[Number(pageContext.siteLatitude),Number(pageContext.siteLongitude)];}return[0,0];}","isActionCompleted":"function(pageContext) {return pageContext.workOrderTaskAction === 'completed'}"},"header":{"children":[{"statusColor":"@pageContext.statusNameColor","id":"status","type":"status","value":"@pageContext.statusName"},{"isRequired":false,"hidden":"@jslib.isTaskCompeletedOrCancelled","data":[{"buttonType":"secondary","hidden":false,"actionOnClick":["@actions.setActionApproveTask","@actions.openApproveRejectNSP"],"id":"approveTask","type":"button","title":"@lang.['at6','Approve Task']"},{"buttonType":"secondary","hidden":false,"actionOnClick":["@actions.setActionRejectTask","@actions.openApproveRejectNSP"],"id":"rejectTask","type":"button","title":"@lang.['rt6','Reject Task']"}],"type":"actionDropdown","title":"@lang.['o4','Options']"},{"icon":"@iconlib.NavigationCloseGrey","actionOnClick":["@actions.closePanel","@actions.clearPageContext","@actions.refreshDataGrid"],"id":"close","type":"buttonIcon"}],"title":"@lang.['scr1','Site Change Request']"},"body":{"children":[{"children":[{"children":[{"children":[{"mapElementStyle":{"width":"100%","height":"14rem"},"defaultZoom":8,"preserveViewport":false,"location":"@pageContext.arr1","id":"mapForShowStatic","type":"map","renderType":"location","mapElementHeight":"100%","mapJson":{}},{"disabled":true,"id":"currentLocation","label":"@lang.['cl','Current Location']","placeholder":"@lang.['eca','Enter current address']","type":"address","value":"@pageContext.siteAddress"},{"disabled":true,"inputType":"text","id":"currentLatLong","label":"@lang.['cll','Current Latitude & Longitude']","type":"input","value":"@pageContext.currentLatLong"},{"disabled":true,"id":"updatedLocation","label":"@lang.['ul','Updated Location']","placeholder":"@lang.['eua','Enter updated address']","type":"address","value":"@pageContext.updatedLocation"},{"disabled":true,"inputType":"text","id":"updatedLatLong","label":"@lang.['ull','Updated Latitude & Longitude']","placeholder":"@lang.['ull','Updated Latitude & Longitude']","type":"input","value":"@pageContext.updatedLatLong"},{"disabled":true,"id":"photoEvidence","label":"@lang.['pe','Photo Evidence']","type":"image","value":"@pageContext.photoEvidence"},{"disabled":true,"id":"reason","label":"@lang.['r5','Reason']","type":"input","value":"@pageContext.reason","placeHolder":"@lang.['er1','Enter reason']"},{"disabled":true,"inputType":"text","id":"notes","label":"@lang.['n2','Notes (Optional)']","placeholder":"@lang.['n2','Notes (Optional)']","type":"textarea","value":"@pageContext.notes"}],"id":"addressUpdate","label":"@lang.['au','Address Update']","type":"section"}],"label":"@lang.['scr','Site Change Review']","type":"tab"},{"children":[{"children":[{"disabled":true,"inputType":"text","id":"customerCompanyName","label":"@lang.['customer','Customer']","placeholder":"@lang.['cn2','Customer Name']","type":"input","value":"@pageContext.customerCompanyName"},{"disabled":true,"inputType":"text","id":"customerContactPerson","label":"@lang.['cpn','Contact Person Name']","placeholder":"@lang.['cpn','Contact Person Name']","type":"input","value":"@pageContext.customerContactPerson"},{"disabled":true,"inputType":"text","id":"customerContactTitle","label":"@lang.['ct3','Contact Title']","placeholder":"@lang.['ct3','Contact Title']","type":"input","value":"@pageContext.customerContactTitle"},{"disabled":true,"inputType":"text","id":"customerContactPhone","label":"@lang.['cp','Contact Phone']","type":"phoneNumber","value":"@pageContext.customerContactPhone","placeHolder":"@lang.['cp','Contact Phone']"},{"disabled":true,"inputType":"text","id":"customerContactEmail","label":"@lang.['ce','Contact Email']","placeholder":"@lang.['ce','Contact Email']","type":"input","value":"@pageContext.customerContactEmail"}],"id":"customer","label":"@lang.['customer','Customer']","type":"section"},{"children":[{"disabled":true,"inputType":"text","id":"siteName","label":"@lang.['cs','Customer Site']","placeholder":"@lang.['cs','Customer Site']","type":"input","value":"@pageContext.siteName"},{"disabled":true,"inputType":"text","id":"siteAddress","label":"@lang.['address','Address']","type":"address","value":"@pageContext.siteAddress","placeHolder":"@lang.['address','Address']"},{"containerElementHeight":"30rem","item":{"fieldsToShow":[]},"defaultZoom":17,"preserveViewport":false,"location":{"children":[{"dataType":"label","id":"siteAddressMap","type":"text","value":"@pageContext.siteAddress"}],"coordinates":"@jslib.getLocationCoordinates","icon":"https://cdn.zeplin.io/5be3ee39a464fd7e89ffaaa0/assets/57BF1B12-69E2-4E77-881C-A53900EB4260.svg","type":"Point"},"id":"mapForShowStatic","type":"map","renderType":"location","mapElementHeight":"100%","mapJson":{}}],"id":"location","label":"@lang.['l3','Location']","type":"section"}],"label":"@lang.['osd','Original Site Details']","id":"originalSiteDetail","type":"tab"},{"children":[{"children":[{"disabled":true,"inputType":"text","id":"workOrderTypeName","label":"@lang.['wot1','Work Order Type']","placeholder":"@lang.['wot1','Work Order Type']","type":"input","value":"@pageContext.workOrderTypeName"},{"disabled":true,"inputType":"text","id":"workOrderTaskWorkOrderId","label":"@lang.['WorkOrderId','Work Order ID']","placeholder":"@lang.['WorkOrderId','Work Order ID']","type":"input","value":"@pageContext.workOrderTaskWorkOrderId"}],"id":"workOrder","label":"@lang.['wo','Work Order']","type":"section"},{"children":[{"disabled":true,"inputType":"text","id":"taskTypeName","label":"@lang.['taskType','Task Type']","placeholder":"@lang.['taskType','Task Type']","type":"input","value":"@pageContext.taskTypeName"},{"disabled":true,"inputType":"text","id":"workOrderTaskNotes","label":"@lang.['n2','Notes (Optional)']","placeholder":"@lang.['n2','Notes (Optional)']","type":"input","value":"@pageContext.workOrderTaskNotes"}],"id":"taskDetails","label":"@lang.['taskDetails','Task Details']","type":"section"},{"hidden":true,"children":[{"disabled":true,"inputType":"text","id":"workOrderTaskScheduledDate","label":"@lang.['ssdt','Schedule Start Date & Time']","placeholder":"@lang.['ssdt','Schedule Start Date & Time']","type":"input","value":"@pageContext.workOrderTaskScheduledDate"},{"disabled":true,"inputType":"text","id":"workOrderTaskDueDate","label":"@lang.['sedt','Schedule End Date & Time']","placeholder":"@lang.['sedt','Schedule End Date & Time']","type":"input","value":"@pageContext.workOrderTaskDueDate"},{"disabled":true,"inputType":"text","id":"workOrderTaskEstimatedDuration","label":"@lang.['etd1','Estimated Task Duration (Minutes)']","placeholder":"@lang.['etd1','Estimated Task Duration (Minutes)']","type":"input","value":"@pageContext.workOrderTaskEstimatedDuration"}],"id":"originalSchedule","label":"@lang.['os','Original Schedule']","type":"section"},{"hidden":true,"children":[{"disabled":true,"inputType":"text","id":"workOrderTaskActualStartTime","label":"@lang.['asdt','Actual Start Date & Time']","placeholder":"@lang.['asdt','Actual Start Date & Time']","type":"input","value":"@pageContext.workOrderTaskActualStartTime"},{"disabled":true,"inputType":"text","id":"workOrderTaskCompletedDate","label":"@lang.['aedt','Actual End Date & Time']","placeholder":"@lang.['aedt','Actual End Date & Time']","type":"input","value":"@pageContext.workOrderTaskCompletedDate"},{"disabled":true,"inputType":"text","id":"actualTaskDuration","label":"@lang.['atd','Actual Task Duration (Minutes)']","placeholder":"@lang.['atd','Actual Task Duration (Minutes)']","type":"input","value":"@pageContext.actualTaskDuration"}],"id":"actualSchedule","label":"@lang.['as','Actual Schedule']","type":"section"}],"label":"@lang.['otd','Original Task Details']","type":"tab"}],"label":"","type":"tab"}]},"actions":[{"name":"calculateActualTaskDuration","type":"script","actionDef":"function(pageContext) {if (typeof pageContext.workOrderTaskActualStartTime != 'undefined' && typeof pageContext.workOrderTaskCompletedDate != 'undefined') {var startDate = new Date(pageContext.workOrderTaskActualStartTime);var completedDate = new Date(pageContext.workOrderTaskCompletedDate);var diffTime = Math.abs(completedDate - startDate);pageContext.actualTaskDuration = Math.ceil(diffTime / (1000 * 60));}}"},{"name":"clearPageContext","type":"clearPageContext"},{"name":"openApproveRejectNSP","type":"openPanel","pageId":"taskSchedulingPendingReviewSiteChangeRequestApproveRejectNSP"},{"name":"closePanel","type":"closePanel"},{"endPoint":"event/start","name":"fireProcessEventForTaskReviewFetchData","outputVarMap":{"data":"@pageContext.responseData"},"type":"api","actionDef":{"data":[{"eventId":"LHCUF48WQB","contextVar":{"workOrderTaskTypeId":"@pageContext.workOrderTaskTypeId","workOrderTaskId":"@pageContext.workOrderTaskId"}}]}},{"endPoint":"event/start","name":"fireProcessEventForSiteChangeLogData","outputVarMap":{"data":"@pageContext.siteChangeLogData"},"type":"api","actionDef":{"data":[{"eventId":"OG76EF8DXK","contextVar":{"workOrderTaskId":"@pageContext.workOrderTaskId"}}]}},{"name":"isHidden","type":"script","actionDef":"function(pageContext){if((pageContext.taskReviewResult === 'approve') || (pageContext.taskReviewResult === 'reject')) {pageContext.isReviewNoteVisible = false;}if (pageContext.taskReviewResult === 'approve') {pageContext.isActionReject = false;pageContext.isActionApprove = true;}if (pageContext.taskReviewResult === 'reject') {pageContext.isActionApprove = false;pageContext.isActionReject = true;}}"},{"name":"setActionApproveTask","type":"script","actionDef":"function(pageContext) {pageContext.taskReviewResult = 'approve';}"},{"name":"setActionRejectTask","type":"script","actionDef":"function(pageContext) {pageContext.taskReviewResult = 'reject';}"},{"name":"clearTaskReviewLogReviewNotes","type":"script","actionDef":"function (pageContext) {pageContext.taskReviewLogReviewNotes = '';}"},{"name":"refreshDataGrid","type":"refreshDataGrid"},{"name":"closeModal","type":"closeModal"},{"name":"getCurrentLatLong","type":"script","actionDef":"function(pageContext){pageContext.currentLatLong = pageContext.siteLatitude + ',' + pageContext.siteLongitude}"},{"name":"getUpdatedLatLong","type":"script","actionDef":"function(pageContext){pageContext.updatedLatLong = pageContext.updatedLat + ',' + pageContext.updatedLong}"},{"name":"setCoordinate","type":"script","actionDef":"function(pageContext){pageContext.corrdinate1=[parseFloat(pageContext.siteLatitude),parseFloat(pageContext.siteLongitude)];pageContext.corrdinate2=[parseFloat(pageContext.updatedLat),parseFloat(pageContext.updatedLong)];pageContext.arr1=[];var obj1={coordinates:pageContext.corrdinate1,icon:'https://zinier-static.s3-us-west-2.amazonaws.com/workflow-images/Red%40svg.svg',type:'Point',children:[{id:'text1',type:'text',dataType:'label',value:'Current Address'}]};var obj2={coordinates:pageContext.corrdinate2,icon:'https://zinier-static.s3-us-west-2.amazonaws.com/workflow-images/Green%40svg.svg',type:'Point',children:[{id:'text2',type:'text',dataType:'label',value:'Updated Address'}]};pageContext.arr1.push(obj1);pageContext.arr1.push(obj2);}"},{"name":"setInitialData","type":"script","actionDef":"function(pageContext){pageContext.isReviewNoteVisible = true;pageContext.isActionApprove = true;pageContext.isActionReject = true; if (pageContext.status ==='workOrderTaskCompleted'){pageContext.taskReviewResult = 'approve'}}"},{"name":"processResponseData","type":"script","actionDef":"function (pageContext) { if (typeof pageContext.responseData !== 'undefined' && pageContext.responseData !== '') { if (pageContext.responseData[0].data[0].workOrderTaskData.length > 0) { for (var i = 0; i < pageContext.responseData[0].data[0].workOrderTaskData.length; i++) { if (typeof pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData !== 'undefined') { pageContext.workOrderTaskData = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData; } } } else { pageContext.workOrderTaskData = pageContext.responseData[0].data[0].workOrderTaskData; } pageContext.workOrderTaskId = pageContext.workOrderTaskData.workOrderTaskId; pageContext.taskTypeName = pageContext.workOrderTaskData.taskTypeName; pageContext.workOrderTaskWorkOrderId = pageContext.workOrderTaskData.workOrderTaskWorkOrderId; pageContext.workOrderTypeName = pageContext.workOrderTaskData.workOrderTypeName; pageContext.ZPriorityName = pageContext.workOrderTaskData.ZPriorityName; pageContext.siteName = pageContext.workOrderTaskData.siteName; pageContext.workOrderTaskNotes = pageContext.workOrderTaskData.workOrderTaskNotes; pageContext.workOrderTaskDueDate = pageContext.workOrderTaskData.workOrderTaskDueDate; pageContext.workOrderTaskEstimatedDuration = pageContext.workOrderTaskData.workOrderTaskEstimatedDuration; pageContext.workOrderTaskActualStartTime = pageContext.workOrderTaskData.workOrderTaskActualStartTime; pageContext.workOrderTaskCompletedDate = pageContext.workOrderTaskData.workOrderTaskCompletedDate; pageContext.actualTaskDuration = pageContext.workOrderTaskData.actualTaskDuration; pageContext.customerContactPerson = pageContext.workOrderTaskData.customerContactPerson; pageContext.customerContactTitle = pageContext.workOrderTaskData.customerContactTitle; pageContext.customerContactPhone = pageContext.workOrderTaskData.customerContactPhone; pageContext.customerContactEmail = pageContext.workOrderTaskData.customerContactEmail; pageContext.siteAddress = pageContext.workOrderTaskData.siteAddress; pageContext.siteId = pageContext.workOrderTaskData.siteId; pageContext.siteLongitude = pageContext.workOrderTaskData.siteLongitude; pageContext.siteLatitude = pageContext.workOrderTaskData.siteLatitude; pageContext.taskTypeWebTask = pageContext.workOrderTaskData.taskTypeWebTask; } }"},{"name":"processSiteChangeData","type":"script","actionDef":"function(pageContext) { if(typeof pageContext.siteChangeLogData !== 'undefined' && pageContext.siteChangeLogData !== '' && Array.isArray(pageContext.siteChangeLogData) && pageContext.siteChangeLogData.length > 0 && Array.isArray(pageContext.siteChangeLogData[0].data) && pageContext.siteChangeLogData[0].data.length > 0 && Array.isArray(pageContext.siteChangeLogData[0].data[0].siteChangeLogData) && pageContext.siteChangeLogData[0].data[0].siteChangeLogData.length > 0) { pageContext.updatedLocation = pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogAddress?pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogAddress:''; if(typeof pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogPhotoUrl != 'undefined' || pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogPhotoUrl != '') { pageContext.photoEvidence = pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogPhotoUrl; }pageContext.reason = pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogReason?pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogReason:''; pageContext.notes = pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogNotes?pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogNotes:''; pageContext.updatedLat = pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogLatitude?pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogLatitude:''; pageContext.updatedLong = pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogLongitude?pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogLongitude:''; pageContext.siteChangeLogId = pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogId?pageContext.siteChangeLogData[0].data[0].siteChangeLogData[0].siteChangeLogId:'';}}"}]}