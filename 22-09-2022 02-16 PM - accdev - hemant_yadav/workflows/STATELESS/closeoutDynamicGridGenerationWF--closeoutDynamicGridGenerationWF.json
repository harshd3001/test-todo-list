{"queryTasks":{"models":["workOrder","taskType","workOrderTask"],"connectors":[{"exitPortType":"NextStep","nodeId":"loopThroughTasksList"}],"columns":{"workOrderTaskStatusId":"workOrderTask.statusId","taskTypeWebTask":"taskType.webTask","workOrderId":"workOrder.id","workOrderTaskResult":"workOrderTask.result","taskId":"workOrderTask.id"},"description":"Query Tasks","inputVarMap":{"workOrderId":"wId"},"nodeType":"QUERY","filter":"{$workOrderId} = {@wId} AND {$workOrderTaskStatusId} != 'workOrderTaskCancelled' AND {$taskTypeWebTask} = false","distict":true,"name":"queryTasks","links":{"workOrder":"workOrderTask","taskType":"workOrderTask"},"id":"queryTasks","outputVarMap":{"data":"workOrderData"},"getCount":true},"loopThroughTasksList":{"connectors":[{"exitPortType":"TrueStep","nodeId":"closeoutPackageProcessCount"},{"exitPortType":"FalseStep","nodeId":"fetchLocalizedKeys"}],"data":"workOrderData","name":"loopThroughTasksList","description":"loopThroughTasksList","inputVarMap":{},"outputVarMap":{},"nodeType":"FOREACHLOOP"},"workflowContext":{"serviceTotalCount":0,"finalTotalCount":0,"initialTotalCount":0,"dynamicGridData":[],"progressTotalCount":0},"closeoutPackageProcessCount":{"connectors":[{"exitPortType":"NextStep","nodeId":"loopThroughTasksList"}],"contextChangePermitted":true,"name":"closeoutPackageZrule","description":"closeoutPackageZrule","processRule":"if (contextVar.loopThroughTasksList_currentElement.workOrderTaskResult && Array.isArray(contextVar.loopThroughTasksList_currentElement.workOrderTaskResult)) { contextVar.loopThroughTasksList_currentElement.workOrderTaskResult.forEach(function (element) { if (element.initialEvidenceDataGrid && Array.isArray(element.initialEvidenceDataGrid)) { contextVar.initialTotalCount += element.initialEvidenceDataGrid.length; } if (element.servicesDataGrid && Array.isArray(element.servicesDataGrid)) { contextVar.serviceTotalCount += element.servicesDataGrid.length; } if (element.finalEvidenceDataGrid && Array.isArray(element.finalEvidenceDataGrid)) { contextVar.finalTotalCount += element.finalEvidenceDataGrid.length; } if (element.submitProgressEvidenceDataGrid && Array.isArray(element.submitProgressEvidenceDataGrid)) { contextVar.progressTotalCount += element.submitProgressEvidenceDataGrid.length; } }); }","nodeType":"PROCESS","jsEngine":"es6"},"fetchLocalizedKeys":{"filter":"{$listOptionAnswer.listOptionId}='closeoutPackageFT' ","models":["listOptionAnswer"],"connectors":[{"exitPortType":"NextStep","nodeId":"processDynamicGridData"}],"columns":{"answerOptionText":"listOptionAnswer.answerOptionText","oRank":"listOptionAnswer.rank","id":"listOptionAnswer.id"},"name":"fetchLocalizedKeys","orderBy":"oRank ASC","description":"fetchLocalizedKeys","outputVarMap":{"data":"localizedData"},"nodeType":"QUERY","translate":true},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"queryTasks"}],"name":"start","description":"Start","id":"start","nodeType":"START"},"processDynamicGridData":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"processDynamicGridData","description":"processDynamicGridData","processRule":"if (typeof contextVar.localizedData !== 'undefined' && Array.isArray(contextVar.localizedData)) { contextVar.localizedData.forEach(function (element) { if (contextVar.initialTotalCount > 0 && element.id === 'initialEvidence') { pushDynamicDataGrid(element); } if (contextVar.serviceTotalCount > 0 && element.id === 'servicesDelivered') { pushDynamicDataGrid(element); } if (contextVar.progressTotalCount > 0 && element.id === 'taskProgressReports') { pushDynamicDataGrid(element); } if (contextVar.finalTotalCount > 0 && element.id === 'finalEvidence') { pushDynamicDataGrid(element); } }); } contextVar.count = contextVar.dynamicGridData.length; function pushDynamicDataGrid(element) { var dynamicGridobj = {}; dynamicGridobj['Name'] = element.answerOptionText; dynamicGridobj['id'] = element.id; contextVar.dynamicGridData.push(dynamicGridobj); }","nodeType":"PROCESS","jsEngine":"es6"},"end":{"name":"end","description":"end","inputVarMap":{"count":"count","dynamicGridData":"dynamicGridData"},"outputVarMap":{"count":"count","dynamicGridData":"dynamicGridData"},"id":"end","nodeType":"END"},"workflowNodes":["start","queryTasks","loopThroughTasksList","closeoutPackageProcessCount","fetchLocalizedKeys","processDynamicGridData","end"]}