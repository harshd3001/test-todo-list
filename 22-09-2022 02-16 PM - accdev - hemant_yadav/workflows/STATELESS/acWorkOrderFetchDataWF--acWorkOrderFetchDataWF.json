{"updateacAppraiserSponsorship":{"modelName":"acAppraiserSponsorship","connectors":[{"condition":"","connectorDisplayType":"CurvedLine","connectorLabel":"","exitPortType":"NextStep","nodeId":"decisionApClientApprovedWorkforce"}],"multirecord":true,"name":"updateacAppraiserSponsorship","description":"updateacAppraiserSponsorship","inputVarMap":{"fetchacAppraiserSponsorship":"data"},"nodeType":"MODEL","operation":3},"processFilter":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchacAppraiserSponsorship"}],"contextChangePermitted":true,"name":"processFilter","description":"processFilter","processRule":"if(contextVar.action == 'removeAppraiser'){ contextVar.filter = '{$appraiserId}={@appraiserId}' } else{ contextVar.filter = '{$analystId}={@analystId}' }","nodeType":"PROCESS"},"getContractData":{"filter":"{$contractCustomerId} = {@workOrderCustomerId} AND {$contractStatusId} != 'contractNotStarted' AND {$contractStatusId} != 'contractExpired' AND {$contractStatusId} != 'contractDeactivated'","models":["contract"],"connectors":[{"exitPortType":"NextStep","nodeId":"contractListCheck"}],"columns":{"contractCustomerId":"contract.customerId","contractContractNumber":"contract.contractNumber","contractId":"contract.id","contractStatusId":"contract.statusId","contractSlaId":"contract.slaId","contractCalendarId":"contract.calendarId"},"name":"getContractData","description":"getContractData","inputVarMap":{"workOrderCustomerId":"workOrderCustomerId"},"outputVarMap":{"data":"contractList"},"nodeType":"QUERY","getCount":true},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"multiDecisionNode"}],"name":"start","description":"Start","nodeType":"START"},"getAllCalendarData":{"filter":"{$calendarCalendarType}='serviceWindow'","models":["calendar"],"connectors":[{"exitPortType":"NextStep","nodeId":"getAllPriorityData"}],"columns":{"calendarName":"calendar.name","calendarId":"calendar.id","calendarCalendarType":"calendar.calendarType"},"name":"getAllCalendarData","description":"getAllCalendarData","outputVarMap":{"data":"calendarList"},"nodeType":"QUERY","getCount":true},"processCalendarData":{"connectors":[{"exitPortType":"NextStep","nodeId":"priorityDeadlineWorkflow"}],"contextChangePermitted":true,"name":"processCalendarData","description":"processCalendarData","processRule":"{for(var i=0;i<contextVar.contractList.length;i++){if(contextVar.contractList[i].contractId==contextVar.workOrderContractId){contextVar.workOrderCalendarId=contextVar.contractList[i].contractCalendarId;contextVar.workOrderSlaId=contextVar.contractList[i].contractSlaId;contextVar.editWorkOrder='editWorkOrder'}}}","nodeType":"PROCESS"},"getAllPriorityData":{"filter":"{$ZPriorityTargetModel} = 'workOrder' && {$ZPriorityPriorityId} != 0","models":["ZPriority"],"connectors":[{"exitPortType":"NextStep","nodeId":"getAllWorkOrderTypeData"}],"columns":{"ZPriorityTargetModel":"ZPriority.targetModel","ZPriorityPriorityId":"ZPriority.priority","ZPriorityPriorityName":"ZPriority.name"},"name":"getAllPriorityData","description":"getAllPriorityData","inputVarMap":{},"outputVarMap":{"data":"priorityList"},"nodeType":"QUERY","getCount":true},"decisionApAppraiser":{"connectors":[{"exitPortType":"TrueStep","nodeId":"updateacAppraiserSponsorship"},{"exitPortType":"FalseStep","nodeId":"decisionApClientApprovedWorkforce"}],"name":"decisionApAppraiser","description":"decisionApAppraiser","processRule":"(contextVar.fetchacAppraiserSponsorship.length >0)","nodeType":"DECISION"},"workflowNodes":["start","multiDecisionNode","getWorkOrderData","processWorkOrderData","getSlaTimeFrameData","getContractData","contractListCheck","getAllCalendarData","getCalendarData","processCalendarData","priorityDeadlineWorkflow","getAllPriorityData","getAllWorkOrderTypeData","getWorkOrderTaskData","end"],"getSlaTimeFrameData":{"filter":"{$slaTimeFrameSlaId} = {@workOrderSlaId} AND {$slaTimeFramePriorityPriority} = {@workOrderPriorityPriority}","models":["slaTimeFrame"],"connectors":[{"exitPortType":"NextStep","nodeId":"getContractData"}],"columns":{"slaTimeFramePriorityPriority":"slaTimeFrame.priorityPriority","slaTimeFrameSlaId":"slaTimeFrame.slaId","workOrderSlaResolutionTime":"CONCAT({$slaTimeFrame.resolutionTimeAmount},' ',{$slaTimeFrame.resolutionTimeUnit})"},"name":"getSlaTimeFrameData","description":"getSlaTimeFrameData","inputVarMap":{"workOrderSlaId":"workOrderSlaId","workOrderPriorityPriority":"workOrderPriorityPriority"},"outputVarMap":{"data":"slaTimeFrameList"},"nodeType":"QUERY","getCount":true},"priorityDeadlineWorkflow":{"connectors":[{"exitPortType":"NextStep","nodeId":"getAllPriorityData"}],"contextChangePermitted":true,"processId":"CWFEEU7WFX","name":"priorityDeadlineWorkflow","description":"priorityDeadlineWorkflow","inputVarMap":{"workOrderCalendarId":"workOrderCalendarId","workOrderSlaId":"workOrderSlaId","editWorkOrder":"subAction","workOrderRequestedDate":"workOrderRequestedDate"},"outputVarMap":{"priorityDeadlineData":"priorityDeadlineData"},"nodeType":"WORKFLOW"},"getWorkOrderTaskData":{"models":["ZStatus","workOrderTask","taskType","site"],"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"columns":{"workOrderTaskStatusId":"workOrderTask.statusId","workOrderTaskStatusName":"ZStatus.name","siteName":"site.name","siteAddress":"site.address","taskTypeName":"taskType.name","workOrderTaskRecver":"workOrderTask.recver","siteLatitude":"site.latitude","workOrderTaskSiteId":"workOrderTask.siteId","workOrderTaskStatusNameColor":"ZStatus.colorCode","workOrderTaskNotes":"workOrderTask.notes","workOrderTaskId":"workOrderTask.id","workOrderTaskWorkOrderId":"workOrderTask.workOrderId","workOrderTaskModifiedDate":"workOrderTask.modifiedDate","workOrderTaskEstimatedDuration":"ROUND({$workOrderTask.estimatedDuration}/60,2)","workOrderTaskScheduledDate":"workOrderTask.scheduledDate","workOrderTaskTaskTypeId":"workOrderTask.taskTypeId","siteLongitude":"site.longitude","workOrderTaskStatusTargetModel":"workOrderTask.statusTargetModel"},"orderBy":"workOrderTaskScheduledDate DESC","outerJoinOnModel":"workOrderTask","description":"getWorkOrderTaskData","inputVarMap":{"workOrderId":"workOrderId"},"nodeType":"QUERY","filter":"{$workOrderTaskWorkOrderId} = {@workOrderId}","name":"getWorkOrderTaskData","links":{"taskType":"workOrderTask","site":"workOrderTask","ZStatus":"workOrderTask"},"outputVarMap":{"data":"workOrderTaskData"},"getCount":true},"processWorkOrderData":{"connectors":[{"exitPortType":"NextStep","nodeId":"getSlaTimeFrameData"}],"contextChangePermitted":true,"name":"processWorkOrderData","description":"processWorkOrderData","processRule":"contextVar.workOrderCalendarId = contextVar.workOrderList[0].workOrderCalendarId; contextVar.workOrderPriorityPriority = contextVar.workOrderList[0].workOrderPriorityPriority; contextVar.workOrderSlaId = contextVar.workOrderList[0].workOrderSlaId; contextVar.workOrderRequestedDate = contextVar.workOrderList[0].workOrderRequestedDate; contextVar.workOrderCustomerId = contextVar.workOrderList[0].workOrderCustomerId; contextVar.workOrderContractId = contextVar.workOrderList[0].workOrderContractId;","nodeType":"PROCESS"},"updateApClientApprovedWorkforce":{"modelName":"acClientApprovedWorkforce","connectors":[{"condition":"","connectorDisplayType":"CurvedLine","connectorLabel":"","exitPortType":"NextStep","nodeId":"end"}],"multirecord":true,"name":"updateApClientApprovedWorkforce","description":"updateApClientApprovedWorkforce","inputVarMap":{"fetchacClientApprovedWorkforce":"data"},"nodeType":"MODEL","operation":3},"getAllWorkOrderTypeData":{"filter":"{$workOrderTypeStatusId} = 'workOrderTypeActive'","models":["workOrderType"],"connectors":[{"exitPortType":"NextStep","nodeId":"getWorkOrderTaskData"}],"columns":{"workOrderTypeStatusId":"workOrderType.statusId","workOrderTypeId":"workOrderType.id","workOrderTypeName":"workOrderType.name"},"name":"getAllWorkOrderTypeData","description":"getAllWorkOrderTypeData","inputVarMap":{},"outputVarMap":{"data":"workOrderTypeList"},"nodeType":"QUERY","getCount":true},"multiDecisionNode":{"connectors":[{"condition":"contextVar.subAction === 'editWorkOrder' || contextVar.subAction === 'viewWorkOrder'","exitPortType":"NextStep","nodeId":"getWorkOrderData"},{"condition":"contextVar.subAction === 'addWorkOrder'","exitPortType":"NextStep","nodeId":"getAllCalendarData"},{"DefaultStep":true,"condition":"contextVar.subAction===''","exitPortType":"NextStep","nodeId":"end"}],"name":"multiDecisionNode","description":"multiDecisionNode","nodeType":"MULTIDECISION"},"fetchacClientApprovedWorkforce":{"filter":"filter","models":["acClientApprovedWorkforce"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionApAppraiser"}],"columns":{"clientId":"acClientApprovedWorkforce.clientId","recver":"acClientApprovedWorkforce.recver","analystId":"acClientApprovedWorkforce.analystId","id":"acClientApprovedWorkforce.id","appraiserId":"acClientApprovedWorkforce.appraiserId"},"name":"fetchacClientApprovedWorkforce","description":"fetchacClientApprovedWorkforce","inputVarMap":{"filter":"filter","analystId":"analystId","appraiserId":"appraiserId"},"id":"fetchacClientApprovedWorkforce","outputVarMap":{"data":"fetchacClientApprovedWorkforce"},"nodeType":"QUERY","getCount":true},"getCalendarData":{"filter":"{$contractId} = {@workOrderContractId}","models":["contract","calendar"],"connectors":[{"exitPortType":"NextStep","nodeId":"processCalendarData"}],"columns":{"calendarName":"calendar.name","calendarId":"calendar.id","contractId":"contract.id","contractCalendarId":"contract.calendarId"},"name":"getCalendarData","description":"getCalendarData","inputVarMap":{"workOrderContractId":"workOrderContractId"},"outputVarMap":{"data":"calendarList"},"nodeType":"QUERY","getCount":true},"end":{"name":"end","description":"end","inputVarMap":{"workOrderCalendarId":"workOrderCalendarId","priorityDeadlineData":"priorityDeadlineData","unassignedTask":"data","workOrderSlaId":"workOrderSlaId","slaTimeFrameList":"slaTimeFrameList","contractList":"contractList","workOrderList":"workOrderList","calendarList":"calendarList","priorityList":"priorityList","workOrderTypeList":"workOrderTypeList","workOrderTaskData":"workOrderTaskData"},"outputVarMap":{"workOrderCalendarId":"workOrderCalendarId","priorityDeadlineData":"priorityDeadlineData","unassignedTask":"data","workOrderSlaId":"workOrderSlaId","slaTimeFrameList":"slaTimeFrameList","contractList":"contractList","workOrderList":"workOrderList","calendarList":"calendarList","priorityList":"priorityList","workOrderTypeList":"workOrderTypeList","workOrderTaskData":"workOrderTaskData"},"nodeType":"END"},"contractListCheck":{"connectors":[{"exitPortType":"TrueStep","nodeId":"getAllCalendarData"},{"exitPortType":"FalseStep","nodeId":"getCalendarData"}],"name":"contractListCheck","description":"contractListCheck","processRule":"(typeof contextVar.contractList !== 'undefined' && contextVar.contractList.length === 0)","nodeType":"DECISION"},"decisionApClientApprovedWorkforce":{"connectors":[{"exitPortType":"TrueStep","nodeId":"updateApClientApprovedWorkforce"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"decisionApClientApprovedWorkforce","description":"decisionApClientApprovedWorkforce","processRule":"(contextVar.fetchacClientApprovedWorkforce.length >0)","nodeType":"DECISION"},"getWorkOrderData":{"models":["workOrder","User","ZPriority","contract","customer","ZStatus","workOrderType","sla"],"connectors":[{"exitPortType":"NextStep","nodeId":"processWorkOrderData"}],"columns":{"priorityName":"ZPriority.name","workOrderContractId":"workOrder.contractId","customerCompanyName":"customer.companyName","workOrderIsTemplate":"workOrder.isTemplate","workOrderCancellationNotes":"workOrder.cancellationNotes","workOrderCustomerId":"workOrder.customerId","workOrderCalendarId":"workOrder.calendarId","priorityPriority":"ZPriority.priority","workOrderNotes":"workOrder.notes","statusName":"ZStatus.name","workOrderPriorityTargetModel":"workOrder.priorityTargetModel","workOrderStatusTargetModel":"workOrder.statusTargetModel","workOrderCancelledById":"workOrder.cancelledBy","slaName":"sla.name","slaTime":"CONCAT(TIMESTAMPDIFF(day,now(),{$workOrder.deadline}),'d ',ABS(MOD(TIMESTAMPDIFF(hour,{$workOrder.deadline},now()),24)),'h ',ABS(MOD(TIMESTAMPDIFF(minute,{$workOrder.deadline},now()),60)),'m')","contractContractNumber":"contract.contractNumber","workOrderPriorityPriority":"workOrder.priorityPriority","workOrderDeadline":"workOrder.deadline","workOrderIsImported":"workOrder.acIsImported","primaryAppraiserId":"workOrder.acPrimaryAppraiserId","workOrderCancellationReason":"workOrder.cancellationReason","workOrderCancelledBy":"User.name","lenderId":"workOrder.acLenderId","userId":"User.id","statusNameColor":"ZStatus.colorCode","workOrderStatusId":"workOrder.statusId","workOrderSlaId":"workOrder.slaId","workOrderWorkOrderTypeId":"workOrder.workOrderTypeId","workOrderTypeName":"workOrderType.name","workOrderId":"workOrder.id","workOrderRequestedDate":"workOrder.requestedDate","workOrderCancelledDate":"workOrder.cancellationDate","workOrderRecver":"workOrder.recver","workOrderModifiedDate":"workOrder.modifiedDate"},"outerJoinOnModel":"workOrder","description":"getWorkOrderData","inputVarMap":{"workOrderId":"workOrderId"},"nodeType":"QUERY","translate":true,"filter":"{$workOrderId} = {@workOrderId}","name":"getWorkOrderData","links":{"User":"workOrder","workOrderType":"workOrder","contract":"workOrder","sla":"workOrder","ZPriority":"workOrder","customer":"workOrder","ZStatus":"workOrder"},"outputVarMap":{"data":"workOrderList"},"getCount":true},"fetchacAppraiserSponsorship":{"filter":"filter","models":["acAppraiserSponsorship"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchacClientApprovedWorkforce"}],"columns":{"recver":"acAppraiserSponsorship.recver","analystId":"acAppraiserSponsorship.analystId","id":"acAppraiserSponsorship.id","appraiserId":"acAppraiserSponsorship.appraiserId"},"name":"fetchacAppraiserSponsorship","description":"fetchacAppraiserSponsorship","inputVarMap":{"filter":"filter","analystId":"analystId","appraiserId":"appraiserId"},"id":"fetchacAppraiserSponsorship","outputVarMap":{"data":"fetchacAppraiserSponsorship"},"nodeType":"QUERY","getCount":true}}