{"getContractData":{"filter":"{$contractCustomerId} = {@workOrderCustomerId} AND {$contractStatusId} != 'contractNotStarted' AND {$contractStatusId} != 'contractExpired' AND {$contractStatusId} != 'contractDeactivated'","models":["contract"],"connectors":[{"exitPortType":"NextStep","nodeId":"contractListCheck"}],"columns":{"contractCustomerId":"contract.customerId","contractContractNumber":"contract.contractNumber","contractId":"contract.id","contractStatusId":"contract.statusId","contractSlaId":"contract.slaId","contractCalendarId":"contract.calendarId"},"name":"getContractData","description":"getContractData","inputVarMap":{"workOrderCustomerId":"workOrderCustomerId"},"outputVarMap":{"data":"contractList"},"nodeType":"QUERY","getCount":true},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"multiDecisionNode"}],"name":"start","description":"start","nodeType":"START"},"getAllCalendarData":{"filter":"{$calendarCalendarType}='serviceWindow'","models":["calendar"],"connectors":[{"exitPortType":"NextStep","nodeId":"getAllPriorityData"}],"columns":{"calendarName":"calendar.name","calendarId":"calendar.id","calendarCalendarType":"calendar.calendarType"},"name":"getAllCalendarData","description":"getAllCalendarData","outputVarMap":{"data":"calendarList"},"nodeType":"QUERY","getCount":true},"processCalendarData":{"connectors":[{"exitPortType":"NextStep","nodeId":"priorityDeadlineWorkflow"}],"contextChangePermitted":true,"name":"processCalendarData","description":"processCalendarData","processRule":"{for(var i=0;i<contextVar.contractList.length;i++){if(contextVar.contractList[i].contractId==contextVar.workOrderContractId){contextVar.workOrderCalendarId=contextVar.contractList[i].contractCalendarId;contextVar.workOrderSlaId=contextVar.contractList[i].contractSlaId;contextVar.editWorkOrder='editWorkOrder'}}}","nodeType":"PROCESS"},"getAllPriorityData":{"filter":"{$ZPriorityTargetModel} = 'workOrder'","models":["ZPriority"],"connectors":[{"exitPortType":"NextStep","nodeId":"getAllTemplateData"}],"columns":{"ZPriorityTargetModel":"ZPriority.targetModel","ZPriorityPriorityId":"ZPriority.priority","ZPriorityPriorityName":"ZPriority.name"},"name":"getAllPriorityData","description":"getAllPriorityData","inputVarMap":{},"outputVarMap":{"data":"priorityList"},"nodeType":"QUERY","getCount":true},"workflowNodes":["start","multiDecisionNode","getWorkOrderData","processWorkOrderData","getSlaTimeFrameData","getContractData","contractListCheck","getAllCalendarData","getCalendarData","processCalendarData","priorityDeadlineWorkflow","getAllPriorityData","getAllTemplateData","getAllWorkOrderTypeData","getAllCustomerData","end"],"getSlaTimeFrameData":{"filter":"{$slaTimeFrameSlaId} = {@workOrderSlaId} AND {$slaTimeFramePriorityPriority} = {@workOrderPriorityPriority}","models":["slaTimeFrame"],"connectors":[{"exitPortType":"NextStep","nodeId":"getContractData"}],"columns":{"slaTimeFramePriorityPriority":"slaTimeFrame.priorityPriority","slaTimeFrameSlaId":"slaTimeFrame.slaId","workOrderSlaResolutionTime":"CONCAT({$slaTimeFrame.resolutionTimeAmount},' ',{$slaTimeFrame.resolutionTimeUnit})"},"name":"getSlaTimeFrameData","description":"getSlaTimeFrameData","inputVarMap":{"workOrderSlaId":"workOrderSlaId","workOrderPriorityPriority":"workOrderPriorityPriority"},"outputVarMap":{"data":"slaTimeFrameList"},"nodeType":"QUERY","getCount":true},"priorityDeadlineWorkflow":{"connectors":[{"exitPortType":"NextStep","nodeId":"getAllPriorityData"}],"contextChangePermitted":true,"processId":"CWFEEU7WFX","name":"priorityDeadlineWorkflow","description":"priorityDeadlineWorkflow","inputVarMap":{"workOrderCalendarId":"workOrderCalendarId","workOrderSlaId":"workOrderSlaId","editWorkOrder":"subAction","workOrderRequestedDate":"workOrderRequestedDate"},"outputVarMap":{"priorityDeadlineData":"priorityDeadlineData"},"nodeType":"WORKFLOW"},"processWorkOrderData":{"connectors":[{"exitPortType":"NextStep","nodeId":"getSlaTimeFrameData"}],"contextChangePermitted":true,"name":"processWorkOrderData","description":"processWorkOrderData","processRule":"contextVar.workOrderCalendarId = contextVar.workOrderList[0].workOrderCalendarId;contextVar.workOrderPriorityPriority = contextVar.workOrderList[0].workOrderPriorityPriority;contextVar.workOrderSlaId = contextVar.workOrderList[0].workOrderSlaId;contextVar.workOrderRequestedDate = contextVar.workOrderList[0].workOrderRequestedDate;contextVar.workOrderCustomerId = contextVar.workOrderList[0].workOrderCustomerId;contextVar.workOrderContractId = contextVar.workOrderList[0].workOrderContractId;","nodeType":"PROCESS"},"getAllWorkOrderTypeData":{"filter":"{$workOrderTypeStatusId} = 'workOrderTypeActive'","models":["workOrderType"],"connectors":[{"exitPortType":"NextStep","nodeId":"getAllCustomerData"}],"columns":{"workOrderTypeStatusId":"workOrderType.statusId","workOrderTypeId":"workOrderType.id","workOrderTypeName":"workOrderType.name"},"name":"getAllWorkOrderTypeData","description":"getAllWorkOrderTypeData","inputVarMap":{},"outputVarMap":{"data":"workOrderTypeList"},"nodeType":"QUERY","getCount":true},"multiDecisionNode":{"connectors":[{"condition":"contextVar.subAction === 'editWorkOrder' || contextVar.subAction === 'viewWorkOrder'","exitPortType":"NextStep","nodeId":"getWorkOrderData"},{"condition":"contextVar.subAction === 'addWorkOrder'","exitPortType":"NextStep","nodeId":"getAllCalendarData"},{"DefaultStep":true,"condition":"contextVar.subAction===''","exitPortType":"NextStep","nodeId":"end"}],"name":"multiDecisionNode","description":"multiDecisionNode","nodeType":"MULTIDECISION"},"getCalendarData":{"filter":"{$contractId} = {@workOrderContractId}","models":["contract","calendar"],"connectors":[{"exitPortType":"NextStep","nodeId":"processCalendarData"}],"columns":{"calendarName":"calendar.name","calendarId":"calendar.id","contractId":"contract.id","contractCalendarId":"contract.calendarId"},"name":"getCalendarData","description":"getCalendarData","inputVarMap":{"workOrderContractId":"workOrderContractId"},"outputVarMap":{"data":"calendarList"},"nodeType":"QUERY","getCount":true},"getAllCustomerData":{"filter":"{$customerStatusId}!='customerDeactivated'","models":["customer"],"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"columns":{"customerCompanyName":"customer.companyName","customerStatusId":"customer.statusId","customerId":"customer.id"},"name":"getAllCustomerData","description":"getAllCustomerData","inputVarMap":{},"outputVarMap":{"data":"customerList"},"type":"query","nodeType":"QUERY","getCount":true},"end":{"name":"End","description":"end","inputVarMap":{"workOrderCalendarId":"workOrderCalendarId","priorityDeadlineData":"priorityDeadlineData","workOrderSlaId":"workOrderSlaId","slaTimeFrameList":"slaTimeFrameList","contractList":"contractList","templateList":"templateList","customerList":"customerList","workOrderList":"workOrderList","calendarList":"calendarList","priorityList":"priorityList","workOrderTypeList":"workOrderTypeList"},"outputVarMap":{"workOrderCalendarId":"workOrderCalendarId","priorityDeadlineData":"priorityDeadlineData","workOrderSlaId":"workOrderSlaId","slaTimeFrameList":"slaTimeFrameList","contractList":"contractList","templateList":"templateList","customerList":"customerList","workOrderList":"workOrderList","calendarList":"calendarList","priorityList":"priorityList","workOrderTypeList":"workOrderTypeList"},"nodeType":"END"},"getAllTemplateData":{"models":["workOrderTemplate"],"connectors":[{"exitPortType":"NextStep","nodeId":"getAllWorkOrderTypeData"}],"columns":{"workOrderTemplateId":"workOrderTemplate.zid","workOrderTemplateName":"workOrderTemplate.name","workOrderTemplateWorkOrderId":"workOrderTemplate.workOrderId"},"name":"getAllTemplateData","description":"getAllTemplateData","inputVarMap":{},"outputVarMap":{"data":"templateList"},"nodeType":"QUERY","getCount":true},"contractListCheck":{"connectors":[{"exitPortType":"TrueStep","nodeId":"getAllCalendarData"},{"exitPortType":"FalseStep","nodeId":"getCalendarData"}],"name":"contractListCheck","description":"contractListCheck","processRule":"(typeof contextVar.contractList != 'undefined' && contextVar.contractList.length === 0)","nodeType":"DECISION"},"getWorkOrderData":{"filter":"{$workOrderId} = {@workOrderId}","models":["workOrder","User","ZPriority","contract","customer","ZStatus","workOrderType","sla"],"connectors":[{"exitPortType":"NextStep","nodeId":"processWorkOrderData"}],"columns":{"priorityName":"ZPriority.name","workOrderContractId":"workOrder.contractId","customerCompanyName":"customer.companyName","workOrderIsTemplate":"workOrder.isTemplate","workOrderCancellationNotes":"workOrder.cancellationNotes","workOrderCustomerId":"workOrder.customerId","workOrderCalendarId":"workOrder.calendarId","priorityPriority":"ZPriority.priority","workOrderNotes":"workOrder.notes","statusName":"ZStatus.name","workOrderPriorityTargetModel":"workOrder.priorityTargetModel","workOrderStatusTargetModel":"workOrder.statusTargetModel","workOrderCancelledById":"workOrder.cancelledBy","slaName":"sla.name","slaTime":"CONCAT(TIMESTAMPDIFF(day,now(),{$workOrder.deadline}),'d ',ABS(MOD(TIMESTAMPDIFF(hour,{$workOrder.deadline},now()),24)),'h ',ABS(MOD(TIMESTAMPDIFF(minute,{$workOrder.deadline},now()),60)),'m')","contractContractNumber":"contract.contractNumber","workOrderPriorityPriority":"workOrder.priorityPriority","workOrderDeadline":"workOrder.deadline","workOrderCancellationReason":"workOrder.cancellationReason","workOrderCancelledBy":"User.name","userId":"User.id","statusNameColor":"ZStatus.colorCode","workOrderStatusId":"workOrder.statusId","workOrderSlaId":"workOrder.slaId","workOrderWorkOrderTypeId":"workOrder.workOrderTypeId","workOrderTypeName":"workOrderType.name","workOrderId":"workOrder.id","workOrderRequestedDate":"workOrder.requestedDate","workOrderCancelledDate":"workOrder.cancellationDate","workOrderRecver":"workOrder.recver","workOrderModifiedDate":"workOrder.modifiedDate"},"name":"getWorkOrderData","outerJoinOnModel":"workOrder","description":"getWorkOrderData","inputVarMap":{"workOrderId":"workOrderId"},"links":{"User":"workOrder","workOrderType":"workOrder","contract":"workOrder","sla":"workOrder","ZPriority":"workOrder","customer":"workOrder","ZStatus":"workOrder"},"outputVarMap":{"data":"workOrderList"},"nodeType":"QUERY","getCount":true}}