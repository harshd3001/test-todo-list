{"fetchCrewAttendanceDetails":{"filter":"{$crewId} = {$assignedToCrewId} AND {$workOrderTaskId} ={@workOrderTaskId} AND {$workforceCrewWorkforceUserId}!={$crewLeadUserId} AND {$crewMemberStatus} = 'workforceCrewOnCrew'","models":["workforceCrew","crew","workOrderTask","workforce","User"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchPreviousCrewAttendanceDetails"}],"columns":{"workforceCrewCrewId":"workforceCrew.crewId","workforceCrewWorkforceUserId":"workforceCrew.workforceUserId","crewLeadUserId":"crew.leadUserId","crewMemberEmailId":"User.emailId","crewMemberName":"User.name","workOrderTaskId":"workOrderTask.id","crewMemberPhoneNumber":"User.phoneNumber","crewId":"crew.id","crewStatusId":"crew.statusId","crewMemberStatus":"workforceCrew.statusId","crewName":"crew.name","assignedToCrewId":"workOrderTask.assignedToCrewId"},"name":"fetchCrewAttendanceDetails","description":"To get the crew attendance details","distinct":true,"inputVarMap":{"workOrderTaskId":"workOrderTaskId"},"links":{"User":"workforce","workforce":"workforceCrew","workforceCrew":"crew","crew":"workOrderTask"},"id":"fetchCrewAttendanceDetails","outputVarMap":{"data":"crewAttendanceDetailsDataGrid"},"nodeType":"QUERY"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchCrewAttendanceDetails"}],"name":"start","description":" Start","id":"start","nodeType":"START"},"processcrewAttendanceDetailsDataGrid":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"processcrewAttendanceDetailsDataGrid","description":"processcrewAttendanceDetailsDataGrid","processRule":"var prevRec = contextVar.fetchPreviousCrewAttendanceDetails ? contextVar.fetchPreviousCrewAttendanceDetails : ''; var currRec = contextVar.crewAttendanceDetailsDataGrid ? contextVar.crewAttendanceDetailsDataGrid : ''; if (typeof contextVar.crewAttendanceDetailsDataGrid !== 'undefined' && Array.isArray(contextVar .crewAttendanceDetailsDataGrid)) { for (var i = 0; i < contextVar.crewAttendanceDetailsDataGrid.length; i++) { contextVar.crewAttendanceDetailsDataGrid[i]['attendanceCheckIn'] = ''; contextVar.crewAttendanceDetailsDataGrid[i]['attendanceCheckOut'] = ''; if (Array.isArray(contextVar.fetchPreviousCrewAttendanceDetails)) { for (var j = 0; j < contextVar.fetchPreviousCrewAttendanceDetails.length; j++) { if (currRec[i].workforceCrewWorkforceUserId === prevRec[j].workforceCrewWorkforceUserId) { if (typeof prevRec[j].crewAttendance !== 'undefined' && Array.isArray(prevRec[j].crewAttendance) && prevRec[j].crewAttendance.length > 0) { var lastRec = prevRec[j].crewAttendance; var lastObj = lastRec[lastRec.length - 1]; contextVar.crewAttendanceDetailsDataGrid[i].attendanceCheckIn = lastObj.checkInTime; contextVar.crewAttendanceDetailsDataGrid[i].attendanceCheckOut = lastObj.checkOutTime; } } } } } }","id":"processcrewAttendanceDetailsDataGrid","nodeType":"PROCESS"},"end":{"name":"end","description":"end","inputVarMap":{},"outputVarMap":{},"nodeType":"END"},"fetchPreviousCrewAttendanceDetails":{"filter":"{$workOrderTaskId}={@workOrderTaskId} && {$userId}!={$crewLeadUserId}","models":["workOrderTask","crewAttendance","User","workforce","crew"],"connectors":[{"exitPortType":"NextStep","nodeId":"processcrewAttendanceDetailsDataGrid"}],"columns":{"crewLeadUserId":"crew.leadUserId","crewAttendance":"crewAttendance.attendance","latitude":"User.latitude","crewMemberName":"User.name","crewMemberPhoneNumber":"User.phoneNumber","crewName":"crew.name","assignedToCrewId":"workOrderTask.assignedToCrewId","userId":"User.id","workforceCrewWorkforceUserId":"crewAttendance.workforceUserId","crewMemberEmailId":"User.emailId","workOrderTaskId":"workOrderTask.id","crewId":"crew.id","longitude":"User.longitude"},"name":"fetchPreviousCrewAttendanceDetails","description":"fetchPreviousCrewAttendanceDetails","distinct":true,"links":{"User":"workforce","crewAttendance":"workOrderTask","workforce":"crewAttendance","crew":"workOrderTask"},"inputVarMap":{"workOrderTaskId":"workOrderTaskId"},"outputVarMap":{"data":"fetchPreviousCrewAttendanceDetails"},"nodeType":"QUERY"},"workflowNodes":["start","fetchCrewAttendanceDetails","fetchPreviousCrewAttendanceDetails","processcrewAttendanceDetailsDataGrid","end"]}