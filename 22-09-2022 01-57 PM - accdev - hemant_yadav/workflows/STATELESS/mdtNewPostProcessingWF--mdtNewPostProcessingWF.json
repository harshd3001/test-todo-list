{"upsertTask":{"modelName":"workOrderTask","connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"multirecord":true,"name":"upsertTask","description":"Update Task","inputVarMap":{"workOrderTask":"data"},"id":"upsertTask","outputVarMap":{"data":"taskUpdated"},"nodeType":"MODEL","operation":2},"afterContextVar":{"connectors":[{"exitPortType":"NextStep","nodeId":"recreateInstances"}],"processId":"featureLoggerWF","name":"afterContextVar","description":"afterContextVar","inputVarMap":{"afterContextVar":"featureName","afterContextVarExtraMsg":"extraMsg"},"id":"afterContextVar","outputVarMap":{},"nodeType":"WORKFLOW"},"updateData":{"connectors":[{"exitPortType":"TrueStep","nodeId":"fetchCrewAttendance"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"updateData","description":"updateData","processRule":"(contextVar.updateData == true)","nodeType":"DECISION"},"updateAttendance":{"modelName":"crewAttendance","connectors":[{"exitPortType":"NextStep","nodeId":"upsertTask"}],"multirecord":true,"name":"updateAttendance","description":"updateAttendance","inputVarMap":{"attendanceInfo":"data"},"id":"updateAttendance","outputVarMap":{"data":"crewAttendanceDataObj"},"nodeType":"MODEL","operation":4},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"isSimulateModeCheck"}],"name":"start","description":" Start","id":"start","nodeType":"START"},"fetchCrewAttendance":{"filter":"{$workforceUserId} in {@userList} AND {$workOrderTaskId} = {@workOrderTaskId}","models":["crewAttendance"],"connectors":[{"exitPortType":"NextStep","nodeId":"beforeContextVar"}],"columns":{"workOrderTaskId":"crewAttendance.workOrderTaskId","workforceUserId":"crewAttendance.workforceUserId","attendance":"crewAttendance.attendance"},"name":"fetchCrewAttendance","description":"fetchCrewAttendance","links":{},"inputVarMap":{"userList":"userList","workOrderTaskId":"workOrderTaskId"},"id":"fetchCrewAttendance","outputVarMap":{"data":"exisitingAttendanceData"},"nodeType":"QUERY"},"workflowNodes":["start","isSimulateModeCheck","fetchTaskDetails","processUserDetails","updateData","fetchCrewAttendance","beforeContextVar","processData","afterContextVar","recreateInstances","neeedUpdateAttendance","updateAttendance","upsertTask","end"],"fetchTaskDetails":{"filter":"{$workOrderTaskId}={@workOrderTaskId}","models":["workOrderTask","User"],"connectors":[{"exitPortType":"NextStep","nodeId":"processUserDetails"}],"columns":{"result":"workOrderTask.result","actualStartTime":"workOrderTask.actualStartTime","recver":"workOrderTask.recver","workOrderTaskId":"workOrderTask.id","currStatus":"workOrderTask.statusId","userPhoneNumber":"User.phoneNumber","userEmail":"User.emailId","taskUserId":"workOrderTask.assignedToUserId","userName":"User.name"},"name":"fetchTaskDetails","description":"fetch task details","inputVarMap":{"workOrderTaskId":"workOrderTaskId"},"id":"fetchTaskDetails","outputVarMap":{"data":"existingTaskDetails"},"nodeType":"QUERY"},"neeedUpdateAttendance":{"connectors":[{"exitPortType":"TrueStep","nodeId":"updateAttendance"},{"exitPortType":"FalseStep","nodeId":"upsertTask"}],"name":"neeedUpdateAttendance","description":"neeedUpdateAttendance","processRule":"(typeof contextVar.attendanceInfo !== 'undefined' && Array.isArray(contextVar.attendanceInfo) && contextVar.attendanceInfo.length > 0)","id":"neeedUpdateAttendance","nodeType":"DECISION"},"processData":{"connectors":[{"exitPortType":"NextStep","nodeId":"afterContextVar"}],"contextChangePermitted":true,"name":"processData","description":"Processing task details","processRule":"@7OQ1UMODVX","id":"processData","nodeType":"PROCESS","jsEngine":"es6"},"workflowContext":{"userList":[],"beforeContextVarExtraMsg":"Start saving task details","afterContextVar":"processedDetails","updateData":true,"beforeContextVar":"saveTaskDetailsFeature","afterContextVarExtraMsg":"Processed result, attendance details"},"recreateInstances":{"connectors":[{"exitPortType":"NextStep","nodeId":"neeedUpdateAttendance"}],"contextChangePermitted":true,"processId":"recreateInstancesWF","name":"recreateInstances","description":"recreateInstances","inputVarMap":{"submitProgressComments":"submitProgressComments","userData":"userData","workforceCrewStatusId":"workforceCrewStatusId","crewAttendanceDetailsList":"crewAttendanceDetailsList","endDate":"endDate","taskDescription":"taskDescription","crewMobileAccess":"crewMobileAccess","workOrderTaskAssignedToCrewId":"workOrderTaskAssignedToCrewId","partsForRemoval":"partsForRemoval","leadUserId":"leadUserId","webTask":"webTask","correctiveTaskRequestReasons":"correctiveTaskRequestReasons","scheduleBreakDown":"scheduleBreakDown","taskLogData":"taskLogData","workOrderTaskOpen":"workOrderTaskOpen","workOrderCompleted":"workOrderCompleted","workOrderInProgress":"workOrderInProgress","workOrderTaskDraft":"workOrderTaskDraft","recordInitialEvidenceLocationCoordinates":"recordInitialEvidenceLocationCoordinates","cancellationNotes":"cancellationNotes","assignUserId":"assignUserId","partsForOthers":"partsForOthers","siteAddress":"siteAddress","mobileProcessId":"mobileProcessId","leadDetails":"leadDetails","customerName":"customerName","crewTask":"crewTask","partsForInstallation":"partsForInstallation","servicesDataGrid":"servicesDataGrid","statusId":"statusId","siteLatitude":"siteLatitude","workOrderOpen":"workOrderOpen","fetchNotSuggestedParts":"fetchNotSuggestedParts","assetsList":"assetsList","assignee":"assignee","taskProgress":"taskProgress","workOrderTaskTaskTypeId":"workOrderTaskTaskTypeId","submitType":"submitType","breakDownData":"breakDownData","latitude":"latitude","taskData":"taskData","siteName":"siteName","additionalMaterialsDataGrid":"additionalMaterialsDataGrid","checkInIncidentReasonsListOptions":"checkInIncidentReasonsListOptions","notCheckedInTravelStatus":"notCheckedInTravelStatus","taskDetail":"taskDetail","submitServicesLocationCoordinates":"submitServicesLocationCoordinates","workOrderTaskDispatched":"workOrderTaskDispatched","workOrderTaskEstimatedDuration":"workOrderTaskEstimatedDuration","userEmail":"userEmail","fetchActivityIncidentListOptions":"fetchActivityIncidentListOptions","workOrderTaskReOpenCount":"workOrderTaskReOpenCount","assetRemovalListOptions":"assetRemovalListOptions","assignedToUserId":"assignedToUserId","address":"address","incorrectAddress":"incorrectAddress","cancellationReason":"cancellationReason","taskPriority":"taskPriority","services":"services","userId":"userId","fetchReportIssue":"fetchReportIssue","workOrderScheduled":"workOrderScheduled","initialEvidenceDataGrid":"initialEvidenceDataGrid","workOrderTaskSiteChangeRequest":"workOrderTaskSiteChangeRequest","assetMaintenanceListOptions":"assetMaintenanceListOptions","workOrderTaskInTransit":"workOrderTaskInTransit","travelStatus":"travelStatus","recordSubmitServicesTime":"recordSubmitServicesTime","workOrderTaskIncident":"workOrderTaskIncident","workOrderTaskScheduledDate":"workOrderTaskScheduledDate","contactPhone":"contactPhone","taskBuilderMap":"taskBuilderMap","recreateUserList":"recreateUserList","dueDate":"dueDate","incidentType":"incidentType","userPhoneNumber":"userPhoneNumber","workOrderData":"workOrderData","custData":"custData","pendingReviewStatus":"workOrderTaskPendingReview","workOrderTaskPendingReview":"workOrderTaskPendingReview","fullTaskScheduleGridData":"fullTaskScheduleGridData","partialAccess":"partialAccess","workOrderTaskId":"workOrderTaskId","checkOutCheckBoxForSubmitCapturedTime":"checkOutCheckBoxForSubmitCapturedTime","fetchMaterialsInCatalogNS":"fetchMaterialsInCatalogNS","checkOutCheckBoxForSubmit":"checkOutCheckBoxForSubmit","currentUserDetail":"currentUserDetail","userStatusFilter":"userStatusFilter","longitude":"longitude","recordInitialEvidenceTime":"recordInitialEvidenceTime","workOrder":"workOrder","workOrderTaskApproved":"workOrderTaskApproved","initialComments":"initialComments","catalogList":"catalogList","workOrderTaskPendingApproval":"workOrderTaskPendingApproval","workOrderTaskDiscontinued":"workOrderTaskDiscontinued","modesOfTransport":"modesOfTransport","workOrderTaskRejected":"workOrderTaskRejected","isCrewTask":"isCrewTask","partsForService":"partsForService","enableServices":"enableServices","workOrderTaskDelayed":"workOrderTaskDelayed","name":"name","newLocationPhoto":"newLocationPhoto","workOrderId":"workOrderId","workOrderTaskScheduled":"workOrderTaskScheduled","submitProgressEvidenceDataGrid":"submitProgressEvidenceDataGrid","viewTravelStatus":"viewTravelStatus","workOrderTaskInProgress":"workOrderTaskInProgress","submitTypeListOptions":"submitTypeListOptions","fetchTransportModes":"fetchTransportModes","crewMemberSubmitTypeListOptions":"crewMemberSubmitTypeListOptions","siteChangeReq":"siteChangeReq","workOrderTaskCompleted":"workOrderTaskCompleted","timezone":"timezone","dateArray":"dateArray","travelIncidentReasonsListOptions":"travelIncidentReasonsListOptions","scheduledDate":"scheduledDate","taskTypeName":"taskTypeName","fetchSuggestedPartsData":"fetchSuggestedPartsData","taskType":"taskType","recreateInstances":"recreateInstances","reasonOfwrongSite":"reasonOfwrongSite","workOrderTaskCancelled":"workOrderTaskCancelled","checkOutCheckBoxForSubmitLocationCoordinates":"checkOutCheckBoxForSubmitLocationCoordinates","siteLongitude":"siteLongitude","workOrderDraft":"workOrderDraft","workOrderTaskAssignedToUserId":"workOrderTaskAssignedToUserId","estimatedTaskDuration":"estimatedTaskDuration","taskTypeData":"taskTypeData","userName":"userName","autoCheckoutReqd":"autoCheckoutReqd","workOrderPendingReview":"workOrderPendingReview","serviceList":"serviceList","siteId":"siteId","incorrectSiteComments":"incorrectSiteComments","fetchSuggestedMaterials":"fetchSuggestedMaterials","crewAttendanceDetailsDataGrid":"crewAttendanceDetailsDataGrid","taskDetailBackwardCompatibility":"taskDetailBackwardCompatibility","timeTakenForTask":"timeTakenForTask","taskId":"taskId","workOrderTaskData":"workOrderTaskData"},"id":"recreateInstances","outputVarMap":{},"nodeType":"WORKFLOW","execType":"fork","captureOutput":true},"processUserDetails":{"connectors":[{"exitPortType":"NextStep","nodeId":"updateData"}],"contextChangePermitted":true,"name":"processUserDetails","description":"Processing filter","processRule":"function checkIfArray(a) { return (typeof a !== 'undefined' && Array.isArray(a) && a.length > 0) } function checkForData(a) { return (typeof a !== 'undefined' && a !== ''); } let crewAttendanceDetailsList = contextVar.crewAttendanceDetailsList; let crewMobileAccess = contextVar.crewMobileAccess; let assignedToUserId = contextVar.assignedToUserId || contextVar['__sys__loggedIn_UserId']; let isCrewTask = contextVar.isCrewTask; let taskDetails = contextVar.existingTaskDetails; let leaduserId = checkIfArray(taskDetails) && checkForData(taskDetails[0].taskUserId) ? taskDetails[0].taskUserId : ''; if (isCrewTask) { if (checkIfArray(crewAttendanceDetailsList)) { crewAttendanceDetailsList.forEach((obj) => { contextVar.userList.push(obj.workforceCrewWorkforceUserId); }); } } contextVar.userList.push(leaduserId); contextVar.userList.some((obj) => { if (obj == '') { contextVar.updateData = false; return true; } }); contextVar.backckUp = { 'submitType': contextVar.submitType }; contextVar.userEmail = checkIfArray(taskDetails) && checkForData(taskDetails[0].userEmail) ? taskDetails[0].userEmail : ''; contextVar.userPhoneNumber = checkIfArray(taskDetails) && checkForData(taskDetails[0].userPhoneNumber) ? taskDetails[0].userPhoneNumber : '';","id":"processUserDetails","nodeType":"PROCESS","jsEngine":"es6"},"beforeContextVar":{"connectors":[{"exitPortType":"NextStep","nodeId":"processData"}],"processId":"featureLoggerWF","name":"beforeContextVar","description":"beforeContextVar","inputVarMap":{"beforeContextVarExtraMsg":"extraMsg","beforeContextVar":"featureName"},"id":"beforeContextVar","outputVarMap":{},"nodeType":"WORKFLOW"},"isSimulateModeCheck":{"connectors":[{"exitPortType":"TrueStep","nodeId":"end"},{"exitPortType":"FalseStep","nodeId":"fetchTaskDetails"}],"name":"isSimulateModeCheck","description":"isSimulateModeCheck","processRule":"(typeof contextVar.__simulateMode !=='undefined' && contextVar.__simulateMode !== '' && contextVar.__simulateMode)","nodeType":"DECISION"},"end":{"name":"end","description":"end","inputVarMap":{},"outputVarMap":{},"id":"end","nodeType":"END"}}