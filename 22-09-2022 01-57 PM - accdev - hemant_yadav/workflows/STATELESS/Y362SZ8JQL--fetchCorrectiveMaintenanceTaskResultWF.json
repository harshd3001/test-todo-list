{"queryCustomerDetails":{"filter":"{$taskId}={@tId}","models":["site","workOrderTask","customer"],"connectors":[{"exitPortType":"NextStep","nodeId":"processRejectionReason"}],"columns":{"contactPhone":"customer.contactPhone","taskId":"workOrderTask.id","customerName":"customer.companyName"},"name":"queryCustomerDetails","description":"Provide some description for your query","links":{"workOrderTask":"site","customer":"site"},"inputVarMap":{"workOrderTaskId":"tId"},"id":"queryCustomerDetails","outputVarMap":{"data":"custData"},"nodeType":"QUERY"},"fetchTransportModesListOptions":{"filter":"{$listOptionId} = 'travelModeConstants'","models":["category","listOption","listOptionAnswer"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchIncidentType"}],"columns":{"listOptionAnswer":"listOptionAnswer.answerOptionText","listOptionAnswerId":"listOptionAnswer.id","listOption":"listOption.name","listOptionId":"listOption.id","categoryName":"category.name"},"name":"fetchTransportModesListOptions","description":"List options for mode of transport","inputVarMap":{},"id":"fetchTransportModesListOptions","outputVarMap":{"data":"fetchTransportModes"},"nodeType":"QUERY"},"processTaskData":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchAssets"}],"contextChangePermitted":true,"name":"processTaskData","description":"Process task data to contextVar","processRule":"{contextVar.enableServices = contextVar.taskDetail[0].enableServices;contextVar.viewTravelStatus = contextVar.taskDetail[0].viewTravelStatus;contextVar.travelStatus = '{%notStarted}';contextVar.modesOfTransport = contextVar.fetchTransportModes[1].listOptionAnswerId;contextVar.dueDate = contextVar.taskDetail[0].dueDate;contextVar.userName = contextVar.taskDetail[0].userName;contextVar.siteId = contextVar.taskDetail[0].siteId;contextVar.address = contextVar.taskDetail[0].address; contextVar.estimatedTaskDuration = contextVar.taskDetail[0].estimatedTaskDuration; contextVar.latitude = contextVar.taskDetail[0].latitude; contextVar.taskDescription = contextVar.taskDetail[0].taskDescription ? contextVar.taskDetail[0].taskDescription : ''; contextVar.taskPriority = contextVar.taskDetail[0].taskPriority; contextVar.scheduledDate = contextVar.taskDetail[0].scheduledDate; contextVar.workOrderId = contextVar.taskDetail[0].workOrderId; contextVar.taskTypeName = contextVar.taskDetail[0].taskTypeName; contextVar.taskId = contextVar.taskDetail[0].taskId; contextVar.longitude = contextVar.taskDetail[0].longitude; contextVar.endDate = contextVar.taskDetail[0].endDate;contextVar.checkInTime =  contextVar.taskDetail[0].checkInTime || ''; contextVar.contactPhone = contextVar.custData[0].contactPhone; contextVar.customerName = contextVar.custData[0].customerName;contextVar.cancellationNotes = contextVar.taskDetail[0].cancellationNotes;contextVar.taskLogEventType = contextVar.taskDetail[0].taskLogEventType;if(typeof contextVar.taskDetail[0].result!='undefined' && contextVar.taskDetail[0].result!=''){contextVar.beforeCaptureEvidence = contextVar.taskDetail[0].result[0].beforeCaptureEvidence;contextVar.beforeCaptureEvidenceOptionalFirst = contextVar.taskDetail[0].result[0].beforeCaptureEvidenceOptionalFirst;contextVar.beforeCaptureEvidenceOptionalSecond = contextVar.taskDetail[0].result[0].beforeCaptureEvidenceOptionalSecond;contextVar.beforeComments = contextVar.taskDetail[0].result[0].beforeComments;contextVar.afterCaptureEvidence = contextVar.taskDetail[0].result[0].afterCaptureEvidence;contextVar.afterCaptureEvidenceOptionalFirst = contextVar.taskDetail[0].result[0].afterCaptureEvidenceOptionalFirst;contextVar.afterCaptureEvidenceOptionalSecond = contextVar.taskDetail[0].result[0].afterCaptureEvidenceOptionalSecond;contextVar.afterComments = contextVar.taskDetail[0].result[0].afterComments;contextVar.activityDataGrid = contextVar.taskDetail[0].result[0].activityDataGrid;}}","id":"processTaskData","nodeType":"PROCESS"},"processRejectionReasonValue":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchListOptionRejectionReason"}],"contextChangePermitted":true,"name":"processRejectionReasonValue","description":"processRejectionReasonValue","processRule":"if(contextVar.taskDetail != '' && contextVar.taskDetail.length > 0 && typeof contextVar.taskDetail[0].cancellationReason != 'undefined' && contextVar.taskDetail[0].cancellationReason != ''){contextVar.cancellationReason=contextVar.taskDetail[0].cancellationReason;}else {contextVar.cancellationReason=''}","id":"processRejectionReasonValue","nodeType":"PROCESS"},"processServices":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchServices"}],"contextChangePermitted":true,"name":"processServices","description":"Process services","processRule":"if(typeof contextVar.taskDetail[0].services !== 'undefined' && contextVar.taskDetail[0].services != '' && Array.isArray(contextVar.taskDetail[0].services)){contextVar.taskDetail[0].services.forEach(function(obj){ contextVar.catalogList.push(obj.catalogId); });}","id":"processServices","nodeType":"PROCESS"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchListOptions"}],"name":"Start","description":"Start","nodeType":"START"},"processRejectionReason":{"connectors":[{"exitPortType":"NextStep","nodeId":"processTaskData"}],"contextChangePermitted":true,"name":"processRejectionReason","description":"processRejectionReason","processRule":"if(contextVar.taskDetail != '' && contextVar.taskDetail.length > 0 && typeof contextVar.taskDetail[0].cancellationReason != 'undefined' && contextVar.taskDetail[0].cancellationReason != ''){contextVar.cancellationReason=contextVar.cancellationReason[0].cancellationReason;}else {contextVar.cancellationReason=''}","id":"processRejectionReason","nodeType":"PROCESS"},"fetchListOptions":{"filter":"{$listOptionId} = 'mobileSiteChangeRequest'","models":["category","listOption","listOptionAnswer"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchCorrectiveTaskRequestListOptions"}],"columns":{"listOptionAnswer":"listOptionAnswer.answerOptionText","listOption":"listOption.name","listOptionId":"listOption.id","categoryName":"category.name"},"name":"fetchListOptions","description":"List options for wrong site","inputVarMap":{},"links":{"listOptionAnswer":"listOption","category":"listOption"},"id":"fetchListOptions","outputVarMap":{"data":"siteChangeReq"},"nodeType":"QUERY"},"fetchListOptionRejectionReason":{"filter":"{$listOptionAnswerId} = {@cancellationReason}","models":["category","listOption","listOptionAnswer"],"connectors":[{"exitPortType":"NextStep","nodeId":"processServices"}],"columns":{"listOptionAnswerId":"listOptionAnswer.id","cancellationReason":"listOptionAnswer.answerOptionText","listOption":"listOption.name","listOptionId":"listOption.id","categoryName":"category.name"},"name":"fetchListOptionRejectionReason","description":"List options for rejection reason","inputVarMap":{"cancellationReason":"cancellationReason"},"links":{"listOptionAnswer":"listOption","category":"listOption"},"id":"fetchListOptionRejectionReason","outputVarMap":{"data":"cancellationReason"},"nodeType":"QUERY","translate":true},"fetchTravelIncidentReasons":{"filter":" {$listOptionId}='travelIncident' ","models":["category","listOption","listOptionAnswer"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchCheckInIncidentReasons"}],"columns":{"listOptionAnswer":"listOptionAnswer.answerOptionText","listOptionAnswerId":"listOptionAnswer.id","listOption":"listOption.name","displayOrder":"listOptionAnswer.rank","listOptionId":"listOption.id","categoryName":"category.name"},"name":"fetchTravelIncidentReasons","description":"List options for Incident Reasons","orderBy":"displayOrder ASC","id":"fetchTravelIncidentReasons","outputVarMap":{"data":"travelIncidentReasonsListOptions"},"nodeType":"QUERY"},"checkRejectionReason":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processRejectionReasonValue"},{"exitPortType":"FalseStep","nodeId":"processServices"}],"name":"checkRejectionReason","description":"checkRejectionReason","processRule":"(contextVar.taskDetail != '' && contextVar.taskDetail.length > 0 && typeof contextVar.taskDetail[0].cancellationReason != 'undefined' && contextVar.taskDetail[0].cancellationReason != '')","nodeType":"DECISION"},"workflowNodes":["start","fetchListOptions","fetchCorrectiveTaskRequestListOptions","fetchTransportModesListOptions","fetchIncidentType","fetchTravelIncidentReasons","fetchCheckInIncidentReasons","fetchActivityIncidentReasons","fetchReportIssueListOptions","fetchTaskDetails","fetchtaskReviewLog","processReviewLogAndTaskData","checkRejectionReason","processRejectionReasonValue","fetchListOptionRejectionReason","processServices","fetchServices","queryCustomerDetails","processRejectionReason","processTaskData","fetchAssets","end"],"fetchtaskReviewLog":{"models":["workOrderTask","taskReviewLog","taskLog"],"connectors":[{"exitPortType":"NextStep","nodeId":"processReviewLogAndTaskData"}],"columns":{"taskLogEventType":"taskLog.eventType","cancellationNotes":"taskReviewLog.reviewNotes","cancellationReason":"taskReviewLog.listOptionAnswerId","modifiedDate":"taskReviewLog.modifiedDate","modifiedDate1TaskLog":"taskLog.modifiedDate","action":"taskReviewLog.action"},"description":"fetch task details","distinct":true,"orderBy":"modifiedDate DESC","inputVarMap":{"workOrderTaskId":"tId"},"nodeType":"QUERY","filter":"{$workOrderTask.id}={@tId}","name":"fetchtaskReviewLog","id":"fetchtaskReviewLog","outputVarMap":{"data":"taskReviewLogData"},"batchSize":"1"},"processReviewLogAndTaskData":{"connectors":[{"exitPortType":"NextStep","nodeId":"checkRejectionReason"}],"contextChangePermitted":true,"name":"processReviewLogAndTaskData","description":"Process ReviewLogAndTaskData","processRule":"if(contextVar.taskReviewLogData != '' && Array.isArray(contextVar.taskReviewLogData)){ contextVar.taskReviewLogData.forEach(function (obj){ for(var key in obj){ contextVar.taskDetail[0][key] = obj[key]; } }); }","id":"processReviewLogAndTaskData","nodeType":"PROCESS"},"fetchCorrectiveTaskRequestListOptions":{"filter":"{$listOptionId} = 'POC3IW9Y2J'","models":["category","listOption","listOptionAnswer"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchTransportModesListOptions"}],"columns":{"listOptionAnswer":"listOptionAnswer.answerOptionText","listOption":"listOption.name","listOptionId":"listOption.id","categoryName":"category.name"},"name":"fetchCorrectiveTaskRequestListOptions","description":"List options for corrective task req","inputVarMap":{},"id":"fetchCorrectiveTaskRequestListOptions","outputVarMap":{"data":"correctiveTaskRequestReasons"},"nodeType":"QUERY"},"fetchIncidentType":{"filter":"{$listOptionId} = 'incidentType'","models":["category","listOption","listOptionAnswer"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchTravelIncidentReasons"}],"columns":{"listOptionAnswer":"listOptionAnswer.answerOptionText","listOptionAnswerId":"listOptionAnswer.id","listOption":"listOption.name","listOptionId":"listOption.id","categoryName":"category.name"},"name":"fetchIncidentType","description":"List options for Incident Types","orderBy":"listOptionAnswer ASC","inputVarMap":{},"id":"fetchIncidentType","outputVarMap":{"data":"incidentType"},"nodeType":"QUERY"},"fetchAssets":{"models":["installedBase","catalog","manufacturer"],"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"columns":{"catalogName":"catalog.name","installedBaseSiteId":"installedBase.siteId","installedBaseCatalogId":"installedBase.catalogId"},"description":"Provide some description for your query","orderBy":"catalogName ASC","inputVarMap":{"siteId":"siteId"},"groupBy":"catalogName","nodeType":"QUERY","filter":"{$installedBaseSiteId}={@siteId}","name":"fetchAssets","links":{},"id":"fetchAssets","outputVarMap":{"data":"assetsList"}},"fetchTaskDetails":{"models":["workOrderTask","workOrder","taskType","site","ZPriority","User"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchtaskReviewLog"}],"columns":{"address":"site.address","endDate":"DATE_ADD({$workOrderTask.scheduledDate}, INTERVAL CAST({$workOrderTask.estimatedDuration} AS UNSIGNED) MINUTE)","estimatedTaskDuration":"workOrderTask.estimatedDuration","latitude":"site.latitude","taskDescription":"workOrderTask.notes","checkInTime":"workOrderTask.actualStartTime","dueDate":"workOrderTask.dueDate","taskPriority":"ZPriority.name","scheduledDate":"workOrderTask.scheduledDate","services":"workOrderTask.services","taskTypeName":"taskType.name","userName":"User.name","result":"workOrderTask.result","enableServices":"workOrderTask.enableServices","workOrderTaskId":"workOrderTask.id","siteId":"site.id","workOrderId":"workOrder.id","taskId":"workOrderTask.id","longitude":"site.longitude","viewTravelStatus":"taskType.viewTravelStatus"},"description":"fetch task details","distinct":true,"inputVarMap":{"workOrderTaskId":"workOrderTaskId"},"nodeType":"QUERY","filter":"{$workOrderTaskId}={@workOrderTaskId} AND {$ZPriority.targetModel} = 'workOrder'","name":"fetchTaskDetails","links":{"workOrder":"workOrderTask","taskType":"workOrderTask","site":"workOrderTask","User":"workOrderTask","ZPriority":"workOrder"},"id":"fetchTaskDetails","outputVarMap":{"data":"taskDetail"},"batchSize":"1"},"fetchReportIssueListOptions":{"filter":" {$listOptionId}='reportIssue' ","models":["category","listOption","listOptionAnswer"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchTaskDetails"}],"columns":{"listOptionAnswer":"listOptionAnswer.answerOptionText","listOptionAnswerId":"listOptionAnswer.id","listOption":"listOption.name","listOptionId":"listOption.id","categoryName":"category.name"},"name":"fetchReportIssueListOptions","description":"List options for Report Issues","orderBy":"listOptionAnswer ASC","id":"fetchReportIssueListOptions","outputVarMap":{"data":"fetchReportIssue"},"nodeType":"QUERY"},"workflowContext":{"catalogList":[]},"fetchActivityIncidentReasons":{"filter":"{$listOptionId}='activityIncident' ","models":["category","listOption","listOptionAnswer"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchReportIssueListOptions"}],"columns":{"listOptionAnswer":"listOptionAnswer.answerOptionText","listOptionAnswerId":"listOptionAnswer.id","listOption":"listOption.name","listOptionId":"listOption.id","categoryName":"category.name"},"name":"fetchActivityIncidentReasons","description":"List options for Incident Reasons","orderBy":"listOptionAnswer ASC","id":"fetchActivityIncidentReasons","outputVarMap":{"data":"fetchActivityIncidentListOptions"},"nodeType":"QUERY"},"fetchServices":{"filter":"{$serviceTypeId}='service' AND {$serviceId} IN {@serviceId}","models":["catalog","category"],"connectors":[{"exitPortType":"NextStep","nodeId":"queryCustomerDetails"}],"columns":{"serviceTypeId":"catalog.catalogTypeId","serviceName":"catalog.name","serviceId":"catalog.id"},"name":"fetchServices","description":"","inputVarMap":{"catalogList":"serviceId"},"id":"fetchServices","outputVarMap":{"data":"serviceList"},"nodeType":"QUERY"},"end":{"name":"End","description":"End","inputVarMap":{"unassignedTask":"data"},"outputVarMap":{"unassignedTask":"data"},"nodeType":"END"},"fetchCheckInIncidentReasons":{"filter":"{$listOptionId}='checkInIncident' ","models":["category","listOption","listOptionAnswer"],"connectors":[{"exitPortType":"NextStep","nodeId":"fetchActivityIncidentReasons"}],"columns":{"listOptionAnswer":"listOptionAnswer.answerOptionText","listOptionAnswerId":"listOptionAnswer.id","listOption":"listOption.name","displayOrder":"listOptionAnswer.rank","listOptionId":"listOption.id","categoryName":"category.name"},"name":"fetchCheckInIncidentReasons","description":"List options for Incident Reasons","orderBy":"displayOrder ASC","id":"fetchCheckInIncidentReasons","outputVarMap":{"data":"checkInIncidentReasonsListOptions"},"nodeType":"QUERY"}}