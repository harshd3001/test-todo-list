{"pageContext":{"batchSize":20},"actionOnLoad":["@actions.setInitialData","@actions.getTimeZone"],"localPageContext":true,"jslib":{"isSaveDisabled":"function(pageContext){return(!(typeof pageContext.selectedRowIds!=='undefined'&&pageContext.selectedRowIds.length>0)||(typeof pageContext.selectedRowIds!=='undefined'&&pageContext.selectedRowIds.length>0&&typeof pageContext.workOrderTaskAssignedToUserId!=='undefined'&&pageContext.workOrderTaskAssignedToUserId!==''&&pageContext.workOrderTaskAssignedToUserId===pageContext.selectedRowIds[0].workforceUserId));}"},"header":{"leftData":{"children":[{"icon":"@iconlib.BackArrow","actionOnClick":["@actions.openPreviousPanel"],"id":"back","type":"buttonIcon"}]},"children":[{"buttonType":"primary","actionOnClick":["@actions.fetchTechnicianName","@actions.storeUserId","@actions.openPreviousPanel"],"disabled":"@jslib.isSaveDisabled","id":"submit","type":"button","title":"@lang.['s12','Save']"}],"title":"@lang.['sAppraiserAnalyst','Select Appraiser/Analyst']"},"body":{"children":[{"children":[{"actionOnChange":["@actions.viewChange"],"options":[{"name":"@lang.['vrAppAna','View Recommended Appraiser/Analyst']","id":"recTechs"},{"name":"@lang.['vaappana','View All Appraiser/Analyst']","id":"allTechs"}],"id":"dropdown","label":"@lang.['appraiserAnalyst','Appraiser/Analyst']","optTitleKey":"name","optValueKey":"id","title":"@lang.['appraiserAnalyst','Appraiser/Analyst']","type":"dropdown","value":"@pageContext.dropdown"}],"label":"","id":"techInfoDropdown","type":"section","transparent":false},{"hidden":"@pageContext.isRecommendedTechnicianHidden","children":[{"id":"datagridRecTechnician","label":"","type":"datagrid","jsonDef":{"isScrollAble":false,"deleteAllowed":false,"searchAllowed":true,"tableWidth":"70rem","searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"modifyRowActions":[],"gridRefreshId":"","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"singleSelect":true,"tableHeader":[{"name":"@lang.['i','id']","options":{"hidden":true,"showLabel":false},"key":"workforceUserId","primaryKey":true},{"name":"@lang.['n','Name']","options":{"flex":1.2,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"userName"},{"name":"@lang.['ur','Utilization Rate']","options":{"flex":1,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"utilizationScore"},{"name":"@lang.['tt','Travel Time']","options":{"flex":1,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"travelTime"},{"name":"@lang.['es2','Experience Score']","options":{"flex":1,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"experienceScore"},{"name":"@lang.['e4','Email']","options":{"flex":1.4,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"email"}],"dataToBeSent":{"apiResponseParams":["count"],"processId":"NBO7KO8B9T","apiResponseFormat":true,"contextVar":{"localize":"@pageContext.localize","timezoneOffset":"@pageContext.timezoneOffset","workflowCall":"recommendTechnician","workOrderTaskId":"@pageContext.workOrderTaskId"},"apiResponseObject":"technicianList"},"rowsToSelect":{"filter":"{$workforceUserId}={@id}","models":["workforce"],"columns":{"workforceUserId":"workforce.userId","workforceStatusId":"workforce.statusId"},"inputs":{"id":"@pageContext.workOrderTaskAssignedToUserId"}},"dataSourceId":"process/start","sourceType":"api","jslib":{"isShowScheduleDisabled":"function(pageContext){ return !(typeof pageContext.selectedRowIds !== 'undefined' && pageContext.selectedRowIds.length > 0); }"},"header":{"subHeaderText":"@lang.['appraiserAnalyst','Appraiser/Analyst']","headerText":"@lang.['rappana','Recommended Appraiser/Analyst']","children":[{"buttonType":"secondary","actionOnClick":["@actions.setCalendarVisibilityTrue","@actions.calendarFromAPI","@actions.initialEventsData"],"disabled":"@jslib.isShowScheduleDisabled","id":"getTechSchedule","type":"button","title":"@lang.['ss3','Show Schedule']"}]},"isSelectable":true,"dataSource":[],"actions":[{"name":"setCalendarVisibilityTrue","type":"script","actionDef":"function(pageContext){pageContext.hideSchedule = false;}"},{"name":"calendarFromAPI","outputVarMap":{"data":"@pageContext.calendarFromAPIQuery"},"type":"query","actionDef":{"filter":"{$workOrderId} = {$workOrderTaskWorkOrderId} and {$workOrderTaskAssignedToUserId} = {@currentlyAssignedUser} and {$statusTargetModel}='workOrderTask' and {$statusId} IN {@statusFilter} and {$taskType.webTask} = false","models":["taskType","workOrder","workOrderTask","ZStatus"],"inputs":{"statusFilter":["workOrderTaskScheduled","workOrderTaskDispatched","workOrderTaskInProgress","workOrderTaskPendingReview","workOrderTaskDiscontinued","workOrderTaskIncident","workOrderTaskInTransit","workOrderTaskDelayed","workOrderTaskCompleted"],"currentlyAssignedUser":"@pageContext.selectedRowIds[0].workforceUserId"},"columns":{"backgroundColor":"ZStatus.colorCode","workOrderTaskAssignedToUserId":"workOrderTask.assignedToUserId","statusTargetModel":"ZStatus.targetModel","workOrderTaskDueDate":"workOrderTask.dueDate","workOrderTaskActualStartTime":"workOrderTask.actualStartTime","statusId":"ZStatus.id","workOrderTaskWorkOrderId":"workOrderTask.workOrderId","statusName":"ZStatus.name","workOrderTaskId":"workOrderTask.id","workOrderTaskEstimatedDuration":"workOrderTask.estimatedDuration","workOrderTaskScheduledDate":"workOrderTask.scheduledDate","workOrderId":"workOrder.id","workOrderTaskCompletedDate":"workOrderTask.completedDate"},"links":{"workOrder":"workOrderTask","taskType":"workOrderTask","ZStatus":"workOrderTask"}}},{"name":"initialEventsData","type":"script","actionDef":"function(pageContext) { var calendarEvents = []; pageContext.calendarFromAPIQuery.forEach((event) => { var events = {}; events['id'] = event.workOrderTaskId; events['title'] = event.workOrderTaskId; if (typeof event.workOrderTaskActualStartTime !== 'undefined' && typeof event.workOrderTaskCompletedDate !== 'undefined') { events['start'] = event.workOrderTaskActualStartTime; events['end'] = event.workOrderTaskCompletedDate; } else if (typeof event.workOrderTaskActualStartTime !== 'undefined' && typeof event.workOrderTaskCompletedDate === 'undefined') { events['start'] = event.workOrderTaskActualStartTime; events['end'] = event.workOrderTaskDueDate; } else if (typeof event.workOrderTaskActualStartTime === 'undefined' && typeof event.workOrderTaskCompletedDate === 'undefined') { events['start'] = event.workOrderTaskScheduledDate; events['end'] = event.workOrderTaskDueDate; } events['backgroundColor'] = event.backgroundColor; events['color'] = '#000000'; calendarEvents.push(events); }); pageContext.calenderEventsData = calendarEvents; }"}],"searchKeys":["userName"]}}],"label":"@lang.['s16','Search']","id":"recommendedTechnician","type":"section","transparent":true},{"hidden":"@pageContext.isRecommendedTechnicianEmpty","children":[{"id":"datagridRecTechnician","label":"","type":"datagrid","jsonDef":{"tableWidth":"70rem","header":{"subHeaderText":"@lang.['appraiserAnalyst','Appraiser/Analyst']","headerText":"@lang.['rappana','Recommended Appraiser/Analyst']","children":[{"buttonType":"secondary","disabled":true,"id":"getTechSchedule","type":"button","title":"@lang.['ss3','Show Schedule']"}]},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['assttsraa','ADD SCHEDULED START TIME TO SEE RECOMMENDED APPRAISER/ANALYST']","type":"noData"}}}],"label":"@lang.['s16','Search']","id":"recommendedTechnician","type":"section","transparent":true},{"hidden":"@pageContext.isViewAllTechniciansHidden","children":[{"id":"datagridalltechnician","label":"","type":"datagrid","jsonDef":{"isScrollAble":true,"deleteAllowed":false,"searchAllowed":true,"tableWidth":"70rem","searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"modifyRowActions":[],"gridRefreshId":"","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"singleSelect":true,"tableHeader":[{"name":"@lang.['i','id']","options":{"hidden":true,"showLabel":false},"key":"workforceUserId","primaryKey":true},{"name":"@lang.['i','id']","options":{"hidden":true,"showLabel":false},"key":"id","primaryKey":true},{"name":"@lang.['n','Name']","options":{"flex":1.2,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"userName"},{"name":"@lang.['tt','Travel Time']","options":{"flex":1,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"travelTime"},{"name":"@lang.['a2','Availability']","options":{"flex":1,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"availability"},{"name":"@lang.['s4','Shift']","options":{"flex":1.2,"sortOrder":"ASC","dateRangeType":"absoluteTime","sortable":true,"type":"dateRange","showLabel":true},"key":"shiftTime"},{"name":"@lang.['e4','Email']","options":{"flex":1.4,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"userEmail"}],"dataToBeSent":{"apiResponseParams":["count"],"processId":"MYRXCR8VVY","apiResponseFormat":true,"contextVar":{"localize":"@pageContext.localize","timezoneOffset":"@pageContext.timezoneOffset","workOrderTaskId":"@pageContext.workOrderTaskId"},"batchSize":"@pageContext.batchSize","apiResponseObject":"viewAllTechnicianData"},"rowsToSelect":{"filter":"{$workforceUserId}={@id}","models":["workforce"],"columns":{"workforceUserId":"workforce.userId","workforceStatusId":"workforce.statusId"},"inputs":{"id":"@pageContext.workOrderTaskAssignedToUserId"}},"dataSourceId":"process/start","sourceType":"api","jslib":{"isShowScheduleDisabled":"function(pageContext){ return !(typeof pageContext.selectedRowIds !== 'undefined' && pageContext.selectedRowIds.length > 0); }"},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['aaa2','All Appraiser/Analyst']","children":[{"buttonType":"secondary","actionOnClick":["@actions.setCalendarVisibilityTrue","@actions.calendarFromAPI","@actions.initialEventsData"],"disabled":"@jslib.isShowScheduleDisabled","id":"getTechSchedule","type":"button","title":"@lang.['ss3','Show Schedule']"}]},"isSelectable":true,"dataSource":[],"actions":[{"name":"setCalendarVisibilityTrue","type":"script","actionDef":"function(pageContext){pageContext.hideSchedule = false;}"},{"name":"calendarFromAPI","outputVarMap":{"data":"@pageContext.calendarFromAPIQuery"},"type":"query","actionDef":{"filter":"{$workOrderId} = {$workOrderTaskWorkOrderId} and {$workOrderTaskAssignedToUserId} = {@currentlyAssignedUser} and {$statusTargetModel}='workOrderTask' and {$statusId} NOT IN {@statusFilter} and {$taskType.webTask} = false","models":["taskType","workOrder","workOrderTask","ZStatus"],"inputs":{"statusFilter":["workOrderTaskOpen","workOrderTaskReopened","workOrderTaskCancelled","workOrderTaskRejected"],"currentlyAssignedUser":"@pageContext.selectedRowIds[0].workforceUserId"},"columns":{"backgroundColor":"ZStatus.colorCode","workOrderTaskAssignedToUserId":"workOrderTask.assignedToUserId","statusTargetModel":"ZStatus.targetModel","workOrderTaskDueDate":"workOrderTask.dueDate","workOrderTaskActualStartTime":"workOrderTask.actualStartTime","statusId":"ZStatus.id","workOrderTaskWorkOrderId":"workOrderTask.workOrderId","statusName":"ZStatus.name","workOrderTaskId":"workOrderTask.id","workOrderTaskEstimatedDuration":"workOrderTask.estimatedDuration","workOrderTaskScheduledDate":"workOrderTask.scheduledDate","workOrderId":"workOrder.id","workOrderTaskCompletedDate":"workOrderTask.completedDate"},"links":{"workOrder":"workOrderTask","taskType":"workOrderTask","ZStatus":"workOrderTask"}}},{"name":"initialEventsData","type":"script","actionDef":"function(pageContext) { var calendarEvents = []; pageContext.calendarFromAPIQuery.forEach((event) => { var events = {}; events['id'] = event.workOrderTaskId; events['title'] = event.workOrderTaskId; if (typeof event.workOrderTaskActualStartTime !== 'undefined' && typeof event.workOrderTaskCompletedDate !== 'undefined') { events['start'] = event.workOrderTaskActualStartTime; events['end'] = event.workOrderTaskCompletedDate; } else if (typeof event.workOrderTaskActualStartTime !== 'undefined' && typeof event.workOrderTaskCompletedDate === 'undefined') { events['start'] = event.workOrderTaskActualStartTime; events['end'] = event.workOrderTaskDueDate; } else if (typeof event.workOrderTaskActualStartTime === 'undefined' && typeof event.workOrderTaskCompletedDate === 'undefined') { events['start'] = event.workOrderTaskScheduledDate; events['end'] = event.workOrderTaskDueDate; } events['backgroundColor'] = event.backgroundColor; events['color'] = '#000000'; calendarEvents.push(events); }); pageContext.calenderEventsData = calendarEvents; }"}],"searchKeys":["userName"]}}],"label":"@lang.['s16','Search']","id":"viewAllTechnician","type":"section","transparent":true},{"hidden":"@pageContext.isViewAlltechnicianEmpty","children":[{"id":"datagridViewAllTechniciansEmpty","label":"","type":"datagrid","jsonDef":{"tableWidth":"70rem","header":{"subHeaderText":"@lang.['appraiserAnalyst','Appraiser/Analyst']","headerText":"@lang.['aaa2','All Appraiser/Analyst']","children":[{"buttonType":"secondary","disabled":true,"id":"getTechSchedule","type":"button","title":"@lang.['ss3','Show Schedule']"}]},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['assttsaa','ADD SCHEDULED START TIME TO SEE APPRAISER/ANALYST']","type":"noData"}}}],"label":"@lang.['s16','Search']","id":"emptyViewAllTechnicians","type":"section","transparent":true},{"hidden":"@pageContext.hideSchedule","children":[{"disabled":false,"id":"technicianSchedule","label":"@lang.['aas','Appraiser/Analyst Schedule']","type":"calendarComponent","config":{"setPageContext":true,"actionOnClick":[]},"events":"@pageContext.calenderEventsData"}],"label":"","id":"showSchedule","type":"section","transparent":false},{"children":[{"children":[{"id":"recommendationDescriptionText","type":"infoText","value":"@lang.['mdpauitatrtbaatdtt','Many different parameters are used in the algorithm to recommend the best Appraiser/Analyst to do this task. Here\u2019s an overview of the metrics you see above to give you a better understanding of how recommendations are made.']"}],"label":"","id":"recommendation","type":"section","transparent":true},{"children":[{"id":"utilizationRateText","type":"infoText","value":"@lang.['awmutktlebiywaa','A weekly metric used to keep task load evenly balanced in your workforce. Appraiser/Analyst with lower utilizations rates are prioritized to keep the distribution even.']"}],"label":"@lang.['ur','Utilization Rate']","id":"utilization","type":"section","transparent":true},{"children":[{"id":"predictedTravelTimeText","type":"infoText","value":"@lang.['ettbtoftaabl','Estimated travel time between tasks or from the Appraiser/Analyst base location. This figure is an estimate and can change depending on schedule adjustments, but gives you an idea of who may be in the area at the scheduled time of this task.']"}],"label":"@lang.['ptt','Predicted Travel Time']","id":"predicted","type":"section","transparent":true},{"children":[{"id":"infoText","type":"infoText","value":"@lang.['tsracoeatcs','This score reflects a combination of experience at the customer site, experience performing similar tasks, and first time fix rate.']"}],"label":"@lang.['es2','Experience Score']","id":"experience","type":"section","transparent":true}],"label":"@lang.['haaar','How Appraiser/Analyst are Recommended']","id":"recDescription","type":"collapseSection","transparent":false}]},"actions":[{"name":"storeUserId","type":"script","actionDef":"function(pageContext){pageContext.workOrderTaskAssignedToUserId=pageContext.selectedRowIds[0].workforceUserId;pageContext.userName=pageContext.assignedTechNameResponse[0].name; pageContext.selectDropdown =[]; pageContext.selectDropdown.push({'value':pageContext.workOrderTaskAssignedToUserId, 'label':pageContext.userName}) }"},{"name":"viewChange","type":"script","actionDef":"function(pageContext){pageContext.hideSchedule=true;if(pageContext.dropdown==='recTechs'){if(typeof pageContext.workOrderTaskScheduledDate==='undefined'||pageContext.workOrderTaskScheduledDate===''){pageContext.isRecommendedTechnicianHidden=true;pageContext.isViewAllTechniciansHidden=true;pageContext.isViewAlltechnicianEmpty=true;pageContext.isRecommendedTechnicianEmpty=false;}else{pageContext.isRecommendedTechnicianHidden=false;pageContext.isViewAllTechniciansHidden=true;pageContext.isViewAlltechnicianEmpty=true;pageContext.isRecommendedTechnicianEmpty=true;}}else{if(typeof pageContext.workOrderTaskScheduledDate==='undefined'||pageContext.workOrderTaskScheduledDate===''){pageContext.isRecommendedTechnicianHidden=true;pageContext.isViewAllTechniciansHidden=true;pageContext.isViewAlltechnicianEmpty=false;pageContext.isRecommendedTechnicianEmpty=true;}else{pageContext.isRecommendedTechnicianHidden=true;pageContext.isViewAllTechniciansHidden=false;pageContext.isViewAlltechnicianEmpty=true;pageContext.isRecommendedTechnicianEmpty=true;}}}"},{"name":"setInitialData","type":"script","actionDef":"function(pageContext){pageContext.localize=navigator.language||navigator.userLanguage;pageContext.dropdown='recTechs';pageContext.hideSchedule=true;if(typeof pageContext.workOrderTaskScheduledDate==='undefined'||pageContext.workOrderTaskScheduledDate===''){pageContext.isRecommendedTechnicianHidden=true;pageContext.isViewAllTechniciansHidden=true;pageContext.isViewAlltechnicianEmpty=true;pageContext.isRecommendedTechnicianEmpty=false;}else{pageContext.isRecommendedTechnicianHidden=false;pageContext.isViewAllTechniciansHidden=true;pageContext.isViewAlltechnicianEmpty=true;pageContext.isRecommendedTechnicianEmpty=true;}}"},{"name":"fetchTechnicianName","outputVarMap":{"data":"@pageContext.assignedTechNameResponse"},"type":"query","actionDef":{"filter":"{$id}={@id}","models":["User"],"columns":{"name":"User.name","id":"User.id"},"inputs":{"id":"@pageContext.selectedRowIds[0].workforceUserId"}}},{"parentPanelRefreshRequired":false,"name":"openPreviousPanel","type":"backPanel","requiredPageContextKeys":"[ \"workOrderTaskAssignedToUserId\",\"userName\",\"selectDropdown\" ]"},{"name":"getTimeZone","type":"script","actionDef":"function(pageContext) {pageContext.timezoneOffset=new Date().getTimezoneOffset();}"}]}