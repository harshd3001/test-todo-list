{"pageContext":{},"actionOnLoad":["@actions.getRegionData"],"localPageContext":true,"jslib":{"isAddRegionDisable":"function(pageContext){return (pageContext.regionId === '' || typeof pageContext.regionId ==='undefined');}"},"header":{"leftData":{"children":[{"name":"back","icon":"@iconlib.NavigationArrowBackGrey","actionOnClick":["@actions.openPreviousPanel","@actions.refreshDataGrid"],"type":"buttonIcon"}]},"children":[{"buttonType":"primary","actionOnClick":["@actions.setSubActionUpsertContractorRegion","@actions.fireProcessEvent","@actions.openPreviousPanel","@actions.refreshDataGrid"],"disabled":"@jslib.isAddRegionDisable","id":"submit","type":"button","title":"@lang.['s12','Save']"}],"title":"@lang.['anr','Add New Region']"},"body":{"children":[{"children":[{"isRequired":true,"actionOnChange":["@actions.getSubRegionData"],"options":"@pageContext.regionsList","id":"region","optTitleKey":"regionName","optValueKey":"regionId","title":"@lang.['r1','Region']","type":"dropdown","value":"@pageContext.regionId","placeHolder":"@lang.['sr','Select region']"},{"isRequired":true,"options":"@pageContext.subRegionsList","id":"subRegion","optTitleKey":"subRegionName","optValueKey":"subRegionId","title":"@lang.['s14','Subregion (Optional)']","type":"dropdown","value":"@pageContext.subRegionId","placeHolder":"@lang.['ssr','Select subregion']"}],"label":"@lang.['r1','Region']","id":"regionSection","type":"section"}]},"actions":[{"name":"getRegionData","outputVarMap":{"data":"@pageContext.regionsList"},"type":"query","actionDef":{"filter":"{$subRegionId} NOT IN ({@selectedSubRegions})","models":["region","subRegion"],"inputs":{"selectedSubRegions":{"filter":"{$contractorRegionContractorId} = {@selectedContractor}","models":["subRegion","contractorRegion"],"columns":{"subRegionId":"subRegion.id","contractorRegionContractorId":"contractorRegion.contractorId"},"inputs":{"selectedContractor":"@pageContext.contractorId"},"selectColumns":["subRegionId"]}},"columns":{"regionId":"region.id","regionName":"region.name","subRegionId":"subRegion.id"},"orderBy":"regionName ASC","outerJoinOnModel":"region","distinct":true,"selectColumns":["regionId","regionName"],"getCount":true}},{"name":"getSubRegionData","outputVarMap":{"data":"@pageContext.subRegionsList"},"type":"query","actionDef":{"filter":" {$regionId}={@selectedRegionId} && {$subRegionId} not in ({@contractorRegionSubRegionId})","models":["region","subRegion"],"columns":{"regionId":"region.id","regionName":"region.name","subRegionId":"subRegion.id","subRegionName":"subRegion.name","subRegionRegionId":"subRegion.regionId"},"inputs":{"contractorRegionSubRegionId":{"filter":"{$contractorRegionContractorId} = {@selectedContractorId} && {$contractorRegionRegionId} = {@selectedContractorRegionId}","models":["contractorRegion"],"columns":{"contractorRegionSubRegionId":"contractorRegion.subRegionId","contractorRegionRegionId":"contractorRegion.regionId","contractorRegionContractorId":"contractorRegion.contractorId"},"inputs":{"selectedContractorRegionId":"@pageContext.regionId","selectedContractorId":"@pageContext.contractorId"},"selectColumns":["contractorRegionSubRegionId"]},"selectedRegionId":"@pageContext.regionId"},"orderBy":"subRegionName ASC"}},{"name":"openPreviousPanel","type":"backPanel"},{"name":"refreshDataGrid","type":"refreshDataGrid"},{"name":"setSubActionUpsertContractorRegion","type":"script","actionDef":"function(pageContext){pageContext.subAction='upsertContractorRegion';}"},{"endPoint":"event/start","name":"fireProcessEvent","type":"api","actionDef":{"data":[{"eventId":"workforceContractorProcessEvent","contextVar":{"contractorRegion":{"regionId":"@pageContext.regionId","contractorId":"@pageContext.contractorId","subRegionId":"@pageContext.subRegionId"},"subAction":"@pageContext.subAction"}}]}}]}