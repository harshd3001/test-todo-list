{"pageContext":{},"actionOnLoad":["@actions.initialData","@actions.getStockUnit"],"jslib":{"setNumberForCost":"function(pageContext) { if ((typeof pageContext.catalogUnitPrice !== 'undefined' && pageContext.catalogUnitPrice !== '')) { return (Number(pageContext.catalogUnitPrice) < 0); } }","isAddHidden":"function(pageContext){ if(pageContext.partsAssetAction === 'add'){return true;}else{return false;}}","setNumberForListPrice":"function(pageContext) { if ((typeof pageContext.catalogCustomerPrice !== 'undefined' && pageContext.catalogCustomerPrice !== '')) { return (Number(pageContext.catalogCustomerPrice) < 0); }}","dynamicHeaderText":"function(pageContext){ if(pageContext.partsAssetAction === 'add'){return '@lang.[\"acni\",\"Add New Catalog Item\"]'}else if(pageContext.partsAssetAction === 'edit'){return '@lang.[\"eci\",\"Edit Catalog Item\"]'}}","isSaveDisabled":"function(pageContext) {function nullCheck(a) { return (typeof a === 'undefined' || a === '' || a === null) } function compareInitialChanged(a, b) { return a === b } if (pageContext.partsAssetAction === 'add') { return (nullCheck(pageContext.catalogStockUnitId) || nullCheck(pageContext.catalogManufacturerId) || nullCheck(pageContext.catalogModelNumber) || nullCheck(pageContext.selectedManufacturer) || nullCheck(pageContext.selectedManufacturer[0]) || nullCheck(pageContext.catalogName)); } else if (pageContext.partsAssetAction === 'edit') { return ((compareInitialChanged(pageContext.catalogStockUnitId, pageContext.initialCatalogStockUnitId) && compareInitialChanged(pageContext.catalogDescription, pageContext.initialCatalogDescription) && compareInitialChanged(pageContext.catalogManufacturerId, pageContext.initialCatalogManufacturerId) && compareInitialChanged(pageContext.catalogAssetCategoryId, pageContext.initialCatalogAssetCategoryId) && compareInitialChanged(pageContext.catalogModelNumber, pageContext.initialCatalogModelNumber) && compareInitialChanged(pageContext.catalogName, pageContext.initialCatalogName) && compareInitialChanged(Number(pageContext.catalogUnitPrice), pageContext.initialCatalogUnitPrice) && compareInitialChanged(Number(pageContext.catalogCustomerPrice), pageContext.initialCatalogCustomerPrice) && compareInitialChanged(pageContext.catalogCategoryId, pageContext.initialCatalogCategoryId) && compareInitialChanged(nullCheck(pageContext.fileUpload) || !(Array.isArray(pageContext.fileUpload)) ? '' : pageContext.fileUpload[0].fileUrl, nullCheck(pageContext.initialFileUrl) ? '' : pageContext.initialFileUrl)) || nullCheck(pageContext.catalogStockUnitId) || nullCheck(pageContext.catalogManufacturerId) || nullCheck(pageContext.catalogModelNumber) || nullCheck(pageContext.selectedManufacturer) || nullCheck(pageContext.selectedManufacturer[0]) || nullCheck(pageContext.catalogName)); }}"},"header":{"children":[{"buttonType":"primary","actionOnClick":["@actions.setPrice","@actions.getUploadFileData","@actions.setSubActionUpsertCatalog","@actions.fireProcessEvent","@actions.closePanel","@actions.clearPageContext","@actions.refreshDataGrid"],"disabled":"@jslib.isSaveDisabled","id":"submit","type":"button","title":"@lang.['s12','Save']"},{"icon":"@iconlib.NavigationCloseGrey","actionOnClick":["@actions.closePanel","@actions.clearPageContext","@actions.refreshMainDataGrid"],"id":"close","type":"buttonIcon"}],"title":"@jslib.dynamicHeaderText"},"body":{"children":[{"children":[{"isRequired":true,"inputType":"text","id":"catalogName","label":"@lang.['mn','Model Name']","placeholder":"@lang.['emn1','Enter model name']","type":"input","value":"@pageContext.catalogName"},{"id":"catalogDescription","label":"@lang.['d7','Description (Optional)']","type":"textarea","value":"@pageContext.catalogDescription","placeHolder":"@lang.['ed1','Enter description']"},{"isRequired":true,"id":"catalogModelNumber","label":"@lang.['mn1','Model Number']","placeholder":"@lang.['emn2','Enter model number']","type":"input","value":"@pageContext.catalogModelNumber"},{"isRequired":true,"actionOnChange":["@actions.setSelectedManufacturerId"],"isMultiSelect":false,"searchByOptions":{"dataSourceId":"query/read","sourceType":"query","dataToBeSent":{"filter":"{$name} like {@filter}","models":["manufacturer"],"columns":{"name":"manufacturer.name","id":"manufacturer.id"},"orderBy":"name ASC"}},"optLabelMap":"name","optValueMap":"id","id":"manufacturerList","label":"@lang.['m','Manufacturer']","type":"selectDropdown","value":"@pageContext.selectedManufacturer","placeHolder":"@lang.['sm','Select manufacturer']"},{"isRequired":true,"actionOnChange":["@actions.setSelectedAssetCategoryId"],"isMultiSelect":false,"searchByOptions":{"dataSourceId":"query/read","sourceType":"query","dataToBeSent":{"filter":"{$name} like {@filter}","models":["assetCategory"],"columns":{"name":"name","id":"id"},"orderBy":"name ASC"}},"optLabelMap":"name","optValueMap":"id","id":"assetCategoryList","label":"@lang.['c34','Category (Optional)']","type":"selectDropdown","value":"@pageContext.selectedAssetCategory","placeHolder":"@lang.['sc8','Select Category']"},{"options":"@pageContext.stockUnitList","id":"stockUnit","optTitleKey":"name","optValueKey":"id","type":"select","title":"@lang.['su1','Stock Unit']","value":"@pageContext.catalogStockUnitId","placeHolder":"@lang.['ssu','Select stock unit']"}],"label":"@lang.['gi','General Information']","id":"generalInformationSection","type":"section"},{"children":[{"errorText":"@lang.['epevp','Error! Please enter valid price']","validator":"@jslib.setNumberForCost","inputType":"number","id":"catalogUnitPrice","label":"@lang.['c31','Cost']","placeholder":"@lang.['ep','Enter price']","type":"currency","value":"@pageContext.catalogUnitPrice"},{"errorText":"@lang.['epevp','Error! Please enter valid price']","validator":"@jslib.setNumberForListPrice","inputType":"number","id":"catalogCustomerPrice","label":"@lang.['lp','List Price']","placeholder":"@lang.['ep','Enter price']","type":"currency","value":"@pageContext.catalogCustomerPrice"},{"actionOnChange":["@actions.emptyCategoryTaxRate","@actions.setSelectedCategoryId","@actions.getTaxCategory","@actions.changeInCategory"],"isMultiSelect":false,"searchByOptions":{"dataSourceId":"query/read","sourceType":"query","dataToBeSent":{"filter":"{$name} like {@filter} AND {$categoryTypeId} = 'tax'","models":["category"],"columns":{"rate":"category.taxRate","name":"category.name","id":"category.id"}}},"optLabelMap":"name","optValueMap":"id","id":"selectedCategory","label":"@lang.['tc2','Tax Category']","type":"selectDropdown","value":"@pageContext.selectedCategory","placeHolder":"@lang.['stc','Select tax category']"},{"disabled":true,"id":"categoryTaxRate","label":"@lang.['tr','Tax Rate (%)']","placeholder":"@lang.['tribostc','Tax Rate (%) is based on selected tax category']","type":"input","value":"@pageContext.categoryTaxRate"}],"label":"@lang.['a12','Accounting (Optional)']","id":"accountingSection","type":"section"},{"children":[{"modelName":"catalog","fieldName":"pdfUrl","isDeleteHidden":false,"responseData":"fileUpload","id":"uploadFile","showFileList":true,"label":"@lang.['uf','Upload File']","type":"fileUpload","value":"@pageContext.fileUrl","fileTypes":".pdf","isDownloadHidden":false}],"label":"@lang.['pm1','Part Manual (Optional)']","id":"pdfFileUpload","type":"section"}]},"actions":[{"name":"getUploadFileData","type":"script","actionDef":"function (pageContext) { if (Array.isArray(pageContext.fileUpload) && pageContext.fileUpload.length > 0 && typeof pageContext.fileUpload[0].fileUrl !== 'undefined' && pageContext.fileUpload[0].fileUrl !== '') { pageContext.fileUrl = pageContext.fileUpload[0].fileUrl; } }"},{"name":"setPrice","type":"script","continueOnError":true,"actionDef":"function(pageContext) {var roundoff=pageContext.catalogUnitPrice;roundoff=roundoff.toFixed(2);pageContext.catalogUnitPrice=roundoff;var ToFixed=pageContext.catalogCustomerPrice;ToFixed=ToFixed.toFixed(2);pageContext.catalogCustomerPrice=ToFixed;}"},{"endPoint":"event/start","name":"fireProcessEvent","outputVarMap":{"data":"@pageContext.data"},"type":"api","actionDef":{"data":[{"eventId":"billingCatalogProcessEvent","contextVar":{"catalog":{"unitPrice":"@pageContext.catalogUnitPrice","manufacturerId":"@pageContext.catalogManufacturerId","description":"@pageContext.catalogDescription","catalogTypeId":"partAndAsset","customerPrice":"@pageContext.catalogCustomerPrice","pdfUrl":"@pageContext.fileUrl","recver":"@pageContext.catalogRecver","name":"@pageContext.catalogName","assetCategoryId":"@pageContext.catalogAssetCategoryId","modelNumber":"@pageContext.catalogModelNumber","id":"@pageContext.catalogId","categoryId":"@pageContext.catalogCategoryId","stockUnitId":"@pageContext.catalogStockUnitId"},"subAction":"@pageContext.subAction"}}]}},{"name":"changeInCategory","type":"script","actionDef":"function(pageContext){pageContext.categoryTaxRate=pageContext.taxCategoryList[0].categoryTaxRate;}"},{"name":"initialData","type":"script","actionDef":"function(pageContext) { if (pageContext.partsAssetAction == 'edit') { pageContext.initialCatalogName = pageContext.catalogName; pageContext.initialCategoryName = pageContext.categoryName; pageContext.initialCatalogDescription = pageContext.catalogDescription; pageContext.initialCatalogModelNumber = pageContext.catalogModelNumber; pageContext.initialCatalogManufacturerId = pageContext.catalogManufacturerId; pageContext.initialCatalogAssetCategoryId = pageContext.catalogAssetCategoryId; pageContext.initialCatalogCategoryId = pageContext.catalogCategoryId; pageContext.initialCatalogUnitPrice = pageContext.catalogUnitPrice; pageContext.initialCatalogCustomerPrice = pageContext.catalogCustomerPrice; pageContext.initialCatalogStockUnitId = pageContext.catalogStockUnitId; pageContext.initialFileUrl = pageContext.fileUrl; pageContext.id = pageContext.catalogId; pageContext.recver = pageContext.catalogRecver; if (typeof pageContext.manufacturerName !== 'undefined' && pageContext.manufacturerName !== '') { pageContext.selectedManufacturer = []; var manufacturerObj = { label: pageContext.manufacturerName, value: pageContext.catalogManufacturerId }; pageContext.selectedManufacturer.push(manufacturerObj); } if (typeof pageContext.assetCategoryName !== 'undefined' && pageContext.assetCategoryName !== '') { pageContext.selectedAssetCategory = []; pageContext.selectedAssetCategory.push({ label: pageContext.assetCategoryName, value: pageContext.catalogAssetCategoryId }); } if (typeof pageContext.categoryName !== 'undefined' && pageContext.categoryName !== '') { pageContext.selectedCategory = []; var categoryObj = { label: pageContext.categoryName, value: pageContext.catalogCategoryId }; pageContext.selectedCategory.push(categoryObj); } if (typeof pageContext.fileUrl !== 'undefined' && pageContext.fileUrl !== '') { pageContext.fileUpload = [{ 'fileUrl': pageContext.fileUrl }]; } } else if (pageContext.partsAssetAction == 'add') { pageContext.catalogName = ''; pageContext.catalogDescription = ''; pageContext.catalogModelNumber = ''; pageContext.catalogManufacturerId = ''; pageContext.catalogAssetCategoryId = ''; pageContext.catalogCategoryId = ''; pageContext.catalogUnitPrice = ''; pageContext.catalogCustomerPrice = ''; pageContext.catalogStockUnitId = ''; pageContext.catalogAssetCategoryId = ''; } }"},{"name":"setSelectedManufacturerId","type":"script","actionDef":"function(pageContext){ if(pageContext.selectedManufacturer[0]===null || typeof pageContext.selectedManufacturer==='undefined' || pageContext.selectedManufacturer==='' || typeof pageContext.selectedManufacturer[0].value==='undefined' || pageContext.selectedManufacturer[0].value==='' ){ pageContext.catalogManufacturerId = ''; } else{ pageContext.catalogManufacturerId= pageContext.selectedManufacturer[0].value; } }"},{"name":"setSelectedAssetCategoryId","type":"script","actionDef":"function(pageContext){ if(pageContext.selectedAssetCategory[0]===null || typeof pageContext.selectedAssetCategory==='undefined' || pageContext.selectedAssetCategory==='' || typeof pageContext.selectedAssetCategory[0].value==='undefined' || pageContext.selectedAssetCategory[0].value==='' ){ pageContext.catalogAssetCategoryId = ''; } else{ pageContext.catalogAssetCategoryId = pageContext.selectedAssetCategory[0].value; } }"},{"name":"emptyCategoryTaxRate","type":"script","actionDef":"function(pageContext){pageContext.categoryTaxRate='';}"},{"name":"setSelectedCategoryId","type":"script","actionDef":"function(pageContext){ if (pageContext.selectedCategory[0] === null || typeof pageContext.selectedCategory[0].value === 'undefined' || pageContext.selectedCategory[0].value === '') { pageContext.catalogCategoryId = ''; } else { pageContext.catalogCategoryId = pageContext.selectedCategory[0].value; } }"},{"name":"getTaxCategory","outputVarMap":{"data":"@pageContext.taxCategoryList"},"type":"query","actionDef":{"filter":"{@catalogCategoryId}={$categoryId}","models":["category"],"columns":{"categoryTaxRate":"category.taxRate","categoryName":"category.name","categoryId":"category.id"},"inputs":{"catalogCategoryId":"@pageContext.catalogCategoryId"}}},{"name":"getStockUnit","outputVarMap":{"data":"@pageContext.stockUnitList"},"type":"query","actionDef":{"filter":"","models":["stockUnit"],"columns":{"name":"stockUnit.name","id":"stockUnit.id"},"orderBy":"name ASC"}},{"name":"setSubActionUpsertCatalog","type":"script","actionDef":"function(pageContext){pageContext.subAction='upsertCatalog';}"},{"name":"setSubActionDeleteCatalog","type":"script","actionDef":"function(pageContext){pageContext.subAction='deleteCatalog';}"},{"name":"refreshMainDataGrid","gridId":["partsMainGrid"],"type":"RefreshGridOnSidePanel"},{"name":"closeModal","type":"closeModal"},{"name":"closePanel","type":"closePanel"},{"name":"clearPageContext","type":"clearPageContext"},{"name":"refreshDataGrid","type":"refreshDataGrid"}]}