{"pageContext":{},"actionOnLoad":["@actions.initialData"],"jslib":{"showTechnicians":"function(pageContext){return(pageContext.contractorAction==='add') }","hideRegions":"function(pageContext){return( pageContext.contractorAction==='add' && pageContext.contractorAdded===false)}","isSaveContinueDisabled":"function(pageContext){return ((pageContext.contractorName === '')|| (pageContext.contractorContactName === '') || (pageContext.contractorContactTitle === '') || (pageContext.contractorContactEmail === '') || (pageContext.contractorContactPhone === '') || (pageContext.contactPhoneIsValid === false) || (pageContext.contractorAddress === ''))}","isAddressPopulated":"function(pageContext){return !pageContext.contractorAddress }","showContractorDetails":"function(pageContext){return(pageContext.contractorAction==='add' &&  pageContext.contractorAdded===false) }","isSave&ContinueHidden":"function(pageContext){return(pageContext.contractorAction==='edit'|| (pageContext.contractorAction==='add' && pageContext.contractorAdded===true)) }","dynamicHeaderText":"function(pageContext){ if(pageContext.contractorAction === 'add'){return '@lang.[\"anc\",\"Add New Contractor\"]'}else if(pageContext.contractorAction === 'edit'){return '@lang.[\"ec2\",\"Edit Contractor\"]'}}","isSaveDisabled":"function (pageContext) { if ((pageContext.contractorAction === 'edit') && (((pageContext.initialContractorName === pageContext.contractorName) && (pageContext.initialContractorDescription === pageContext.contractorDescription) && (pageContext.initialContractorContactName === pageContext.contractorContactName) && (pageContext.initialContractorContactTitle === pageContext.contractorContactTitle) && (pageContext.initialContractorContactEmail === pageContext.contractorContactEmail) && (pageContext.contactPhoneIsValid === false || (pageContext.initialContractorContactPhone === pageContext.contractorContactPhone)) && (pageContext.initialContractorAddress === pageContext.contractorAddress) && (typeof pageContext.addressObj !== 'undefined' && pageContext.addressObj.city !== '') && (pageContext.initialAddressObjCity === pageContext.addressObj.city) && (typeof pageContext.addressObj !== 'undefined' ) && (pageContext.initialAddressObjState === pageContext.addressObj.state) && (typeof pageContext.addressObj !== 'undefined' && pageContext.addressObj.country !== '') && (pageContext.initialAddressObjCountry === pageContext.addressObj.country) && (typeof pageContext.addressObj !== 'undefined' && pageContext.addressObj.zipCode !== '') && (pageContext.initialAddressObjZipCode === pageContext.addressObj.zipCode)) || (pageContext.contractorName === '') || (pageContext.contractorContactName === '') || (pageContext.contractorContactTitle === '') || (pageContext.contractorContactEmail === '') || (pageContext.contractorContactPhone === '') || (pageContext.contractorAddress === ''))) { return true } else { return false } }"},"header":{"children":[{"buttonType":"primary","hidden":"@jslib.isSave&ContinueHidden","actionOnClick":["@actions.setSubActionUpsertContractor","@actions.fireProcessEvent","@actions.setActionEdit","@actions.initialData","@actions.processApiOutput","@actions.refreshDataGrid"],"disabled":"@jslib.isSaveContinueDisabled","id":"saveAndContinue","type":"button","title":"@lang.['sc1','Save & Continue']"},{"buttonType":"primary","hidden":"@jslib.showContractorDetails","actionOnClick":["@actions.setSubActionUpsertContractor","@actions.fireProcessEvent","@actions.refreshDataGrid","@actions.closePanel"],"disabled":"@jslib.isSaveDisabled","id":"submit","type":"button","title":"@lang.['s12','Save']"},{"icon":"@iconlib.NavigationCloseGrey","actionOnClick":["@actions.closePanel","@actions.clearPageContext"],"id":"Close","type":"buttonIcon"}],"title":"@jslib.dynamicHeaderText"},"body":{"children":[{"children":[{"children":[{"children":[{"isRequired":true,"inputType":"text","id":"contractorCompany","label":"@lang.['cc','Contractor Company']","placeholder":"@lang.['ecn1','Enter company name']","type":"input","value":"@pageContext.contractorName"},{"id":"description","label":"@lang.['d7','Description (Optional)']","type":"textarea","value":"@pageContext.contractorDescription","placeHolder":"@lang.['ecd1','Enter company description']"}],"id":"generalInformation","label":"@lang.['gi','General Information']","type":"section"},{"children":[{"isRequired":true,"inputType":"text","id":"contactName","label":"@lang.['cn1','Contact Name']","placeholder":"@lang.['ecn2','Enter contact name']","type":"input","value":"@pageContext.contractorContactName"},{"inputType":"text","id":"contactTitle","label":"@lang.['ct3','Contact Title']","placeholder":"@lang.['ectojd','Enter contact title or job description']","type":"input","value":"@pageContext.contractorContactTitle"},{"isRequired":true,"inputType":"email","id":"contactEmail","label":"@lang.['ce','Contact Email']","placeholder":"@lang.['ecea','Enter contact email address']","type":"input","value":"@pageContext.contractorContactEmail"},{"isRequired":true,"id":"contactPhone","label":"@lang.['cp','Contact Phone']","type":"phoneNumber","value":"@pageContext.contractorContactPhone"}],"id":"contactInformation","label":"@lang.['ci4','Contact Information']","type":"section"},{"children":[{"isRequired":true,"id":"address","label":"@lang.['address','Address']","placeholder":"@lang.['eca1','Enter contact address']","type":"address","value":"@pageContext.contractorAddress"},{"isRequired":true,"disabled":"@jslib.isAddressPopulated","id":"city","label":"@lang.['c','City']","placeholder":"@lang.['cibosa','City is based on selected address']","type":"input","value":"@pageContext.addressObj.city"},{"disabled":"@jslib.isAddressPopulated","id":"state","label":"@lang.['s30','State (Optional)']","placeholder":"@lang.['sibosa','State is based on selected address']","type":"input","value":"@pageContext.addressObj.state"},{"isRequired":true,"disabled":"@jslib.isAddressPopulated","id":"postalCode","label":"@lang.['pc','Postal Code']","placeholder":"@lang.['pcibosa','Postal code is based on selected address']","type":"input","value":"@pageContext.addressObj.zipCode"},{"isRequired":true,"disabled":"@jslib.isAddressPopulated","id":"country","label":"@lang.['c1','Country']","placeholder":"@lang.['cibosa1','Country is based on selected address']","type":"input","value":"@pageContext.addressObj.country"}],"id":"contactInformation","label":"@lang.['li','Location Information']","type":"section"}],"label":"@lang.['ci5','Contractor Information']","type":"tab"},{"hidden":"@jslib.hideRegions","children":[{"children":[{"id":"regionSkillDataGrid","type":"dataGrid","jsonDef":{"isScrollAble":true,"searchAllowed":true,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsBinPurple","name":"@lang.['d2','delete']","icon":"@iconlib.ActionsBinGrey","tooltip":"@lang.['d1','Delete']","actionOnClick":["@actions.setSubActionDeleteContractorRegion","@actions.fireProcessEvent","@actions.refreshRegionDataGrid"],"type":"buttonIcon"}]},"modifyRowActions":[],"gridRefreshId":"regionSkillDataGrid","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"tableHeader":[{"name":"@lang.['r1','Region']","options":{"sortable":true,"showLabel":true},"key":"regionName"},{"name":"@lang.['s15','Subregion']","options":{"sortable":true,"showLabel":true},"key":"subRegionName"}],"dataToBeSent":{"filter":"{$regionId}={$contractorRegionRegionId} and  {$contractorRegionContractorId}={@selectedContractorId}","models":["region","subRegion","contractorRegion"],"columns":{"contractorRegionSubRegionId":"contractorRegion.subRegionId","contractorRegionRecver":"contractorRegion.recver","regionId":"region.id","contractorRegionCreatedDate":"contractorRegion.createdDate","regionName":"region.name","contractorRegionRegionId":"contractorRegion.regionId","contractorRegionId":"contractorRegion.id","subRegionId":"subRegion.id","subRegionName":"subRegion.name","contractorRegionContractorId":"contractorRegion.contractorId"},"inputs":{"selectedContractorId":"@pageContext.contractorId"},"outerJoinOnModel":"contractorRegion","orderBy":"regionName ASC","links":{"subRegion":"contractorRegion","region":"contractorRegion"}},"actionOnLoad":[],"dataSourceId":"query/read","header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['navR','Regions']","children":[{"buttonType":"primary","actionOnClick":["@actions.clearNestedSidePanelData","@actions.openNestedSidePanel"],"id":"addNew","type":"button","title":"@lang.['addNew','Add New']"}]},"isSelectable":false,"actions":[{"name":"closePanel","type":"closePanel"},{"name":"setSubActionDeleteContractorRegion","type":"script","actionDef":"function(pageContext){pageContext.subAction='deleteContractorRegion';}"},{"name":"clearPageContext","type":"clearPageContext"},{"name":"clearNestedSidePanelData","type":"script","actionDef":"function(pageContext){pageContext.regionId='';pageContext.subRegionId='';}"},{"name":"openNestedSidePanel","type":"openPanel","pageId":"5PQ4C37P28"},{"endPoint":"event/start","name":"fireProcessEvent","outputVarMap":{"data":"@pageContext.data"},"type":"api","actionDef":{"data":[{"eventId":"workforceContractorProcessEvent","contextVar":{"contractor":{"country":"@pageContext.addressObj.country","address":"@pageContext.contractorAddress","city":"@pageContext.addressObj.city","contactEmail":"@pageContext.contractorContactEmail","contactName":"@pageContext.contractorContactName","postalCode":"@pageContext.addressObj.zipCode","description":"@pageContext.contractorDescription","contactTitle":"@pageContext.contractorContactTitle","recver":"@pageContext.contractorRecver","name":"@pageContext.contractorName","state":"@pageContext.addressObj.state","id":"@pageContext.contractorId","contactPhone":"@pageContext.contractorContactPhone"},"contractorRegion":{"recver":"@pageContext.contractorRegionRecver","id":"@pageContext.contractorRegionId"},"subAction":"@pageContext.subAction"}}]}},{"name":"refreshRegionDataGrid","gridId":["regionSkillDataGrid"],"type":"RefreshGridOnSidePanel"}],"searchKeys":["regionName","subRegionName"]}}],"label":"@lang.['s16','Search']","id":"regionSection","type":"section","transparent":true}],"label":"@lang.['navR','Regions']","type":"tab"},{"hidden":"@jslib.showTechnicians","children":[{"children":[{"id":"assignedTechnicians","type":"dataGrid","jsonDef":{"isScrollAble":true,"searchAllowed":true,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{},"modifyRowActions":[],"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"tableHeader":[{"name":"@lang.['n','Name']","options":{"flex":1,"sortable":true,"showLabel":true},"key":"userName"},{"name":"@lang.['c','City']","options":{"flex":1,"sortable":true,"showLabel":true},"key":"workforceCity"},{"name":"@lang.['pn','Phone Number']","options":{"flex":1,"showLabel":true},"key":"userPhoneNumber"},{"name":"@lang.['s','Status']","options":{"flex":1,"sortable":true,"showLabel":true},"key":"userStatus"}],"dataToBeSent":{"filter":"{$contractorRegionContractorId} = {@selectedContractorId} ","models":["contractorWorkforce","contractorRegion","Workforce","User","ZStatus"],"columns":{"workforceCity":"Workforce.city","userStatus":"ZStatus.name","userPhoneNumber":"User.phoneNumber","userName":"User.name","userId":"User.id","contractorRegionContractorId":"contractorRegion.contractorId"},"inputs":{"selectedContractorId":"@pageContext.contractorId"},"distinct":true,"links":{"contractorRegion":"contractorWorkforce","contractorWorkforce":"User","workforce":"contractorWorkforce","ZStatus":"workforce"},"batchSize":50,"getCount":true,"batchNumber":1},"actionOnLoad":[],"dataSourceId":"query/read","header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['at','Assigned Technicians']","children":[]},"isSelectable":false,"actions":[],"searchKeys":["userName","workforceCity","userPhoneNumber","userStatus"]}}],"label":"@lang.['s16','Search']","id":"technicinSection ","type":"section","transparent":true}],"label":"@lang.['navT','Technicians']","type":"tab"}],"label":"","type":"tab"}]},"actions":[{"name":"initialData","type":"script","actionDef":"function(pageContext){if(pageContext.contractorAction==='edit'){if (pageContext.contractorCity !== undefined && pageContext.contractorState !== undefined && pageContext.contractorCountry !== undefined && pageContext.contractorPostalCode !== undefined) { pageContext.addressObj = {}; pageContext.addressObj.city = pageContext.contractorCity; pageContext.addressObj.state = pageContext.contractorState; pageContext.addressObj.country = pageContext.contractorCountry; pageContext.addressObj.zipCode = pageContext.contractorPostalCode; }pageContext.initialContractorName=pageContext.contractorName;pageContext.initialContractorDescription=pageContext.contractorDescription;pageContext.initialContractorContactName=pageContext.contractorContactName;pageContext.initialContractorContactTitle=pageContext.contractorContactTitle;pageContext.initialContractorContactEmail=pageContext.contractorContactEmail;pageContext.initialContractorContactPhone=pageContext.contractorContactPhone;pageContext.initialContractorAddress=pageContext.contractorAddress;pageContext.initialAddressObjCity=pageContext.addressObj.city;pageContext.initialAddressObjState=pageContext.addressObj.state;pageContext.initialAddressObjCountry=pageContext.addressObj.country;pageContext.initialAddressObjZipCode=pageContext.addressObj.zipCode}else if(pageContext.contractorAction==='add'){pageContext.contractorName='';pageContext.contractorContactName='';pageContext.contractorContactTitle='';pageContext.contractorContactEmail='';pageContext.contractorContactPhone='';pageContext.contractorAddress=''}if(typeof pageContext.contractorAdded==='undefined'){pageContext.contractorAdded=false}}"},{"name":"closePanel","type":"closePanel"},{"name":"clearPageContext","type":"clearPageContext"},{"name":"openNestedSidePanel","type":"openPanel","pageId":"5PQ4C37P28"},{"name":"setSubActionUpsertContractor","type":"script","actionDef":"function(pageContext){pageContext.subAction='upsertContractor'}"},{"endPoint":"event/start","name":"fireProcessEvent","outputVarMap":{"data":"@pageContext.data"},"type":"api","actionDef":{"data":[{"eventId":"workforceContractorProcessEvent","contextVar":{"contractor":{"country":"@pageContext.addressObj.country","address":"@pageContext.contractorAddress","city":"@pageContext.addressObj.city","contactEmail":"@pageContext.contractorContactEmail","contactName":"@pageContext.contractorContactName","postalCode":"@pageContext.addressObj.zipCode","description":"@pageContext.contractorDescription","contactTitle":"@pageContext.contractorContactTitle","recver":"@pageContext.contractorRecver","name":"@pageContext.contractorName","state":"@pageContext.addressObj.state","id":"@pageContext.contractorId","contactPhone":"@pageContext.contractorContactPhone"},"contractorRegion":{"recver":"@pageContext.contractorRegionRecver","id":"@pageContext.contractorRegionId"},"subAction":"@pageContext.subAction"}}]}},{"name":"closeModal","type":"closeModal"},{"name":"refreshDataGrid","type":"refreshDataGrid"},{"name":"setActionEdit","type":"script","actionDef":"function(pageContext){pageContext.contractorAction='edit';}"},{"name":"setInitialDataSaveAndContinue","type":"script","actionDef":"function(pageContext){pageContext.initialAddressObjCity=pageContext.addressObj.city;pageContext.initialAddressObjState=pageContext.addressObj.state;pageContext.initialAddressObjCountry=pageContext.addressObj.country;pageContext.initialAddressObjZipCode=pageContext.addressObj.zipCode;pageContext.initialContractorName=pageContext.contractorName;pageContext.initialContractorContactName=pageContext.contractorContactName; pageContext.initialContractorContactTitle=pageContext.contractorContactTitle; pageContext.initialContractorContactEmail=pageContext.contractorContactEmail; pageContext.initialContractorContactPhone=pageContext.contractorContactPhone; pageContext.initialContractorAddress=pageContext.contractorAddress;}"},{"name":"processApiOutput","type":"script","actionDef":"function(pageContext){pageContext.contractorAdded= true;pageContext.contractorId=pageContext.data[0].data[0].contractorId;}"}]}