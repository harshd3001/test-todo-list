{"parseContextVar":{"connectors":[{"exitPortType":"NextStep","nodeId":"decisionInputData"}],"contextChangePermitted":true,"name":"parseContextVar","description":"parseContextVar","processRule":"{contextVar.initialContext='woId = '+contextVar.woId+' , taskId = '+ contextVar.taskId +' ,custId = '+ contextVar.custId +' ,siteId = '+ contextVar.siteId +' ,closeCode = '+ contextVar.closeCode;contextVar.payload={'custId': contextVar.custId,'siteId': contextVar.siteId};contextVar.defStatus='0';contextVar.defWOStatus='0';contextVar.requestedDate=contextVar.plannedDate;contextVar.promisedDate=contextVar.plannedDate;contextVar.woPriority=contextVar.tPriority;contextVar.taskPriority=contextVar.tPriority;}","nodeType":"PROCESS"},"decisionQueryData1":{"connectors":[{"exitPortType":"TrueStep","nodeId":"FetchHEATCustSiteDetails"},{"exitPortType":"FalseStep","nodeId":"processErrorCodes1"}],"name":"decisionQueryData1","description":"decisionQueryData1","processRule":"(typeof contextVar.TimeFrameQuery[0] !== 'undefined' && typeof contextVar.TimeFrameQuery[0]['id'] !== 'undefined')","nodeType":"DECISION"},"subRegionQuery":{"filter":"{$name}={@subRegionName}","models":["subRegion"],"connectors":[{"exitPortType":"NextStep","nodeId":"SLAQuery"}],"contextChangePermitted":true,"columns":{"recver":"recver","name":"name","id":"id"},"name":"subRegionQuery","description":"subRegionQuery","inputVarMap":{"subRegion":"subRegionName"},"id":"subRegionQuery","outputVarMap":{"data":"subRegionQuery"},"nodeType":"QUERY"},"insertCustomerDetails":{"modelName":"customer","connectors":[{"exitPortType":"NextStep","nodeId":"processCustomerData1"}],"contextChangePermitted":true,"name":"insertCustomerDetails","description":"insertCustomerDetails","inputVarMap":{"dummyEmail":"contactEmail","dummyContactTitle":"contactTitle","dummyLatitude":"latitude","dummyBillingAddress":"billingAddress","dummyLongitude":"longitude","custId":"name","dummyContactType":"contactType","dummyContactPhone":"contactPhone","dummyContactName":"contactName","custName":"companyName"},"outputVarMap":{"id":"zinierCustId"},"nodeType":"MODEL","operation":1},"processPriorityWOTQueryData":{"connectors":[{"exitPortType":"NextStep","nodeId":"StatusTaskQuery"}],"contextChangePermitted":true,"name":"processPriorityWOTQueryData","description":"processPriorityWOTQueryData","processRule":"{contextVar.wotPriorityNo = contextVar.PriorityWOTQuery[0].priority;}","nodeType":"PROCESS"},"StatusTaskQuery":{"filter":"{$name}={@taskStatus} AND {$ZStatus.targetModel}={@taskTargetModel}","models":["ZStatus"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionStatusTaskQueryData"}],"contextChangePermitted":true,"columns":{"recver":"ZStatus.recver","name":"ZStatus.name","id":"ZStatus.id"},"name":"StatusTaskQuery","description":"StatusTaskQuery","inputVarMap":{"defaultwotStatus":"taskStatus","zinierWOTtargetModel":"taskTargetModel"},"id":"StatusTaskQuery","outputVarMap":{"data":"StatusTaskQuery"},"nodeType":"QUERY"},"decisionWODetails":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processWOData"},{"exitPortType":"FalseStep","nodeId":"insertWODetails"}],"name":"decisionWODetails","description":"decisionWODetails","processRule":"(typeof contextVar.WOQuery !== 'undefined' && typeof contextVar.WOQuery[0] !== 'undefined' && typeof contextVar.WOQuery[0]['id'] !== 'undefined')","nodeType":"DECISION"},"CustomerSiteQuery":{"filter":"{$name}={@siteName} AND {$site.customerId}={@customerId}","models":["site"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionCustomerSiteDetails"}],"columns":{"recver":"recver","name":"name","id":"id"},"name":"CustomerSiteQuery","description":"CustomerSiteQuery","inputVarMap":{"siteId":"siteName","zinierCustomerId":"customerId"},"id":"CustomerSiteQuery","outputVarMap":{"data":"CustomerSiteQuery"},"nodeType":"QUERY"},"decisionWOTDetails":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processErrorCodes3"},{"exitPortType":"FalseStep","nodeId":"processWOTData"}],"name":"decisionWOTDetails","description":"decisionWOTDetails","processRule":"(typeof contextVar.TaskQuery !== 'undefined' && typeof contextVar.TaskQuery[0] !== 'undefined' && typeof contextVar.TaskQuery[0]['id'] !== 'undefined')","nodeType":"DECISION"},"insertWODetails":{"modelName":"workOrder","connectors":[{"exitPortType":"NextStep","nodeId":"processWOData1"}],"name":"insertWODetails","description":"insertWODetails","inputVarMap":{"zinierWODesc":"notes","zinierWOType":"workOrderTypeId","woId":"id","zinierContractId":"contractId","zinierModelName":"modelName","defaultstatusIdFK":"statusId","zinierCalendarId":"calenderId","zinierWOtargetModelFK":"statusTargetModel","zinierSlaId":"slaId","woPriority":"priorityName","zinierWOtargetModel":"priorityTargetModel","priorityNo":"priorityPriority","isTemplate":"isTemplate","woStatus":"statusId","requestedDate":"requestedDate","zinierCustomerId":"customerId"},"outputVarMap":{"id":"zinierWorkOrderInsertId"},"nodeType":"MODEL","operation":1},"decisionCustSiteDetails":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processAPIData"},{"exitPortType":"FalseStep","nodeId":"processErrorCodes2"}],"name":"decisionCustSiteDetails","description":"decisionCustSiteDetails","processRule":"(contextVar.FetchHEATCustSiteDetails !== '' && contextVar.FetchHEATCustSiteDetails[0].Code !== 0 && typeof contextVar.FetchHEATCustSiteDetails[0] !== 'undefined' && typeof contextVar.FetchHEATCustSiteDetails[0]['output'] !== 'undefined'  && typeof contextVar.FetchHEATCustSiteDetails[0]['output']['Items'] !== 'undefined' && contextVar.FetchHEATCustSiteDetails[0]['output']['Items'].length >= 7 && contextVar.FetchHEATCustSiteDetails[0]['responseCode'] == '200')","nodeType":"DECISION"},"processAPIData":{"connectors":[{"exitPortType":"NextStep","nodeId":"CustomerQuery"}],"contextChangePermitted":true,"name":"processAPIData","description":"processAPIData","processRule":"{var custSiteDetails=contextVar.FetchHEATCustSiteDetails[0]['output']['Items']; for(var i=0;i<custSiteDetails.length;i++){ contextVar[custSiteDetails[i]['Key']] = custSiteDetails[i]['Value']; }}","nodeType":"PROCESS"},"decisionStatusQueryData":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processStatusData"},{"exitPortType":"FalseStep","nodeId":"processErrorCodes7"}],"name":"decisionStatusQueryData","description":"decisionStatusQueryData","processRule":"(typeof contextVar.StatusQuery[0] !== 'undefined' && typeof contextVar.StatusQuery[0]['id'] !== 'undefined') ","nodeType":"DECISION"},"insertWOTDetails":{"modelName":"workOrderTask","connectors":[{"exitPortType":"NextStep","nodeId":"processErrorCodes4"}],"name":"insertWOTDetails","description":"insertWOTDetails","inputVarMap":{"zinierWorkOrderId":"workOrderId","plannedDate":"scheduledDate","isTemplate":"isTemplate","taskDescription":"notes","estimatedTaskDuration":"estimatedDuration","zinierTaskTypeId":"taskTypeId","zinierSiteId":"siteId","defaultwotStatusId":"statusId","zinierWOTtargetModel":"priorityTargetModel","taskStatusTargetModelFK":"statusTargetModel","taskId":"id"},"outputVarMap":{"id":"zinierTaskId"},"nodeType":"MODEL","operation":1},"workflowNodes":["start","parseContextVar","decisionInputData","PriorityQuery","decisionPriorityQueryData","processPriorityQueryData","PriorityWOTQuery","decisionPriorityWOTQueryData","processPriorityWOTQueryData","StatusTaskQuery","decisionStatusTaskQueryData","processTaskStatusData","StatusQuery","decisionStatusQueryData","processStatusData","WOTypeQuery","TaskTypeQuery","RegionQuery","subRegionQuery","SLAQuery","EscalationQuery","decisionQueryData","processSLAData","TimeFrameQuery","decisionQueryData1","FetchHEATCustSiteDetails","decisionCustSiteDetails","processAPIData","CustomerQuery","decisionCustDetails","insertCustomerDetails","processCustomerData","processCustomerData1","processCustomerData2","ContractQuery","decisionContractQuery","processContractData1","CustomerSiteQuery","decisionCustomerSiteDetails","insertCustomerSiteDetails","processSiteData","processSiteData1","processWOData","processWOData1","WOQuery","decisionWODetails","insertWODetails","TaskQuery","decisionWOTDetails","processWOTData","insertWOTDetails","processErrorCodes","processErrorCodes1","processErrorCodes2","processErrorCodes3","processErrorCodes4","processErrorCodes5","processErrorCodes6","processErrorCodes7","insertResponseDetailsToDB","end"],"decisionCustomerSiteDetails":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processSiteData"},{"exitPortType":"FalseStep","nodeId":"insertCustomerSiteDetails"}],"name":"decisionCustomerSiteDetails","description":"decisionCustomerSiteDetails","processRule":"(contextVar.CustomerSiteQuery !== '' && typeof contextVar.CustomerSiteQuery !== 'undefined' && typeof contextVar.CustomerSiteQuery[0] !== 'undefined' && typeof contextVar.CustomerSiteQuery[0]['id'] !== 'undefined')","nodeType":"DECISION"},"processWOData1":{"connectors":[{"exitPortType":"NextStep","nodeId":"TaskQuery"}],"contextChangePermitted":true,"name":"processWOData","description":"processWOData","processRule":"{contextVar.zinierWorkOrderId = contextVar.zinierWorkOrderInsertId; }","nodeType":"PROCESS"},"EscalationQuery":{"filter":"{$name}={@escName}","models":["escalationHierarchies"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionQueryData"}],"contextChangePermitted":true,"columns":{"recver":"escalationHierarchies.recver","name":"escalationHierarchies.name","id":"escalationHierarchies.id"},"name":"EscalationQuery","description":"EscalationQuery","inputVarMap":{"platform":"escName"},"id":"EscalationQuery","outputVarMap":{"data":"EscalationQuery"},"nodeType":"QUERY"},"WOTypeQuery":{"filter":"{$name}={@workOrderType}","models":["workOrderType"],"connectors":[{"exitPortType":"NextStep","nodeId":"TaskTypeQuery"}],"contextChangePermitted":true,"columns":{"recver":"recver","name":"name","id":"id"},"name":"WOTypeQuery","description":"WOTypeQuery","inputVarMap":{"woType":"workOrderType"},"id":"WOTypeQuery","outputVarMap":{"data":"WOTypeQuery"},"nodeType":"QUERY"},"FetchHEATCustSiteDetails":{"connectors":[{"exitPortType":"NextStep","nodeId":"decisionCustSiteDetails"}],"name":"FetchHEATCustSiteDetails","description":"","networkId":"16DD943AA5657F70","inputVarMap":{"payload":"payload"},"id":"FetchHEATCustSiteDetails","outputVarMap":{"data":"FetchHEATCustSiteDetails","responseCode":"responseCode"},"nodeType":"NETWORK","continueOnError":true},"processTaskStatusData":{"connectors":[{"exitPortType":"NextStep","nodeId":"StatusQuery"}],"contextChangePermitted":true,"name":"processTaskStatusData","description":"processTaskStatusData","processRule":"{contextVar.statusIdFKPhase = contextVar.StatusTaskQuery[0].id;}","nodeType":"PROCESS"},"processCustomerData":{"connectors":[{"exitPortType":"NextStep","nodeId":"processCustomerData2"}],"contextChangePermitted":true,"name":"processCustomerData","description":"processCustomerData","processRule":"{contextVar.zinierCustomerId = contextVar.CustomerQuery[0].id;}","nodeType":"PROCESS"},"PriorityWOTQuery":{"filter":"{$name}={@taskPrt} AND {$ZPriority.targetModel} = 'workOrder'","models":["ZPriority"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionPriorityWOTQueryData"}],"contextChangePermitted":true,"columns":{"recver":"ZPriority.recver","name":"ZPriority.name","priority":"ZPriority.priority"},"name":"PriorityWOTQuery","description":"PriorityWOTQuery","inputVarMap":{"tPriority":"taskPrt"},"id":"PriorityWOTQuery","outputVarMap":{"data":"PriorityWOTQuery"},"nodeType":"QUERY"},"processSiteData1":{"connectors":[{"exitPortType":"NextStep","nodeId":"WOQuery"}],"contextChangePermitted":true,"name":"processSiteData","description":"processSiteData","processRule":"{contextVar.zinierSiteId = contextVar.zinierInsertSiteId;}","nodeType":"PROCESS"},"processSLAData":{"connectors":[{"exitPortType":"NextStep","nodeId":"TimeFrameQuery"}],"contextChangePermitted":true,"name":"processSLAData","description":"processSLAData","processRule":"{contextVar.zinierSlaId = contextVar.SLAQuery[0].id; }","nodeType":"PROCESS"},"decisionPriorityWOTQueryData":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processPriorityWOTQueryData"},{"exitPortType":"FalseStep","nodeId":"processErrorCodes6"}],"name":"decisionPriorityWOTQueryData","description":"decisionPriorityWOTQueryData","processRule":"(typeof contextVar.PriorityWOTQuery[0] !== 'undefined' && typeof contextVar.PriorityWOTQuery[0]['priority'] !== 'undefined') ","nodeType":"DECISION"},"RegionQuery":{"filter":"{$name}={@regionName}","models":["region"],"connectors":[{"exitPortType":"NextStep","nodeId":"subRegionQuery"}],"contextChangePermitted":true,"columns":{"recver":"recver","name":"name","id":"id"},"name":"RegionQuery","description":"RegionQuery","inputVarMap":{"region":"regionName"},"id":"RegionQuery","outputVarMap":{"data":"RegionQuery"},"nodeType":"QUERY"},"processContractData1":{"connectors":[{"exitPortType":"NextStep","nodeId":"CustomerSiteQuery"}],"contextChangePermitted":true,"name":"processContractData1","description":"processContractData1","processRule":"{contextVar.zinierContractId = contextVar.ContractQuery[0].id;}","nodeType":"PROCESS"},"decisionInputData":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processErrorCodes"},{"exitPortType":"FalseStep","nodeId":"PriorityQuery"}],"name":"decisionInputData","description":"decisionInputData","processRule":"( (typeof contextVar.woId === 'undefined') || (typeof contextVar.taskId === 'undefined') || (typeof contextVar.woType === 'undefined') || (typeof contextVar.taskType === 'undefined') || (typeof contextVar.siteId === 'undefined') || (typeof contextVar.custId === 'undefined') || (typeof contextVar.region === 'undefined') || (typeof contextVar.subRegion === 'undefined') )","nodeType":"DECISION"},"StatusQuery":{"filter":"{$name}={@workOrderStatus} AND {$ZStatus.targetModel}={@woTargetModel}","models":["ZStatus"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionStatusQueryData"}],"contextChangePermitted":true,"columns":{"recver":"ZStatus.recver","name":"ZStatus.name","id":"ZStatus.id"},"name":"StatusQuery","description":"StatusQuery","inputVarMap":{"woStatus":"workOrderStatus","zinierWOtargetModel":"woTargetModel"},"id":"StatusQuery","outputVarMap":{"data":"StatusQuery"},"nodeType":"QUERY"},"processWOData":{"connectors":[{"exitPortType":"NextStep","nodeId":"TaskQuery"}],"contextChangePermitted":true,"name":"processWOData","description":"processWOData","processRule":"{contextVar.zinierWorkOrderId = contextVar.WOQuery[0].id; }","nodeType":"PROCESS"},"processErrorCodes2":{"connectors":[{"exitPortType":"NextStep","nodeId":"insertResponseDetailsToDB"}],"contextChangePermitted":true,"name":"processErrorCodes2","description":"processErrorCodes2","processRule":"{contextVar['responseData'] = { 'responseCode': '410', 'message': 'Call to Customer Site Failed. Either there is a network breakdown or there is insufficient data fields in the API call' }; contextVar.code=contextVar['responseData'].responseCode;contextVar.message=contextVar['responseData'].message;}","nodeType":"PROCESS"},"processErrorCodes1":{"connectors":[{"exitPortType":"NextStep","nodeId":"insertResponseDetailsToDB"}],"contextChangePermitted":true,"name":"processErrorCodes1","description":"processErrorCodes1","processRule":"{function updatePresence(data, name) { if(typeof data[0] !== 'undefined' && typeof data[0]['id'] !== 'undefined') { contextVar.presenceOfData['Available'] = contextVar.presenceOfData['Available'] + name + ','; } else { contextVar.presenceOfData['NotAvailable'] = contextVar.presenceOfData['NotAvailable'] + name + ',' ; } } updatePresence(contextVar.SLAQuery, 'SLA'); updatePresence(contextVar.EscalationQuery, 'Escalation'); updatePresence(contextVar.WOTypeQuery, 'Work Order Type'); updatePresence(contextVar.TaskTypeQuery, 'Task Type'); updatePresence(contextVar.RegionQuery, 'Region'); updatePresence(contextVar.subRegionQuery, 'Sub Region'); contextVar['responseData'] = { 'responseCode': '320', 'message': 'Some data is missing in Zinier platform. Data which is not available is/are the following: '+ contextVar.presenceOfData['NotAvailable'] }; contextVar.code = contextVar['responseData'].responseCode; contextVar.message = contextVar['responseData'].message;}","nodeType":"PROCESS"},"SLAQuery":{"filter":"{$name}={@SLAName}","models":["sla"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionQueryData"}],"contextChangePermitted":true,"columns":{"recver":"recver","name":"name","id":"id"},"name":"SLAQuery","description":"SLAQuery","inputVarMap":{"platform":"SLAName"},"id":"SLAQuery","outputVarMap":{"data":"SLAQuery"},"nodeType":"QUERY"},"processErrorCodes4":{"connectors":[{"exitPortType":"NextStep","nodeId":"insertResponseDetailsToDB"}],"contextChangePermitted":true,"name":"processErrorCodes4","description":"processErrorCodes4","processRule":"{contextVar['responseData'] = { 'responseCode': '201', 'message': 'Task created successfully' }; contextVar.code=contextVar['responseData'].responseCode;contextVar.message=contextVar['responseData'].message;}","nodeType":"PROCESS"},"processPriorityQueryData":{"connectors":[{"exitPortType":"NextStep","nodeId":"PriorityWOTQuery"}],"contextChangePermitted":true,"name":"processPriorityQueryData","description":"processPriorityQueryData","processRule":"{contextVar.priorityNo = contextVar.PriorityQuery[0].priority;}","nodeType":"PROCESS"},"processErrorCodes3":{"connectors":[{"exitPortType":"NextStep","nodeId":"insertResponseDetailsToDB"}],"contextChangePermitted":true,"name":"processErrorCodes3","description":"processErrorCodes3","processRule":"{contextVar['responseData'] = { 'responseCode': '201', 'message': 'Task and workorder details already present' }; contextVar.code=contextVar['responseData'].responseCode;contextVar.message=contextVar['responseData'].message;}","nodeType":"PROCESS"},"workflowContext":{"dummyEmail":"NA@NA.NA","dummyContactTitle":"Not Specified","zinierModelName":"workOrder","dummyLongitude":"99.1332","responseData":{},"defaultwotStatusId":"workOrderTaskOpen","dummyContactName":"Not Specified","zinierWOTtargetModel":"workOrderTask","zinierWOtargetModelFK":"workOrder","taskStatusTargetModelFK":"workOrderTask","zinierWOtargetModel":"workOrder","platform":"Default","insertRecver":"0","defaultColorCode":"#4e4949","autoScheduleAndDispatch":"None","statusIdFKPhase":"16B40B8F031B260F","deployable":true,"dummyLatitude":"19.4326","taskIcon":"https://cdn.zeplin.io/5bb333d8df91625b34b139a2/assets/559D5B7E-D87C-4C87-982C-9D9D6AC953CC.svg","woStatus":"Open","dummyContactPhone":"","taskDependencyType":"","escLevel":"1","slaModel":"SLAs","dummySiteType":"Customer Site","wotDeployTaskWorkOrderStatus":"Not Assigned","zinierWOTtargetModelFK":"workOrderTask","defaultPriority":"1","dummyBillingAddress":"Not Specified","defaultstatusIdFK":"16B4B4CC99489A36","zinierCalendarId":"16DEFA1AE6EEB3D5","na":"NA","isTemplate":"false","defaultwotStatus":"Open","presenceOfData":{"NotAvailable":"","Available":""},"dummyContactType":"Not Specified","taskDependency":"None","asset":""},"TaskQuery":{"filter":"{$taskId}={@inputTaskId}","models":["workOrderTask"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionWOTDetails"}],"columns":{"recver":"workOrderTask.recver","id":"workOrderTask.id","taskId":"workOrderTask.id"},"name":"TaskQuery","description":"TaskQuery","inputVarMap":{"zinierTaskTypeId":"taskTypeId","taskId":"inputTaskId"},"id":"TaskQuery","outputVarMap":{"data":"TaskQuery"},"nodeType":"QUERY"},"TaskTypeQuery":{"filter":"{$name}={@taskType}","models":["taskType"],"connectors":[{"exitPortType":"NextStep","nodeId":"RegionQuery"}],"contextChangePermitted":true,"columns":{"recver":"recver","name":"name","id":"id"},"name":"TaskTypeQuery","description":"TaskTypeQuery","inputVarMap":{"taskType":"taskType"},"id":"TaskTypeQuery","outputVarMap":{"data":"TaskTypeQuery"},"nodeType":"QUERY"},"end":{"name":"End","description":"End","processRule":"","inputVarMap":{"responseData":"responseData"},"outputVarMap":{"responseData":"responseData"},"nodeType":"END"},"processErrorCodes6":{"connectors":[{"exitPortType":"NextStep","nodeId":"insertResponseDetailsToDB"}],"contextChangePermitted":true,"name":"processErrorCodes6","description":"processErrorCodes6","processRule":"{contextVar['responseData'] = { 'responseCode': '320', 'message': 'Priority data is missing in zinier platform for workorder or task.' }; contextVar.code=contextVar['responseData'].responseCode;contextVar.message=contextVar['responseData'].message;}","nodeType":"PROCESS"},"decisionStatusTaskQueryData":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processTaskStatusData"},{"exitPortType":"FalseStep","nodeId":"processErrorCodes7"}],"name":"decisionStatusTaskQueryData","description":"decisionStatusTaskQueryData","processRule":"(typeof contextVar.StatusTaskQuery[0] !== 'undefined' && typeof contextVar.StatusTaskQuery[0]['id'] !== 'undefined') ","nodeType":"DECISION"},"processErrorCodes5":{"connectors":[{"exitPortType":"NextStep","nodeId":"insertResponseDetailsToDB"}],"contextChangePermitted":true,"name":"processErrorCodes5","description":"processErrorCodes5","processRule":"{contextVar['responseData'] = { 'responseCode': '320', 'message': 'Contract is missing. Please add a contract type and associate it with an approval workflow and create contract with the name HEAT to save the details' }; contextVar.code=contextVar['responseData'].responseCode;contextVar.message=contextVar['responseData'].message;}","nodeType":"PROCESS"},"processErrorCodes7":{"connectors":[{"exitPortType":"NextStep","nodeId":"insertResponseDetailsToDB"}],"contextChangePermitted":true,"name":"processErrorCodes7","description":"processErrorCodes7","processRule":"{contextVar['responseData'] = { 'responseCode': '320', 'message': 'Status data is missing in zinier platform for workorder or task.' }; contextVar.code=contextVar['responseData'].responseCode;contextVar.message=contextVar['responseData'].message;}","nodeType":"PROCESS"},"decisionCustDetails":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processCustomerData"},{"exitPortType":"FalseStep","nodeId":"insertCustomerDetails"}],"name":"decisionCustDetails","description":"decisionCustDetails","processRule":"(typeof contextVar.CustomerQuery  !== 'undefined' && typeof contextVar.CustomerQuery[0] !== 'undefined' && typeof contextVar.CustomerQuery[0]['id'] !== 'undefined')","nodeType":"DECISION"},"PriorityQuery":{"filter":"{$name}={@taskPrt} AND {$ZPriority.targetModel} = 'workOrder'","models":["ZPriority"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionPriorityQueryData"}],"contextChangePermitted":true,"columns":{"recver":"ZPriority.recver","name":"ZPriority.name","priority":"ZPriority.priority"},"name":"PriorityQuery","description":"PriorityQuery","inputVarMap":{"tPriority":"taskPrt"},"id":"PriorityQuery","outputVarMap":{"data":"PriorityQuery"},"nodeType":"QUERY"},"TimeFrameQuery":{"filter":"{$id} = {@idFilter1} AND {$priority}={@pri}","models":["ZPriority","sla","slaTimeFrame"],"connectors":[{"exitPortType":"NextStep","nodeId":"CustomerQuery"}],"contextChangePermitted":true,"columns":{"responseTimeAmount":"slaTimeFrame.resolutionTimeAmount","id":"slaTimeFrame.slaId","priority":"ZPriority.name","responseTimeUnit":"slaTimeFrame.resolutionTimeUnit","priorityId":"ZPriority.priority"},"inputs":{"pri":"High","idFilter1":"G0XMGP8CXR"},"name":"TimeFrameQuery","description":"TimeFrameQuery","id":"TimeFrameQuery","outputVarMap":{"data":"TimeFrameQuery"},"nodeType":"QUERY"},"ContractQuery":{"filter":"{$name}={@contractName}","models":["contract"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionContractQuery"}],"contextChangePermitted":true,"columns":{"recver":"recver","name":"contractNumber","id":"id"},"name":"ContractQuery","description":"ContractQuery","inputVarMap":{"platform":"contractName"},"id":"ContractQuery","outputVarMap":{"data":"ContractQuery"},"nodeType":"QUERY"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"parseContextVar"}],"name":"start","description":"Start","nodeType":"START"},"processCustomerData2":{"connectors":[{"exitPortType":"NextStep","nodeId":"ContractQuery"}],"contextChangePermitted":true,"name":"processCustomerData2","description":"processCustomerData2","processRule":"{contextVar.zinierWOType = contextVar.WOTypeQuery[0].id; contextVar.zinierWODesc = contextVar.woDescription; contextVar.zinierWOTypeId = contextVar.WOTypeQuery[0].id; contextVar.zinierTaskTypeId = contextVar.TaskTypeQuery[0].id; contextVar.zinierRegionId = contextVar.RegionQuery[0].id; contextVar.zinierSubRegionId = contextVar.subRegionQuery[0].id; contextVar.zinierUnitNumber = 'NA'; var resTimeUnit = contextVar.TimeFrameQuery[0].responseTimeUnit; var resTimeAmount = contextVar.TimeFrameQuery[0].responseTimeAmount; contextVar.addMinutes = 0; if (resTimeUnit === 'Minutes') { contextVar.addMinutes = parseInt(resTimeAmount + ''); } else if (resTimeUnit === 'Hours') { contextVar.addMinutes = resTimeAmount * 60; } else if (resTimeUnit === 'Days') { contextVar.addMinutes = resTimeAmount * 60 * 24; } else if (resTimeUnit === 'Weeks') { contextVar.addMinutes = resTimeAmount * 60 * 24 * 7; } else if (resTimeUnit === 'Months') { contextVar.addMinutes = resTimeAmount * 60 * 24 * 30; }; contextVar.zinierDueDate = new Date(contextVar.plannedDate); contextVar.zinierDueDate = new Date(contextVar.zinierDueDate.setMinutes(contextVar.zinierDueDate.getMinutes() + contextVar.addMinutes)).toISOString().replace('T', ' ').replace('Z', ''); contextVar.zinierDueDate1 = contextVar.zinierDueDate;}","nodeType":"PROCESS"},"processCustomerData1":{"connectors":[{"exitPortType":"NextStep","nodeId":"processCustomerData2"}],"contextChangePermitted":true,"name":"processCustomerData1","description":"processCustomerData1","processRule":"{contextVar.zinierCustomerId = contextVar.zinierCustId;}","nodeType":"PROCESS"},"WOQuery":{"filter":"{$workOrderId}={@inputWorkOrderId} AND {$workOrder.workOrderTypeId}={@workOrderTypeId}","models":["workOrder"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionWODetails"}],"contextChangePermitted":true,"columns":{"recver":"workOrder.recver","workOrderId":"workOrder.id","id":"workOrder.id"},"name":"WOQuery","description":"WOQuery","inputVarMap":{"zinierWOType":"workOrderTypeId","woId":"inputWorkOrderId"},"id":"WOQuery","outputVarMap":{"data":"WOQuery"},"nodeType":"QUERY"},"processSiteData":{"connectors":[{"exitPortType":"NextStep","nodeId":"WOQuery"}],"contextChangePermitted":true,"name":"processSiteData","description":"processSiteData","processRule":"{contextVar.zinierSiteId = contextVar.CustomerSiteQuery[0].id;}","nodeType":"PROCESS"},"decisionContractQuery":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processContractData1"},{"exitPortType":"FalseStep","nodeId":"processErrorCodes5"}],"name":"decisionCustDetails","description":"decisionCustDetails","processRule":"(typeof contextVar.ContractQuery  !== 'undefined' && typeof contextVar.ContractQuery[0] !== 'undefined' && typeof contextVar.ContractQuery[0]['id'] !== 'undefined')","nodeType":"DECISION"},"decisionPriorityQueryData":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processPriorityQueryData"},{"exitPortType":"FalseStep","nodeId":"processErrorCodes6"}],"name":"decisionPriorityQueryData","description":"decisionPriorityQueryData","processRule":"(typeof contextVar.PriorityQuery[0] !== 'undefined' && typeof contextVar.PriorityQuery[0]['priority'] !== 'undefined') ","nodeType":"DECISION"},"processStatusData":{"connectors":[{"exitPortType":"NextStep","nodeId":"WOTypeQuery"}],"contextChangePermitted":true,"name":"processStatusData","description":"processStatusData","processRule":"{contextVar.defaultstatusIdFK = contextVar.StatusQuery[0].id;}","nodeType":"PROCESS"},"processWOTData":{"connectors":[{"exitPortType":"NextStep","nodeId":"insertWOTDetails"}],"contextChangePermitted":true,"name":"processWOTData","description":"processWOTData","processRule":"{contextVar.zinierTaskTypeId=contextVar.TaskTypeQuery[0].id;}","nodeType":"PROCESS"},"insertCustomerSiteDetails":{"modelName":"site","connectors":[{"exitPortType":"NextStep","nodeId":"processSiteData1"}],"name":"insertCustomerSiteDetails","description":"insertCustomerSiteDetails","inputVarMap":{"siteLat":"latitude","na":"postalCode","zinierUnitNumber":"unitNo","siteLong":"longitude","siteAddress":"address","siteId":"name","zinierSubRegionId":"subRegion","zinierCustomerId":"customerId","zinierRegionId":"parentRegion","dummySiteType":"siteType"},"outputVarMap":{"id":"zinierInsertSiteId"},"nodeType":"MODEL","operation":1},"decisionQueryData":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processErrorCodes1"},{"exitPortType":"FalseStep","nodeId":"processSLAData"}],"name":"decisionQueryData","description":"decisionQueryData","processRule":"( (typeof contextVar.SLAQuery[0] === 'undefined' || typeof contextVar.SLAQuery[0]['id'] === 'undefined') ||   (typeof contextVar.WOTypeQuery[0] === 'undefined' || typeof contextVar.WOTypeQuery[0]['id'] === 'undefined') || (typeof contextVar.TaskTypeQuery[0] === 'undefined' || typeof contextVar.TaskTypeQuery[0]['id'] === 'undefined') || (typeof contextVar.RegionQuery[0] === 'undefined' || typeof contextVar.RegionQuery[0]['id'] === 'undefined') || (typeof contextVar.subRegionQuery[0] === 'undefined' || typeof contextVar.subRegionQuery[0]['id'] === 'undefined'))","nodeType":"DECISION"},"processErrorCodes":{"connectors":[{"exitPortType":"NextStep","nodeId":"insertResponseDetailsToDB"}],"contextChangePermitted":true,"name":"processErrorCodes","description":"processErrorCodes","processRule":"{contextVar['responseData'] = { 'responseCode': '310', 'message': 'One/more mandatory fields are missing. Check if woId, taskId, woType, taskType, siteId, custId, region, subRegion are part of the input' }; contextVar.code=contextVar['responseData'].responseCode;contextVar.message=contextVar['responseData'].message;}","nodeType":"PROCESS"},"CustomerQuery":{"filter":"{$name}={@customerName}","models":["customer"],"connectors":[{"exitPortType":"NextStep","nodeId":"decisionCustDetails"}],"contextChangePermitted":true,"columns":{"recver":"customer.recver","name":"customer.companyName","id":"customer.id"},"name":"CustomerQuery","description":"Customer Query","inputVarMap":{"custId":"customerName"},"id":"CustomerQuery","outputVarMap":{"data":"CustomerQuery"},"nodeType":"QUERY"},"insertResponseDetailsToDB":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"name":"insertResponseDetailsToDB","description":"insertResponseDetailsToDB","processRule":"{}","nodeType":"PROCESS"}}