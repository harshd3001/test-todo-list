{"initializeData":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchTasks"}],"contextChangePermitted":true,"name":"initializeData","description":"initializeData","processRule":"{contextVar.workOrderId = contextVar.workOrderTaskData[0].workOrderId }","id":"initializeData","nodeType":"PROCESS"},"processTaskData":{"connectors":[{"exitPortType":"NextStep","nodeId":"saveWindow1"}],"contextChangePermitted":true,"name":"processTaskData","description":"processTaskData","processRule":"{ if (contextVar.taskDetail !== '' && typeof contextVar.taskDetail !== 'undefined' && contextVar.taskDetail.length > 0) { contextVar.taskId = contextVar.taskDetail[0].id; } contextVar.workOrderTaskAppointmentWindow[0].workOrderTaskId = contextVar.taskId; }","id":"processTaskData","nodeType":"PROCESS"},"setData":{"connectors":[{"exitPortType":"NextStep","nodeId":"upsertCustomerPortalOrderDetails"}],"contextChangePermitted":true,"name":"setData","description":"setData","processRule":"contextVar.customerResponseData = { 'responseTitle': 'Appointment Confirmed', 'responseMessage': 'You will receive a confirmation from us shortly' }; contextVar.status = true; contextVar.customerPortalOrderDetails = []; if (contextVar.action === 'userConfirmBooking') { contextVar.customerPortalOrderDetails = [{ 'UID': contextVar.confirmationNumber, 'statusId': 'fscx2_0_userBookingConfirmed' }]; } contextVar.customerResponseData.status = contextVar.status;","id":"statusValue","nodeType":"PROCESS","jsEngine":"es6"},"fetchWorkOrderTaskData":{"filter":"{$id}= {@taskId}","models":["workOrderTask"],"connectors":[{"exitPortType":"NextStep","nodeId":"initializeData"}],"columns":{"id":"workOrderTask.id","workOrderId":"workOrderTask.workOrderId"},"name":"fetchWorkOrderTaskData","description":"fetchWorkOrderTaskData","inputVarMap":{"jobId":"taskId"},"outputVarMap":{"data":"workOrderTaskData"},"nodeType":"QUERY"},"statusValue":{"connectors":[{"exitPortType":"NextStep","nodeId":"upsertCustomerPortalOrderDetails"}],"contextChangePermitted":true,"name":"statusValue","description":"statusValue","processRule":"contextVar.customerResponseData = { 'responseTitle': 'Appointment Successfully Booked', 'responseMessage': 'You will receive a confirmation from us shortly' }; contextVar.status = true; contextVar.customerPortalOrderDetails = []; if(contextVar.action === 'confirmBooking' ){ contextVar.customerPortalOrderDetails = [{ 'UID': contextVar.confirmationNumber, 'statusId': 'fscx2_0_bookingConfirmed' }]; } if(contextVar.action === 'rescheduleBooking'){ contextVar.customerPortalOrderDetails = [{ 'UID': contextVar.confirmationNumber, 'statusId': 'fscx2_0_bookingRescheduled' }]; } contextVar.customerResponseData.status = contextVar.status;","id":"statusValue","nodeType":"PROCESS","jsEngine":"es6"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchEntityConfig"}],"name":"start","description":"Start","nodeType":"START"},"decideAction":{"connectors":[{"condition":"contextVar.action === 'confirmBooking' || contextVar.action === 'rescheduleBooking'","exitPortType":"NextStep","nodeId":"processWindow"},{"condition":"contextVar.action === 'userConfirmBooking' && contextVar.confirmationNeededInPortal == true","exitPortType":"NextStep","nodeId":"setData"},{"DefaultStep":true,"condition":"typeof contextVar.scheduledDate === 'undefined'","exitPortType":"NextStep","nodeId":"end"}],"name":"decideAction","description":"decideAction","id":"decideAction","nodeType":"MULTIDECISION"},"fetchTasks":{"filter":"{$workOrderTask.workOrderId} = {@workOrderId} && {$id} != {@taskId} ","models":["workOrderTask","workOrder"],"connectors":[{"condition":"","connectorDisplayType":"CurvedLine","connectorLabel":"","exitPortType":"NextStep","nodeId":"processTaskData"}],"columns":{"acPrimaryAppraiserId":"workOrder.acPrimaryAppraiserId","id":"workOrderTask.id"},"name":"fetchTasks","distinct":true,"description":"fetchTasks","inputVarMap":{"workOrderTaskId":"taskId","workOrderId":"workOrderId"},"outputVarMap":{"data":"taskDetail","count":"count1"},"id":"fetchTasks","nodeType":"QUERY","getCount":true},"workflowNodes":["start","fetchEntityConfig","processConfigData","decideAction","processWindow","saveWindow","fetchWorkOrderTaskData","initializeData","fetchTasks","processTaskData","saveWindow1","statusValue","setData","upsertCustomerPortalOrderDetails","end"],"upsertCustomerPortalOrderDetails":{"modelName":"customerPortalOrderDetails","connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"multirecord":true,"name":"upsertCustomerPortalOrderDetails","description":"Save to customerPortalOrderDetails Model","inputVarMap":{"customerPortalOrderDetails":"data"},"outputVarMap":{},"nodeType":"MODEL","operation":4},"saveWindow":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchWorkOrderTaskData"}],"ignoreSubContext":true,"name":"saveWindow","description":"saveWindow","inputVarMap":{"jobId":"workOrderTaskId","appointmentWindowWF":"processId","workOrderTaskAppointmentWindow":"workOrderTaskAppointmentWindow"},"id":"saveWindow","outputVarMap":{},"nodeType":"WORKFLOW"},"workflowContext":{"configScopeArray":["customerPortal"],"appointmentWindowWF":"acWorkOrderTaskAppointmentWindowModelWF","customerResponseData":{"responseTitle":"Appointment Failed","responseMessage":"Please call customer helpline for more details","status":false},"status":false},"processConfigData":{"connectors":[{"exitPortType":"NextStep","nodeId":"decideAction"}],"contextChangePermitted":true,"name":"processConfigData","description":"processConfigData","processRule":"{if (Array.isArray(contextVar.entityConfigData)) { for (let value of contextVar.entityConfigData) { if (value.configKey === 'configurations') { value.configValue = JSON.parse(value.configValue); for (let key in value.configValue) { contextVar[key] = value.configValue[key]; } } } }}","nodeType":"PROCESS","jsEngine":"es6"},"end":{"name":"end","description":"End","inputVarMap":{"customerResponseData":"customerResponseData","status":"status"},"outputVarMap":{"customerResponseData":"customerResponseData","status":"status"},"nodeType":"END"},"fetchEntityConfig":{"filter":"{$configScope} IN {@configScopeArray}","models":["EntityConfig"],"connectors":[{"exitPortType":"NextStep","nodeId":"processConfigData"}],"columns":{"configKey":"EntityConfig.configKey","valueType":"EntityConfig.valueType","configScope":"EntityConfig.configScope","configValue":"EntityConfig.configValue"},"name":"fetchEntityConfig","description":"fetchEntityConfig","inputVarMap":{"configScopeArray":"configScopeArray"},"outputVarMap":{"data":"entityConfigData"},"nodeType":"QUERY"},"processWindow":{"connectors":[{"exitPortType":"NextStep","nodeId":"saveWindow"}],"contextChangePermitted":true,"name":"processTimeFrame","description":"processWindow","processRule":"contextVar.workOrderTaskAppointmentWindow = [{'appointmentWindowId': contextVar.appointmentWindowId, 'startDate': contextVar.startTimeInUTC, 'endDate': contextVar.endTimeInUTC}];","id":"processWindow","nodeType":"PROCESS","jsEngine":"es6"},"saveWindow1":{"connectors":[{"exitPortType":"NextStep","nodeId":"statusValue"}],"ignoreSubContext":true,"name":"saveWindow1","description":"saveWindow1","inputVarMap":{"appointmentWindowWF":"processId","workOrderTaskAppointmentWindow":"workOrderTaskAppointmentWindow","taskId":"workOrderTaskId"},"id":"saveWindow1","outputVarMap":{},"nodeType":"WORKFLOW"}}