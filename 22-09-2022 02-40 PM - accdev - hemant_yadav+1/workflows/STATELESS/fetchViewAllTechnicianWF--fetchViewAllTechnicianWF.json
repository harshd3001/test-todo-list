{"fetchMoreTechs":{"connectors":[{"exitPortType":"TrueStep","nodeId":"fetchTechsData"},{"exitPortType":"FalseStep","nodeId":"end"}],"data":"technicianListData","name":"fetchMoreTechs","description":"fetchMoreTechs","inputVarMap":{},"processRule":"contextVar.noOfBatches >= contextVar.newBatchNumber","id":"fetchMoreTechs","outputVarMap":{},"nodeType":"WHILELOOP"},"appendTechs":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchMoreTechs"}],"contextChangePermitted":true,"name":"appendTechs","description":"appendTechs","processRule":"if (Array.isArray(contextVar.techDataToAppend)) { contextVar.techDataToAppend.forEach(function(obj){contextVar.technicianListData.push(obj);}); } contextVar.newBatchNumber = contextVar.newBatchNumber + 1;","id":"appendTechs","nodeType":"PROCESS"},"workflowContext":{"customBatchSize":1000,"userStatus":"Deactivated","workforceStatusId":"workforceActive"},"findNumberOfBatches":{"connectors":[{"exitPortType":"NextStep","nodeId":"areMoreTechsPresent"}],"contextChangePermitted":true,"name":"findNumberOfBatches","description":"findNumberOfBatches","processRule":"contextVar.noOfBatches = Math.ceil(contextVar.count / contextVar.customBatchSize);contextVar.newBatchNumber = contextVar.taskBatchNumber + 1;","id":"findNumberOfBatches","nodeType":"PROCESS"},"areMoreTechsPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"fetchMoreTechs"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"areMoreTechsPresent","description":"areMoreTechsPresent","processRule":"contextVar.noOfBatches >= 2","id":"areMoreTechsPresent","nodeType":"DECISION"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"initializeParams"}],"name":"start","description":"Start","id":"start","nodeType":"START"},"getMobileTechnicianData":{"models":["workOrderTask","taskType","ZProcess","workforce","ZProjectUser","UserGroup","User","calendar"],"connectors":[{"exitPortType":"NextStep","nodeId":"findNumberOfBatches"}],"columns":{"workOrderTaskTaskType":"workOrderTask.taskTypeId","userStatus":"User.status","calendarId":"workforce.calendarId","userPhoneNumber":"User.phoneNumber","workOrderTaskId":"workOrderTask.id","userEmail":"User.emailId","userName":"User.name","workforceUserId":"workforce.userId","userId":"User.id"},"description":"getMobileTechnicianData","distinct":true,"inputVarMap":{"customBatchSize":"batchSize","filter":"filter","userStatus":"userStatus","workOrderTaskId":"workOrderTaskId","workforceStatusId":"workforceStatusId","schedulerTechArray":"schedulerTechArray"},"nodeType":"QUERY","filter":"filter","name":"getMobileTechnicianData","links":{"calendar":"workforce","workOrderTask":"taskType","workforce":"User"},"outputVarMap":{"data":"technicianListData","count":"count","batchNumber":"taskBatchNumber"},"batchSize":"batchSize","getCount":true},"end":{"name":"End","description":"end","inputVarMap":{"technicianListData":"technicianListData"},"outputVarMap":{"technicianListData":"technicianListData"},"id":"end","nodeType":"END"},"fetchTechsData":{"models":["workOrderTask","taskType","ZProcess","workforce","ZProjectUser","UserGroup","User","calendar"],"connectors":[{"exitPortType":"NextStep","nodeId":"appendTechs"}],"columns":{"workOrderTaskTaskType":"workOrderTask.taskTypeId","userStatus":"User.status","calendarId":"workforce.calendarId","userPhoneNumber":"User.phoneNumber","workOrderTaskId":"workOrderTask.id","userEmail":"User.emailId","userName":"User.name","workforceUserId":"workforce.userId","userId":"User.id"},"description":"Fetch Task Details","distinct":true,"inputVarMap":{"customBatchSize":"batchSize","filter":"filter","userStatus":"userStatus","techBatchSize":"batchSize","workOrderTaskId":"workOrderTaskId","newBatchNumber":"batchNumber","workforceStatusId":"workforceStatusId"},"nodeType":"QUERY","filter":"filter","name":"fetchTechsData","links":{"calendar":"workforce","workOrderTask":"taskType","workforce":"User"},"id":"fetchTechsData","outputVarMap":{"data":"techDataToAppend"},"batchSize":"batchSize","getCount":true,"batchNumber":"batchNumber"},"workflowNodes":["start","initializeParams","getMobileTechnicianData","findNumberOfBatches","areMoreTechsPresent","fetchMoreTechs","fetchTechsData","appendTechs","end"],"initializeParams":{"connectors":[{"exitPortType":"NextStep","nodeId":"getMobileTechnicianData"}],"contextChangePermitted":true,"name":"initializeParams","description":"Initialize params for workflow","processRule":"{ if (typeof contextVar === 'undefined' || typeof contextVar.filter === 'undefined' || contextVar.filter === '') { contextVar.filter = '({$taskType.mobileProcessId}={$ZProcess.id} AND {$User.status} != {@userStatus} AND {$workforce.statusId} = {@workforceStatusId} and {$ZProcess.projectId}={$ZProjectUser.projectId} and {$workOrderTaskId}={@workOrderTaskId} and {$ZProjectUser.groupId}={$UserGroup.groupId})'; } else { contextVar.filter = '(' + contextVar.filter + ') AND {$User.status} != {@userStatus} AND {$workforce.statusId} = {@workforceStatusId} and ({$taskType.mobileProcessId}={$ZProcess.id} and {$ZProcess.projectId}={$ZProjectUser.projectId} and {$workOrderTaskId}={@workOrderTaskId} and {$ZProjectUser.groupId}={$UserGroup.groupId})'; } }","id":"initializeParams","nodeType":"PROCESS"}}