{"appendAppointWindowData":{"connectors":[{"exitPortType":"NextStep","nodeId":"isMoreAppointWindowDataPresent"}],"contextChangePermitted":true,"name":"appendAppointWindowData","description":"appendAppointWindowData","processRule":"{ try { if (typeof contextVar.moreAppointmentWindowTasks !== 'undefined' && contextVar.moreAppointmentWindowTasks !== '' && Array.isArray(contextVar.moreAppointmentWindowTasks) && typeof contextVar.appointmentWindowTasksList !== 'undefined' && contextVar.appointmentWindowTasksList !== '' && Array.isArray(contextVar.appointmentWindowTasksList)) { let prevAppointWindowData = [], currAppointWindowData = []; currAppointWindowData = contextVar.moreAppointmentWindowTasks; prevAppointWindowData = contextVar.appointmentWindowTasksList; contextVar.appointmentWindowTasksList = [...prevAppointWindowData, ...currAppointWindowData]; } contextVar.newBatchNumber = contextVar.newBatchNumber + 1; } catch (err) { console.log('System Unavailable : ' + err); } }","nodeType":"PROCESS","jsEngine":"es6"},"callOldSchedulerWF":{"connectors":[{"exitPortType":"NextStep","nodeId":"isTechAndTaskDataPresent"}],"processId":"TG8NYP8B10","ignoreSubContext":true,"name":"callOldSchedulerWF","description":"callOldSchedulerWF","inputVarMap":{"filter":"taskFilter","endDate":"endDate","startDate":"startDate"},"outputVarMap":{"techAndTaskData":"techAndTaskData"},"nodeType":"WORKFLOW"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"callOldSchedulerWF"}],"name":"start","description":"Start","nodeType":"START"},"isMoreAppointWindowDataPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"getMoreAppointWindowTasksData"},{"exitPortType":"FalseStep","nodeId":"clearAppointWindowValues"}],"name":"isMoreAppointWindowDataPresent","description":"isMoreAppointWindowDataPresent","processRule":"contextVar.noOfAllBatches >= 2 && contextVar.noOfAllBatches >= contextVar.newBatchNumber","nodeType":"DECISION"},"workflowNodes":["start","callOldSchedulerWF","isTechAndTaskDataPresent","processFilterTasksZRule","fetchAppointmentWindowTasks","findAppointWindowBatches","isMoreAppointWindowDataPresent","getMoreAppointWindowTasksData","appendAppointWindowData","clearAppointWindowValues","processZRule","end"],"clearAppointWindowValues":{"connectors":[{"exitPortType":"NextStep","nodeId":"processZRule"}],"contextChangePermitted":true,"name":"clearAppointWindowValues","description":"clearAppointWindowValues","processRule":"contextVar.moreAppointmentWindowTasks='';contextVar.noOfAllBatches='';contextVar.newBatchNumber='';","nodeType":"PROCESS"},"workflowContext":{"customBatchSize":1000,"defaultProfilePic":"https://d122pusslfmuhu.cloudfront.net/UserNoProfilePic.jpg","newBatchNumber":0,"noOfAllBatches":0,"calendarTasksFilterFlag":true,"batchNumber":1},"isTechAndTaskDataPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processFilterTasksZRule"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"isTechAndTaskDataPresent","description":"isTechAndTaskDataPresent","processRule":"(typeof contextVar.techAndTaskData !== 'undefined' && contextVar.techAndTaskData !== '' && ( (contextVar.techAndTaskData.techData !== 'undefined'  && Array.isArray(contextVar.techAndTaskData.techData) === true && contextVar.techAndTaskData.techData.length > 0) || (contextVar.techAndTaskData.taskData !== 'undefined'  && Array.isArray(contextVar.techAndTaskData.taskData) === true && contextVar.techAndTaskData.taskData.length > 0) ))","nodeType":"DECISION"},"processFilterTasksZRule":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchAppointmentWindowTasks"}],"contextChangePermitted":true,"name":"processFilterTasksZRule","description":"processFilterTasksZRule","processRule":"@9025SXUL8W","nodeType":"PROCESS","jsEngine":"es6"},"findAppointWindowBatches":{"connectors":[{"exitPortType":"NextStep","nodeId":"isMoreAppointWindowDataPresent"}],"contextChangePermitted":true,"name":"findAppointWindowBatches","description":"findAppointWindowBatches","processRule":"{contextVar.noOfAllBatches = Math.ceil(contextVar.appointWindowBatchCount / contextVar.customBatchSize); contextVar.newBatchNumber = contextVar.appointWindowBatchNumber + 1;}","nodeType":"PROCESS"},"getMoreAppointWindowTasksData":{"models":["workOrderTaskAppointmentWindow"],"connectors":[{"exitPortType":"NextStep","nodeId":"appendAppointWindowData"}],"columns":{"workOrderTaskAppointmentWindowStartDate":"workOrderTaskAppointmentWindow.startDate","workOrderTaskAppointmentWindow":"workOrderTaskAppointmentWindow.startEndJson","workOrderTaskAppointmentWindowId":"workOrderTaskAppointmentWindow.appointmentWindowId","workOrderTaskAppointmentWindowTaskId":"workOrderTaskAppointmentWindow.workOrderTaskId","workOrderTaskAppointmentWindowEndDate":"workOrderTaskAppointmentWindow.endDate"},"distinct":true,"description":"getMoreAppointWindowTasksData","inputVarMap":{"taskIdList":"taskIdList","customBatchSize":"batchSize","newBatchNumber":"batchNumber"},"nodeType":"QUERY","filter":"{$workOrderTaskAppointmentWindowTaskId} IN {@taskIdList}","name":"getMoreAppointWindowTasksData","outputVarMap":{"data":"moreAppointmentWindowTasks","count":"appointWindowBatchCount","batchNumber":"appointWindowBatchNumber"},"batchSize":"batchSize","getCount":true,"batchNumber":"batchNumber"},"end":{"name":"end","description":"End","inputVarMap":{"bryntumSchedulerData":"bryntumSchedulerData"},"outputVarMap":{"bryntumSchedulerData":"bryntumSchedulerData"},"nodeType":"END"},"processZRule":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"processZRule","description":"processZRule","processRule":"@QE00ICUH1V","nodeType":"PROCESS","jsEngine":"es6"},"fetchAppointmentWindowTasks":{"models":["workOrderTaskAppointmentWindow"],"connectors":[{"exitPortType":"NextStep","nodeId":"findAppointWindowBatches"}],"columns":{"workOrderTaskAppointmentWindowStartDate":"workOrderTaskAppointmentWindow.startDate","workOrderTaskAppointmentWindow":"workOrderTaskAppointmentWindow.startEndJson","workOrderTaskAppointmentWindowId":"workOrderTaskAppointmentWindow.appointmentWindowId","workOrderTaskAppointmentWindowTaskId":"workOrderTaskAppointmentWindow.workOrderTaskId","workOrderTaskAppointmentWindowEndDate":"workOrderTaskAppointmentWindow.endDate"},"distinct":true,"description":"fetchAppointmentWindowTasks","inputVarMap":{"taskIdList":"taskIdList","customBatchSize":"batchSize","batchNumber":"batchNumber"},"nodeType":"QUERY","filter":"{$workOrderTaskAppointmentWindowTaskId} IN {@taskIdList}","name":"fetchAppointmentWindowTasks","outputVarMap":{"data":"appointmentWindowTasksList","count":"appointWindowBatchCount","batchNumber":"appointWindowBatchNumber"},"batchSize":"batchSize","getCount":true,"batchNumber":"batchNumber"}}