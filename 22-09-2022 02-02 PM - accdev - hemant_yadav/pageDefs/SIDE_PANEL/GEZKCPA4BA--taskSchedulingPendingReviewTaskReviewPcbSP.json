{"pageContext":{},"actionOnLoad":["@actions.enableRecordGrid","@actions.fireProcessEventForTaskReviewFetchData","@actions.processResponseData","@actions.setTravelDetails","@actions.calculatedActualTaskDuration"],"children":[],"localPageContext":true,"jslib":{"isFinalEvidenceHidden":"function (pageContext) { if( typeof pageContext.showFinalEvidenceGrid != 'undefined' &&  pageContext.showFinalEvidenceGrid == true ) { return false; } else { return true; } }","isViewProgressReportHidden":"function (pageContext) { var flag = true; if ( Array.isArray(pageContext.workOrderTaskResult)  &&pageContext.workOrderTaskResult.length > 0  && JSON.stringify(pageContext.workOrderTaskResult).indexOf('submitType') > 0) { for (var i = 0; i < pageContext.workOrderTaskResult.length; i++) { if ((typeof pageContext.workOrderTaskResult[i].initialEvidenceDataGrid !== 'undefined' && pageContext.workOrderTaskResult[i].initialEvidenceDataGrid.length > 0) || (typeof pageContext.workOrderTaskResult[i].submitProgressEvidenceDataGrid !== 'undefined' && pageContext.workOrderTaskResult[i].submitProgressEvidenceDataGrid.length > 0) || (typeof pageContext.workOrderTaskResult[i].servicesDataGrid !== 'undefined' && pageContext.workOrderTaskResult[i].servicesDataGrid.length > 0)) { flag = false; } else { flag = true; } } }return flag; }","isAssignedUserHidden":"function (pageContext) { return (typeof pageContext.responseData !=='undefined' && pageContext.responseData.length > 0 && typeof pageContext.responseData[0].data[0].crewData !== 'undefined' && pageContext.responseData[0].data[0].crewData.length>0); }","isTaskResultHidden":"function (pageContext) { return !(pageContext.statusId==='workOrderTaskCompleted'|| pageContext.statusId==='workOrderTaskCancelled'); }","isHiddenDependencyDatagrid":"function (pageContext){if (typeof pageContext.taskDependencyData !== 'undefined' && pageContext.taskDependencyData.length > 0) {return false;}else{return true;}}","isAssignedCrewHidden":"function (pageContext) { return (typeof pageContext.responseData === 'undefined' || pageContext.responseData === '' || typeof pageContext.responseData[0].data[0].crewData === 'undefined' || pageContext.responseData[0].data[0].crewData === ''); }","isServicesHidden":"function (pageContext) { if( typeof pageContext.selectedFilterForView !== 'undefined' && pageContext.selectedFilterForView === 'byServices'){return false;}else{return true;} }","isActivityHidden":"function(pageContext) { if (pageContext.status === 'workOrderTaskCompleted' || pageContext.status === 'workOrderTaskPendingReview') { return false; } else if (pageContext.status === 'workOrderTaskCancelled') { if (typeof pageContext.responseData[0].data[0].workOrderTaskData.workOrderTaskResult !== 'undefined') { return false; } else { return true; } } else if (pageContext.workOrderTaskService === false) { return true; } else{ return true;} }","isShowActualStartTime":"function(pageContext){if(pageContext.status === 'workOrderTaskInProgress'){return false;}else{return true;}}","isAppointmentWindowHidden":"function(pageContext){return !(pageContext.workOrderTaskAppointmentBasedFlag)}","isDeleteTaskHidden":"function(pageContext){return(pageContext.status === 'workOrderTaskPendingReview' || pageContext.status === 'workOrderTaskSiteChangeRequest');}","isWorkOrderTaskCancelledHidden":"function(pageContext){ if (pageContext.status === 'workOrderTaskCancelled') {return false;}else {return true;}}","isServicesDeliveredHidden":"function (pageContext) { if( typeof pageContext.showServicesDeliveredGrid != 'undefined' &&  pageContext.showServicesDeliveredGrid == true ) { return false; } else { return true; } }","isIncidentReportHidden":"function(pageContext){if(typeof pageContext.incidentDetails === 'undefined' || pageContext.incidentDetails === '' || pageContext.incidentDetails.length <= 0){return true;}else{return false;}}","isPreviousAssigneeHidden":"function (pageContext) { return !(typeof pageContext.previousAssignees !== 'undefined' && pageContext.previousAssignees.length > 0); }","isInitialEvidenceHidden":"function (pageContext) { if( typeof pageContext.showInitialEvidenceGrid != 'undefined' &&  pageContext.showInitialEvidenceGrid == true ) { return false; } else { return true; } }","istravelDetailsHidden":"function(pageContext){if(pageContext.viewTravelStatus && (pageContext.status === 'workOrderTaskInTransit' || pageContext.status === 'workOrderTaskInProgress' || pageContext.status === 'workOrderTaskPendingReview' || pageContext.status === 'workOrderTaskCancelled' || pageContext.status === 'workOrderTaskCompleted')){return false;}else{return true;}}","hasCustomerSignature":"function(pageContext){if(typeof pageContext.customerSignature=='undefined' || pageContext.customerSignature==''){return true;}}","isSubmittedProgressHidden":"function (pageContext) { if( typeof pageContext.selectedFilterForView !== 'undefined' &&  pageContext.selectedFilterForView === 'byDate'){return false;}else{return true;} }","dynamicHeaderText":"function(pageContext){ if(pageContext.status === 'workOrderTaskPendingReview'){return '@lang.[\"tr1\",\"Task Review\"]'} else if(pageContext.subAction === 'calendarViewTask' || pageContext.status === 'workOrderTaskCompleted' || pageContext.status === 'workOrderTaskCancelled'){return '@lang.[\"vt\",\"View Task\"]'} }","isSelectedServicesHidden":"function (pageContext) { if( typeof pageContext.showSelectedServicesGrid != 'undefined' &&  pageContext.showSelectedServicesGrid == true ) { return false; } else { return true; } }","isTaskCompeletedOrCancelled":"function (pageContext) { return (pageContext.status==='workOrderTaskCompleted'|| pageContext.status==='workOrderTaskCancelled'); }","isDependencyOverrideHidden":"function (pageContext) { return (typeof pageContext.workOrder === 'undefined' || pageContext.workOrderTaskResult === '' || typeof pageContext.workOrderTaskResult[0].overrideReason === 'undefined' || pageContext.workOrderTaskResult[0].overrideReason === '') }","isAfterOverAllCommentsHidden":"function(pageContext){ if (typeof pageContext.afterOverallComments === 'undefined' || pageContext.afterOverallComments== '') {return true;}}"},"header":{"children":[{"statusColor":"@pageContext.statusNameColor","id":"status","type":"status","value":"@pageContext.statusName"},{"isRequired":false,"hidden":"@jslib.isTaskCompeletedOrCancelled","data":[{"buttonType":"secondary","hidden":false,"actionOnClick":["@actions.setActionApproveTask","@actions.openApproveNSP"],"id":"approveTask","type":"button","title":"@lang.['at6','Approve Task ']"},{"buttonType":"secondary","hidden":false,"actionOnClick":["@actions.setActionRejectTask","@actions.openApproveNSP"],"id":"rejectTask","type":"button","title":"@lang.['rt6','Reject Task']"},{"buttonType":"secondary","actionOnClick":["@actions.cancelTaskModal"],"id":"cancelTask","type":"button","title":"@lang.['ct4','Cancel Task']"}],"type":"actionDropdown","title":"@lang.['o4','Options']"},{"activeIcon":"@iconlib.ActionsBinPurple","hidden":"@jslib.isDeleteTaskHidden","icon":"@iconlib.ActionsBinGrey","actionOnClick":["@actions.deleteTaskModal"],"id":"deleteTask","type":"buttonIcon","title":"@lang.['d1','Delete']"},{"icon":"@iconlib.NavigationCloseGrey","actionOnClick":["@actions.closePanel","@actions.clearPageContext"],"id":"close","type":"buttonIcon"}],"title":"@jslib.dynamicHeaderText"},"body":{"children":[{"children":[{"hidden":false,"children":[{"hidden":"@jslib.isTaskResultHidden","children":[{"readOnly":true,"id":"taskReviewResult","label":"@lang.['trr','Task Review Result']","type":"input","value":"@pageContext.taskReviewResult","placeHolder":""},{"readOnly":true,"id":"taskReviewLogReviewNotes","label":"@lang.['reviewNotes','Review Notes']","type":"textarea","value":"@pageContext.taskReviewLogReviewNotes","placeHolder":""}],"id":"taskResult","label":"@lang.['tr1','Task Review']","type":"section"},{"hidden":"@jslib.isViewProgressReportHidden","children":[{"children":[{"actionOnChange":["@actions.setTimeZoneAndLocale","@actions.decisionActionForFilter","@actions.viewChange"],"options":[{"label":"@lang.['d3','Date']","value":"byDate"},{"label":"@lang.['navS3','Services']","value":"byServices"}],"id":"dropdown","label":"@lang.['vprb','View Progress Reports By']","optTitleKey":"label","optValueKey":"value","title":"@lang.['vprb','View Progress Reports By']","type":"dropdown","value":"@pageContext.dropdown","placeHolder":"@lang.['so','Select option']","hoverText":{"title":"@lang.['tdtfiwywtrsftmtbdh','This determines the format in which you want the results submitted from the mobile to be displayed here.']"}}],"label":"","id":"filterDropdown","type":"section","transparent":true}],"id":"viewProgressReportsBy","label":"@lang.['s38','Scheduling']","type":"section","transparent":false},{"hidden":"@jslib.isSubmittedProgressHidden","children":[{"id":"submittedProgressData","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.taskProgressDataByDate[0].taskProgressDataByDate"}},"isScrollAble":false,"searchAllowed":true,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsVisiblePurple","name":"@lang.['vtr','View Task Results']","icon":"@iconlib.ActionsVisibleGrey","tooltip":"@lang.['v1','View']","actionOnClick":["@actions.openProgressEvidenceNSP"],"type":"buttonIcon"}]},"gridRefreshId":"submittedProgressDataGrid","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"tableHeader":[{"name":"@lang.['so1','Submitted On']","options":{"flex":1.4,"showLabel":true},"key":"date","primaryKey":true},{"name":"@lang.['sd12','Services Delivered']","options":{"flex":1.4,"showLabel":true},"key":"servicesDeliveredCount"},{"name":"@lang.['initialEvidence','Initial Evidence']","options":{"flex":1.4,"showLabel":true},"key":"initialEvidenceCount"},{"name":"@lang.['pr','Progress Reports']","options":{"flex":1.4,"showLabel":true},"key":"submitProgressArrayCount"},{"hidden":true,"name":"@lang.['fe','Final Evidence']","options":{},"key":"finalEvidenceCount","primaryKey":true}],"actionOnLoad":[],"dataSourceId":"query/read","jslib":{"isViewResultsByDateDisabled":"function (pageContext) { if( typeof pageContext.selectedRowIds != 'undefined' &&  pageContext.selectedRowIds.length > 0 ) { return false; } else { return true; } }"},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['sp4','Submitted Progress']","children":[{"buttonType":"primary","actionOnClick":["@actions.decisionIfDateSelected"],"disabled":"@jslib.isViewResultsByDateDisabled","id":"viewResults","type":"button","title":"@lang.['vr','View Results']"}]},"isSelectable":true,"actions":[{"falseStep":[],"trueStep":["@actions.setSelectedDates","@actions.processTaskProgressDataByDate","@actions.setFlagsToShowInitialEvidenceAndServicesDelivered","@actions.refreshDataGrids"],"name":"decisionIfDateSelected","type":"decision","actionDef":"function (pageContext) { if( typeof pageContext.selectedRowIds != 'undefined' &&  pageContext.selectedRowIds.length > 0 ) { return true; } else { return false; } }"},{"name":"setSelectedDates","type":"script","actionDef":"function (pageContext) { if ( typeof pageContext.selectedRowIds != 'undefined' &&  pageContext.selectedRowIds.length > 0 ) { pageContext.selectedDates = []; pageContext.selectedRowIds.forEach(function(element) { pageContext.selectedDates.push(element.date); });} }"},{"name":"openProgressEvidenceNSP","type":"openPanel","pageId":"6KCJEOE5UP"},{"name":"refreshDataGrids","gridId":["servicesDeliveredDataGrid","initialEvidenceDataGrid","finalEvidenceDataGrid"],"type":"RefreshGridOnSidePanel"},{"name":"setFlagsToShowInitialEvidenceAndServicesDelivered","type":"script","actionDef":"function (pageContext) { if (typeof pageContext.selectedRowIds !== 'undefined' && pageContext.selectedRowIds.length > 0) { if (typeof pageContext.initialEvidenceGridData !== 'undefined' && pageContext.initialEvidenceGridData.length > 0) { pageContext.showInitialEvidenceGrid = true; } else { pageContext.showInitialEvidenceGrid = false; } if (typeof pageContext.finalEvidenceMainDatagrid !== 'undefined' && pageContext.finalEvidenceMainDatagrid.length > 0) { pageContext.showFinalEvidenceGrid = true; } else { pageContext.showFinalEvidenceGrid = false; } if (typeof pageContext.servicesData !== 'undefined' && pageContext.servicesData !== '' && pageContext.servicesData.length > 0) { pageContext.showServicesDeliveredGrid = true; } else { pageContext.showServicesDeliveredGrid = false; } } }"},{"name":"processTaskProgressDataByDate","type":"script","actionDef":"function (pageContext) { if (typeof pageContext.taskProgressDataByDate != 'undefined' && pageContext.taskProgressDataByDate != '' && pageContext.taskProgressDataByDate.length > 0) { pageContext.initialComments = pageContext.taskProgressDataByDate[0].taskProgressDataByDate[0].initialComments; pageContext.finalComments = pageContext.taskProgressDataByDate[0].taskProgressDataByDate[0].finalComments; pageContext.filteredTaskProgressDataByDate = pageContext.taskProgressDataByDate[0].taskProgressDataByDate.filter(function (element) { if (pageContext.selectedDates.indexOf(element.date) > -1) { return true; } else { return false; } }); pageContext.initialEvidenceGridData = []; pageContext.servicesData = []; pageContext.finalEvidenceMainDatagrid = []; pageContext.filteredTaskProgressDataByDate.forEach(function (element) { if (typeof element.initialEvidence !== 'undefined' && element.initialEvidence.length > 0) { element.initialEvidence.forEach(function (ele) { pageContext.initialEvidenceGridData.push(ele); }); } if (typeof element.servicesData !== 'undefined' && element.servicesData.length > 0) { element.servicesData.forEach(function (e) { pageContext.servicesData.push(e); }); } if (typeof element.finalEvidenceArray !== 'undefined' && element.finalEvidenceArray.length > 0) { element.finalEvidenceArray.forEach(function (ele) { pageContext.finalEvidenceMainDatagrid.push(ele); }); } }); pageContext.finalServicesData = []; pageContext.servicesData.forEach(function (ele) { ele.selectedServiceData.forEach(function (e) { var obj = {}; if (new Date(ele.completedOn).getTime() === new Date(e.addedOn).getTime()) { obj = { ...ele, 'serviceMode': e.serviceMode, 'action': e.serviceModeName, 'actionData': e, 'serviceModeName': e.serviceModeName }; delete obj.selectedServiceData; pageContext.finalServicesData.push(obj); } }); }); } }"}],"searchKeys":["date"],"multiSelect":true}}],"label":"","id":"submittedProgress","type":"section","transparent":true},{"hidden":"@jslib.isServicesHidden","children":[{"id":"servicesGrid","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.taskProgressDataByServices[0].servicesArrayForTaskProgress"}},"isScrollAble":false,"searchAllowed":true,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{},"gridRefreshId":"servicesDataGrid","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"tableHeader":[{"name":"@lang.['si1','Service Id']","options":{"hidden":true,"flex":1.4,"showLabel":false},"key":"id","primaryKey":true},{"name":"@lang.['sn2','Service Name']","options":{"flex":1.4,"showLabel":true},"key":"serviceName","primaryKey":true},{"name":"@lang.['s','Status']","options":{"flex":1.4,"showLabel":true},"key":"serviceStatus"},{"name":"@lang.['r','Records']","options":{"flex":1.4,"showLabel":true},"key":"numberOfServicesUsed"},{"name":"@lang.['sd11','service Data']","options":{"hidden":true,"flex":1.4,"showLabel":false},"key":"servicesData","primaryKey":true}],"singleSelect":true,"actionOnLoad":[],"dataSourceId":"query/read","jslib":{"isViewResultsByServicesDisabled":"function (pageContext) { if( typeof pageContext.selectedRowIds != 'undefined' &&  pageContext.selectedRowIds.length > 0 ) { return false; } else { return true; } }"},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['navS3','Services']","children":[{"buttonType":"primary","actionOnClick":["@actions.setSelectedServicesData","@actions.setFlagsToShowSelectedServices","@actions.refreshSelectedServicesDataGrid"],"disabled":"@jslib.isViewResultsByServicesDisabled","id":"viewResults","type":"button","title":"@lang.['vr','View Results']"}]},"isSelectable":true,"actions":[{"name":"refreshSelectedServicesDataGrid","gridId":["selectedServicesDataGrid"],"type":"RefreshGridOnSidePanel"},{"name":"setSelectedServicesData","type":"script","actionDef":"function (pageContext) { if (typeof pageContext.selectedRowIds !== 'undefined' && pageContext.selectedRowIds.length > 0) { pageContext.selectedServiceName = pageContext.selectedRowIds[0].serviceName; pageContext.selectedServiceData = []; var obj = {}; if (typeof pageContext.selectedRowIds[0].servicesData !== 'undefined') { pageContext.selectedRowIds[0].servicesData.forEach(function (element, index) { obj = { ...element, 'action': element.serviceGridWrapper[index].serviceModeName, 'actionData': element.serviceGridWrapper[index], 'serviceMode': element.serviceGridWrapper[index].serviceMode, 'addedBy': element.serviceGridWrapper[index].addedBy }; delete obj.serviceGridWrapper; pageContext.selectedServiceData.push(obj); }); } } }"},{"name":"setFlagsToShowSelectedServices","type":"script","actionDef":"function(pageContext){pageContext.showSelectedServicesGrid = true;}"}],"searchKeys":["serviceName"]}}],"label":"","id":"services","type":"section","transparent":true},{"hidden":"@jslib.isSelectedServicesHidden","children":[{"id":"selectedServicesData","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.selectedServiceData"}},"isScrollAble":false,"searchAllowed":false,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsVisiblePurple","name":"@lang.['vtr','View Task Results']","icon":"@iconlib.ActionsVisibleGrey","tooltip":"@lang.['v1','View']","actionOnClick":["@actions.openServicesDeliveredNSP"],"type":"buttonIcon"}]},"gridRefreshId":"selectedServicesDataGrid","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"tableHeader":[{"name":"@lang.['s33','serviceId']","options":{"hidden":true,"showLabel":false},"key":"serviceItemId","primaryKey":true},{"name":"@lang.['co3','Completed On']","options":{"type":"datetime","showLabel":true},"key":"completedOn"},{"name":"@lang.['action','Action']","options":{"showLabel":true},"key":"action"},{"name":"@lang.['ua1','Updated Asset']","options":{"showLabel":true},"key":"assetName"},{"name":"@lang.['cb1','Captured By']","options":{"showLabel":true},"key":"addedBy"}],"dataSourceId":"query/read","jslib":{},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@pageContext.selectedServiceName"},"isSelectable":false,"actions":[{"name":"openServicesDeliveredNSP","type":"openPanel","pageId":"KBFLEOEEL2"}],"searchKeys":[]}}],"label":"","id":"selectedServices","type":"section","transparent":true},{"hidden":"@jslib.isInitialEvidenceHidden","children":[{"children":[{"id":"initialEvidenceData","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.initialEvidenceGridData"}},"isScrollAble":false,"searchAllowed":true,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsVisiblePurple","name":"@lang.['vtr','View Task Results']","icon":"@iconlib.ActionsVisibleGrey","tooltip":"@lang.['v1','View']","actionOnClick":["@actions.isInitialEvidence","@actions.openInitialEvidenceNSP"],"type":"buttonIcon"}]},"gridRefreshId":"initialEvidenceDataGrid","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"tableHeader":[{"name":"@lang.['co2','Captured On']","options":{"type":"datetime","showLabel":true},"key":"initialEvidenceCapturedTime"},{"name":"@lang.['cb1','Captured By']","options":{"showLabel":true},"key":"capturedBy"},{"name":"@lang.['pp2','Photo Preview']","options":{"hidden":false,"showLabel":true},"type":"thumbnail","key":"initialEvidence","fileType":"JPG"},{"name":"@lang.['n3','Notes']","options":{"showLabel":true},"key":"initialEvidenceNotes"}],"dataSourceId":"query/read","jslib":{},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['initialEvidence','Initial Evidence']"},"updateAllowed":true,"isSelectable":false,"actions":[{"name":"openInitialEvidenceNSP","type":"openPanel","pageId":"0BFEEOE9ON"},{"name":"isInitialEvidence","type":"script","actionDef":"function(pageContext){ pageContext.isInitialEvidence=true; pageContext.isFinalEvidence=false;}"}],"searchKeys":["capturedBy"],"multiSelect":false}}],"label":"","id":"initialEvidenceGrid","type":"section","transparent":true},{"children":[{"readOnly":true,"id":"notes","label":"@lang.['n3','Notes']","placeholder":"@lang.['blank4','-']","type":"input","value":"@pageContext.initialComments"}],"label":"","id":"notes","type":"section"}],"label":"@lang.['initialEvidence','Initial Evidence']","id":"initialEvidence","type":"collapseSection","transparent":true},{"hidden":"@jslib.isServicesDeliveredHidden","children":[{"id":"servicesDeliveredData","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.finalServicesData"}},"isScrollAble":false,"tableWidth":"60rem","searchAllowed":true,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsVisiblePurple","name":"@lang.['vtr','View Task Results']","icon":"@iconlib.ActionsVisibleGrey","tooltip":"@lang.['v1','View']","actionOnClick":["@actions.openServicesDeliveredNSP"],"type":"buttonIcon"}]},"gridRefreshId":"servicesDeliveredDataGrid","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"tableHeader":[{"name":"@lang.['co3','Completed On']","options":{"flex":1.4,"type":"datetime","showLabel":true},"key":"completedOn"},{"name":"@lang.['s21','Service']","options":{"flex":1.4,"showLabel":true},"key":"serviceType"},{"name":"@lang.['action','Action']","options":{"showLabel":true},"key":"action"},{"name":"@lang.['an1','Asset Name']","options":{"flex":1.8,"showLabel":true},"key":"assetName"},{"name":"@lang.['cb1','Captured By']","options":{"flex":1.2,"showLabel":true},"key":"capturedBy"}],"dataSourceId":"query/read","jslib":{},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['sd12','Services Delivered']"},"isSelectable":false,"actions":[{"name":"openServicesDeliveredNSP","type":"openPanel","pageId":"KBFLEOEEL2"}],"searchKeys":["startDate","endDate","durationInHours"]}}],"label":"@lang.['navS3','Services']","id":"servicesDelivered","type":"collapseSection","transparent":true},{"hidden":"@jslib.isFinalEvidenceHidden","children":[{"children":[{"id":"finalEvidenceMainDatagrid","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.finalEvidenceMainDatagrid"}},"isScrollAble":false,"searchAllowed":true,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsVisiblePurple","name":"@lang.['vtr','View Task Results']","icon":"@iconlib.ActionsVisibleGrey","tooltip":"@lang.['v1','View']","actionOnClick":["@actions.isFinalEvidence","@actions.openFinalEvidenceNSP"],"type":"buttonIcon"}]},"gridRefreshId":"finalEvidenceDataGrid","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"tableHeader":[{"name":"@lang.['co2','Captured On']","options":{"type":"datetime","showLabel":true},"key":"finalEvidenceCapturedTime"},{"name":"@lang.['cb1','Captured By']","options":{"showLabel":true},"key":"submittedBy"},{"name":"@lang.['pp2','Photo Preview']","options":{"hidden":false,"showLabel":true},"type":"thumbnail","key":"finalEvidence","fileType":"JPG"},{"name":"@lang.['n3','Notes']","options":{"showLabel":true},"key":"finalEvidenceNotes"}],"dataSourceId":"query/read","jslib":{},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['fer','Final Evidence Recorded']"},"updateAllowed":true,"isSelectable":false,"actions":[{"name":"openFinalEvidenceNSP","type":"openPanel","pageId":"0BFEEOE9ON"},{"name":"isFinalEvidence","type":"script","actionDef":"function(pageContext){ pageContext.isFinalEvidence=true; pageContext.isInitialEvidence=false;}"}],"searchKeys":["submittedBy"],"multiSelect":false}}],"label":"","id":"finalEvidenceGrid","type":"section","transparent":true},{"children":[{"readOnly":true,"id":"notes","label":"@lang.['n3','Notes']","placeholder":"@lang.['blank4','-']","type":"input","value":"@pageContext.finalComments"}],"label":"","id":"notes","type":"section"}],"label":"@lang.['fe1','Final Evidences']","id":"finalEvidence","type":"collapseSection","transparent":true},{"hidden":"@jslib.hasCustomerSignature","children":[{"aspectRation":"","disabled":true,"id":"","type":"image","value":"@pageContext.customerSignature"}],"id":"CustomerSignature","label":"@lang.['customerSignature','Customer Signature']","type":"section"},{"children":[{"readOnly":true,"id":"approvedBy","label":"@lang.['ab','Approved by (Optional)']","placeholder":"@lang.['ab','Approved by (Optional)']","type":"input","value":"@pageContext.approvedBy"}],"id":"","label":"","type":"section"}],"label":"@lang.['tr3','Task Results']","type":"tab"},{"children":[{"children":[{"hidden":"@jslib.isAssignedUserHidden","disabled":true,"id":"technicianList","label":"@lang.['t2','Technician']","type":"input","value":"@pageContext.userName"},{"hidden":"@jslib.isAssignedCrewHidden","disabled":true,"id":"assignedCrew","label":"@lang.['ac1','Assigned Crew']","type":"input","value":"@pageContext.crewName"}],"id":"taskResult","label":"@lang.['a4','Assignee']","type":"section"},{"children":[{"disabled":true,"id":"workOrderTaskId","label":"@lang.['taskId','Task ID']","type":"input","value":"@pageContext.workOrderTaskId"},{"disabled":true,"id":"taskTypeName","label":"@lang.['taskType','Task Type']","type":"input","value":"@pageContext.taskTypeName"},{"disabled":true,"id":"workOrderTaskWorkOrderId","label":"@lang.['WorkOrderId','Work Order ID']","type":"input","value":"@pageContext.workOrderTaskWorkOrderId"},{"disabled":true,"id":"workOrderTypeName","label":"@lang.['wot1','Work Order Type']","type":"input","value":"@pageContext.workOrderTypeName"},{"disabled":true,"id":"ZPriorityName","label":"@lang.['priority','Priority']","type":"input","value":"@pageContext.ZPriorityName"},{"disabled":true,"id":"siteName","label":"@lang.['cs','Customer Site']","type":"input","value":"@pageContext.siteName"},{"disabled":true,"inputType":"text","id":"workOrderTaskNotes","label":"@lang.['n2','Notes (Optional)']","type":"textarea","value":"@pageContext.workOrderTaskNotes","placeHolder":"@lang.['en','Enter Notes (Optional)']"}],"id":"taskDetails","label":"@lang.['taskDetails','Task Details']","type":"section"},{"children":[{"children":[{"children":[{"isRequired":true,"minDate":"1970-01-01 00:00","readOnly":true,"id":"scheduledStartDate","label":"@lang.['ssd1','Scheduled Start Date']","title":"@lang.['ssd1','Scheduled Start Date']","type":"absoluteDate","value":"@pageContext.scheduledStartDateAbsolute","placeHolder":"@lang.['sd8','Select date']"}],"flex":"3","type":"column"},{"children":[{"isRequired":true,"minDate":"1970-01-01 00:00","readOnly":true,"id":"scheduledEndDate","label":"@lang.['sed1','Scheduled End Date']","title":"@lang.['sed1','Scheduled End Date']","type":"absoluteDate","value":"@pageContext.scheduledEndDateAbsolute","placeHolder":"@lang.['sd8','Select date']"}],"flex":"3","type":"column"}],"id":"scheduledStartEndDateRow","type":"row"},{"children":[{"children":[{"isRequired":true,"readOnly":true,"id":"scheduledStartTime","label":"@lang.['sst','Scheduled Start Time']","title":"@lang.['sst','Scheduled Start Time']","type":"absoluteTime","value":"@pageContext.scheduledStartTimeAbsolute","placeHolder":"@lang.['st1','Select time']"}],"flex":"3","type":"column"},{"children":[{"isRequired":true,"readOnly":true,"id":"scheduledEndTime","label":"@lang.['set1','Scheduled End Time']","title":"@lang.['set1','Scheduled End Time']","type":"absoluteTime","value":"@pageContext.scheduledEndTimeAbsolute","placeHolder":"@lang.['st1','Select time']"}],"flex":"3","type":"column"}],"id":"scheduledStartEndTimeRow","type":"row"},{"hidden":"@jslib.isAppointmentWindowHidden","children":[{"children":[{"readOnly":true,"id":"appointmentWindowStart","label":"@lang.['aws','Appointment Window Start']","title":"@lang.['aws','Appointment Window Start']","type":"datetime","value":"@pageContext.workOrderTaskAppointmentWindowStartDate"}],"flex":"3","type":"column"},{"children":[{"readOnly":true,"id":"appointmentWindowEnd","label":"@lang.['awe','Appointment Window End']","title":"@lang.['awe','Appointment Window End']","type":"datetime","value":"@pageContext.workOrderTaskAppointmentWindowEndDate"}],"flex":"3","type":"column"}],"id":"appointmentWindowRow","type":"row"},{"readOnly":true,"id":"workOrderTaskEstimatedDuration","label":"@lang.['etd1','Estimated Task Duration (Minutes)']","type":"input","value":"@pageContext.workOrderTaskEstimatedDurationMinutes"}],"id":"originalSchedule","label":"@lang.['os','Original Schedule']","type":"collapseSection"},{"children":[{"id":"updateScheduleBreakdown","type":"dataGrid","jsonDef":{"actionOnLoad":["@actions.initialData","@actions.enableDataGrid"],"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.taskScheduleBreakdown"}},"isScrollAble":false,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{},"jslib":{},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['sb1','Schedule Breakdown']","children":[]},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSelectable":false,"actions":[{"name":"enableDataGrid","type":"script","actionDef":"function(pageContext){pageContext.enable=true;}"},{"name":"initialData","type":"script","actionDef":"function (pageContext) { pageContext.initialworkOrderTaskId = pageContext.workOrderTaskId; pageContext.initialWorkOrderTaskTaskTypeId = pageContext.workOrderTaskTaskTypeId; pageContext.initialtaskTypeEstimatedDuration = pageContext.workOrderTaskEstimatedDuration; pageContext.initialSiteId = pageContext.workOrderTaskSiteId; pageContext.initialSiteAddress = pageContext.siteAddress; pageContext.initialWorkOrderTaskNotes = pageContext.workOrderTaskNotes; pageContext.initialWorkOrderTaskScheduledDate = pageContext.workOrderTaskScheduledDate; pageContext.workOrderTaskTaskTypeId = pageContext.workOrderTaskTaskTypeId; pageContext.initialWorkOrderTaskService = pageContext.workOrderTaskService; pageContext.taskTypeService = ''; if (typeof pageContext.hideDataGrid === 'undefined' || pageContext.hideDataGrid === ''){pageContext.hideDataGrid = true;} "}],"tableHeader":[{"name":"@lang.['scheduledDate','Scheduled Date']","options":{"type":"date","showLabel":true},"key":"startDate"},{"name":"@lang.['st7','Start Time']","options":{"type":"time","showLabel":true},"key":"startDate"},{"name":"@lang.['endTime','End Time']","options":{"type":"time","showLabel":true},"key":"endDate"},{"name":"@lang.['dh1','Duration(In Hours)']","options":{"showLabel":true},"key":"durationInHours"}],"searchKeys":[]}}],"label":"","id":"taskScheduleBreakdown","type":"section","transparent":true},{"hidden":"@jslib.isActivityHidden","children":[{"children":[{"children":[{"isRequired":true,"minDate":"1970-01-01 00:00","readOnly":true,"id":"actualStartDate","label":"@lang.['asd','Actual Start Date']","title":"@lang.['asd','Actual Start Date']","type":"absoluteDate","value":"@pageContext.actualStartDateAbsolute","placeHolder":"@lang.['sd8','Select date']"}],"flex":"3","type":"column"},{"children":[{"isRequired":true,"minDate":"1970-01-01 00:00","readOnly":true,"id":"actualEndDate","label":"@lang.['aed','Actual End Date']","title":"@lang.['aed','Actual End Date']","type":"absoluteDate","value":"@pageContext.actualEndDateAbsolute","placeHolder":"@lang.['sd8','Select date']"}],"flex":"3","type":"column"}],"id":"actualStartEndDateRow","type":"row"},{"children":[{"children":[{"isRequired":true,"readOnly":true,"id":"actualStartTime","label":"@lang.['ast1','Actual Start Time']","title":"@lang.['ast1','Actual Start Time']","type":"absoluteTime","value":"@pageContext.actualStartTimeAbsolute","placeHolder":"@lang.['st1','Select time']"}],"flex":"3","type":"column"},{"children":[{"isRequired":true,"readOnly":true,"id":"actualEndTime","label":"@lang.['aet','Actual End Time']","title":"@lang.['aet','Actual End Time']","type":"absoluteTime","value":"@pageContext.actualEndTimeAbsolute","placeHolder":"@lang.['st1','Select time']"}],"flex":"3","type":"column"}],"id":"actualStartEndTimeRow","type":"row"},{"readOnly":true,"id":"actualTaskDuration","label":"@lang.['atd','Actual Task Duration (Minutes)']","type":"input","value":"@pageContext.actualTaskDuration"}],"id":"actualSchedule","label":"@lang.['as','Actual Schedule']","type":"collapseSection"},{"hidden":"@jslib.istravelDetailsHidden","children":[{"readOnly":true,"id":"startTravelAt","title":"@lang.['sta','Started travelling at']","type":"datetime","value":"@pageContext.startTravelAt"},{"readOnly":true,"id":"transportMode","label":"@lang.['modeOfTransport','Mode of Transport']","type":"input","value":"@pageContext.transportMode"},{"readOnly":true,"id":"estimatedArrivalTime","title":"@lang.['etoaacs','Estimated Time of Arrival at Customer Site']","type":"datetime","value":"@pageContext.estimatedArrivalTime","hoverText":{"title":"@lang.['cbotmotubtt','Calculated based on the Mode of Transport used by the Technician']"}},{"hidden":"@jslib.isShowActualStartTime","readOnly":true,"id":"actualArrivalTime","title":"@lang.['atoaacacs','Actual Time of Arrival and Check In at Customer Site']","type":"datetime","value":"@pageContext.actualStartTime"},{"readOnly":true,"id":"startedTravelFrom","label":"@lang.['stf2','Started travelling from']","type":"input","value":"@pageContext.startAddress"},{"readOnly":true,"id":"customerSite","label":"@lang.['cs','Customer Site']","type":"input","value":"@pageContext.siteName"},{"readOnly":true,"id":"endAddress","label":"@lang.['address','Address']","type":"input","value":"@pageContext.siteAddress"}],"label":"@lang.['td2','Travel Details']","id":"taskTravelDetails","type":"collapseSection"},{"hidden":"@jslib.isDependencyOverrideHidden","children":[{"readOnly":true,"id":"workOrderTaskOverrideReason","label":"@lang.['rfopd','Reason for overriding pending dependency']","type":"input","value":"@pageContext.workOrderTaskOverrideReason"},{"readOnly":true,"id":"workOrderTaskOverrideComment","label":"@lang.['c4','Comments']","type":"input","value":"@pageContext.workOrderTaskOverrideComment"}],"id":"dependencyOverride","label":"@lang.['do','Dependency Override']","type":"section"},{"hidden":"@jslib.isHiddenDependencyDatagrid","children":[{"label":"","id":"dependenciesDataGrid","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.taskDependencyData"}},"isScrollAble":true,"tableWidth":"60rem","jslib":{},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['td3','Task Dependencies']"},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSelectable":false,"dataSource":[],"actions":[],"tableHeader":[{"name":"@lang.['t7','Tasks']","options":{"flex":0.8,"showLabel":true},"key":"taskDependencyPrecedentTask"},{"name":"@lang.['c26','Condition']","options":{"flex":0.6,"sortOrder":"ASC","sortable":false,"showLabel":true},"key":"taskDependencyEnforceAllDependency"},{"name":"@lang.['s','Status']","options":{"flex":0.55,"sortOrder":"ASC","sortable":false,"showLabel":true},"key":"taskDependencyPrecedentStatusName"},{"name":"@lang.['dt5','Dependent Tasks']","options":{"flex":0.8,"showLabel":true},"key":"taskDependencyDependentTask"},{"name":"@lang.['ds3','Dependent Status']","options":{"flex":0.55,"sortOrder":"ASC","sortable":false,"showLabel":true},"key":"taskDependencyDependentStatusName"}],"searchKeys":[]}}],"id":"dependencies","label":"@lang.['d27','Dependencies']","type":"section","transparent":true}],"label":"@lang.['taskDetails','Task Details']","type":"tab"},{"hidden":"@jslib.isWorkOrderTaskCancelledHidden","children":[{"children":[{"minDate":"1970-01-01 12:00","disabled":true,"id":"workOrderTaskCancelledOn","title":"@lang.['co1','Cancelled On']","type":"datetime","value":"@pageContext.workOrderTaskCancelledDate"},{"disabled":true,"id":"workOrderTaskCancelledBy","label":"@lang.['cb','Cancelled By']","placeholder":"@lang.['cb','Cancelled By']","type":"input","value":"@pageContext.workOrderTaskCancelledBy"},{"disabled":true,"id":"workOrderTaskCancellationReason","label":"@lang.['cr','Cancellation Reason']","placeholder":"@lang.['er1','Enter reason']","type":"input","value":"@pageContext.workOrderTaskCancellationReasonData"},{"disabled":true,"inputType":"text","id":"cancellationNotes","label":"@lang.['n3','Notes']","type":"textarea","value":"@pageContext.workOrderTaskCancellationNotes","placeHolder":"@lang.['en2','Enter notes']"}],"id":"cancellationsResult","type":"section"}],"label":"@lang.['cr2','Cancellation Result']","type":"tab"},{"children":[{"children":[{"disabled":true,"id":"customerCompanyName","label":"@lang.['customer','Customer']","type":"input","value":"@pageContext.customerCompanyName"},{"disabled":true,"id":"customerContactPerson","label":"@lang.['cpn','Contact Person Name']","type":"input","value":"@pageContext.customerContactPerson"},{"disabled":true,"id":"customerContactTitle","label":"@lang.['ct3','Contact Title']","type":"input","value":"@pageContext.customerContactTitle"},{"disabled":true,"id":"customerContactPhone","label":"@lang.['cp','Contact Phone']","type":"phoneNumber","value":"@pageContext.customerContactPhone"},{"disabled":true,"id":"customerContactEmail","label":"@lang.['ce','Contact Email']","type":"input","value":"@pageContext.customerContactEmail"}],"id":"customer","label":"@lang.['cd3','Customer Details']","type":"section"},{"children":[{"disabled":true,"id":"siteName","label":"@lang.['cs','Customer Site']","type":"input","value":"@pageContext.siteName"},{"disabled":true,"id":"siteAddress","label":"@lang.['address','Address']","type":"address","value":"@pageContext.siteAddress"},{"disabled":true,"id":"siteRegion","label":"@lang.['r1','Region']","type":"input","value":"@pageContext.regionName"},{"mapElementStyle":{"width":"100%","height":"14rem"},"defaultZoom":17,"preserveViewport":true,"location":[{"coordinates":"@pageContext.coordinates","icon":"https://cdn.zeplin.io/5be3ee39a464fd7e89ffaaa0/assets/57BF1B12-69E2-4E77-881C-A53900EB4260.svg","type":"Point"}],"id":"mapForShowStatic","type":"map","renderType":"location","mapElementHeight":"100%","mapJson":{}}],"id":"location","label":"@lang.['l3','Location']","type":"section"}],"label":"@lang.['sd3','Site Details']","type":"tab"},{"hidden":false,"children":[{"hidden":"@jslib.isAssignedCrewHidden","children":[{"readOnly":true,"id":"assignedCrew","label":"@lang.['ac1','Assigned Crew']","type":"input","value":"@pageContext.crewName"}],"id":"crewName","label":"","type":"section"},{"hidden":"@jslib.isAssignedUserHidden","children":[{"readOnly":true,"id":"assignee","label":"@lang.['a4','Assignee']","type":"input","value":"@pageContext.userName"},{"readOnly":true,"id":"phoneNumber","label":"@lang.['phoneNumber','Phone Number']","type":"input","value":"@pageContext.userPhoneNumber"},{"readOnly":true,"id":"email","label":"@lang.['e4','Email']","type":"input","value":"@pageContext.userEmail"}],"id":"singleAttendance","label":"@lang.['ca','Current Assignee']","type":"section"},{"hidden":"@jslib.isAssignedCrewHidden","children":[{"label":"","id":"crewMembers","type":"dataGrid","jsonDef":{"isScrollAble":true,"searchAllowed":true,"tableWidth":"80rem","searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsVisiblePurple","hidden":{"checkInType":[false]},"name":"@lang.['va1','View Attendance']","tooltip":"@lang.['va1','View Attendance']","icon":"@iconlib.ActionsVisibleGrey","actionOnClick":["@actions.openViewCrewDataSidePanel"],"type":"buttonIcon"}]},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"tableHeader":[{"name":"@lang.['n','Name']","options":{"flex":1,"showLabel":true},"key":"userName"},{"name":"@lang.['c27','Crew']","options":{"flex":1,"showLabel":true},"key":"crewName"},{"name":"@lang.['e4','Email']","options":{"flex":1.5,"showLabel":true},"key":"userEmail"},{"name":"@lang.['pn','Phone Number']","options":{"flex":1,"showLabel":true},"key":"userPhoneNumber"},{"name":"@lang.['checkIn','Check In']","options":{"flex":1,"type":"dateTime","showLabel":true},"key":"checkIn"},{"name":"@lang.['checkOut','Check Out']","options":{"flex":1,"type":"dateTime","showLabel":true},"key":"checkOut"},{"name":"@lang.['r8','Role']","options":{"flex":1,"showLabel":true},"key":"crewRole"},{"name":"@lang.['mci','Manual Check In']","options":{"flex":1,"showLabel":true},"key":"manualCheckIn"},{"name":"@lang.['cit','Check In Type']","options":{"hidden":true,"flex":1,"showLabel":false},"key":"checkInType"}],"dataToBeSent":{"apiResponseParams":["count"],"processId":"workOrderTaskCrewDataWF","apiResponseFormat":true,"contextVar":{"responseGrid":"crewAttendance","workOrderTaskId":"@pageContext.workOrderTaskId"},"apiResponseObject":"crewAttendance"},"dataSourceId":"process/start","sourceType":"api","header":{"filterAllowed":true,"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['cm','Crew Members']"},"isSelectable":false,"updateAllowed":true,"actions":[{"name":"openViewCrewDataSidePanel","type":"openPanel","pageId":"97DNWZDQMO"}],"searchKeys":["userName"]}}],"id":"crewMembers","label":"@lang.['a10','Assignees']","type":"section","transparent":true},{"hidden":"@jslib.isAssignedUserHidden","children":[{"label":"","id":"singleTechAttendanceHistoryDataGrid","type":"dataGrid","jsonDef":{"isScrollAble":true,"searchAllowed":true,"tableWidth":"80rem","searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsVisiblePurple","hidden":{"checkInType":[false]},"name":"@lang.['vd','View Details']","tooltip":"@lang.['vd','View Details']","icon":"@iconlib.ActionsVisibleGrey","actionOnClick":["@actions.openCheckInDetailsNNSP"],"type":"buttonIcon"}]},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"tableHeader":[{"name":"@lang.['checkIn','Check In']","options":{"flex":1,"type":"dateTime","showLabel":true},"key":"checkInTime"},{"name":"@lang.['checkOut','Check Out']","options":{"flex":1,"type":"dateTime","showLabel":true},"key":"checkOutTime"},{"name":"@lang.['au1','Address Updated']","options":{"flex":1,"showLabel":true},"key":"addressUpdated"},{"name":"@lang.['ul','Updated Location']","options":{"flex":1,"showLabel":true},"key":"location"},{"name":"@lang.['n','Name']","options":{"flex":1,"showLabel":true},"key":"userName"},{"name":"@lang.['e4','Email']","options":{"flex":1.5,"showLabel":true},"key":"userEmail"},{"name":"@lang.['phoneNumber','Phone Number']","options":{"flex":1,"showLabel":true},"key":"userPhoneNumber"},{"name":"@lang.['cit','Check In Type']","options":{"hidden":true,"flex":1,"showLabel":false},"key":"checkInType"}],"dataToBeSent":{"apiResponseParams":["count"],"processId":"workOrderTaskCrewDataWF","apiResponseFormat":true,"contextVar":{"responseGrid":"currentAssigneeAddendance","workOrderTaskId":"@pageContext.workOrderTaskId"},"apiResponseObject":"currentAssigneeAddendance"},"dataSourceId":"process/start","sourceType":"api","header":{"filterAllowed":true,"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['ah2','Attendance History']"},"isSelectable":false,"updateAllowed":true,"actions":[{"name":"openCheckInDetailsNNSP","type":"openPanel","pageId":"B0F4A2FXUE"}],"searchKeys":["userName"]}}],"id":"currentAssigneeAttendance","label":"@lang.['aoca','Attendance Of Current Assignees']","type":"section","transparent":true},{"hidden":"@jslib.isPreviousAssigneeHidden","children":[{"label":"","id":"previousAssigneeGridData","type":"dataGrid","jsonDef":{"isScrollAble":true,"searchAllowed":true,"tableWidth":"80rem","searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsVisiblePurple","hidden":{"checkInType":[false]},"name":"@lang.['va1','View Attendance']","tooltip":"@lang.['va1','View Attendance']","icon":"@iconlib.ActionsVisibleGrey","actionOnClick":["@actions.openCheckInDetailsNNSP"],"type":"buttonIcon"}]},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"tableHeader":[{"name":"@lang.['n','Name']","options":{"flex":1,"showLabel":true},"key":"userName"},{"name":"@lang.['e4','Email']","options":{"flex":1.5,"showLabel":true},"key":"userEmail"},{"name":"@lang.['phoneNumber','Phone Number']","options":{"flex":1,"showLabel":true},"key":"userPhoneNumber"},{"name":"@lang.['checkIn','Check In']","options":{"flex":1,"type":"dateTime","showLabel":true},"key":"checkInTime"},{"name":"@lang.['checkOut','Check Out']","options":{"flex":1,"type":"dateTime","showLabel":true},"key":"checkOutTime"},{"name":"@lang.['au1','Address Updated']","options":{"flex":1,"showLabel":true},"key":"addressUpdated"},{"name":"@lang.['cit','Check In Type']","options":{"hidden":true,"flex":1,"showLabel":false},"key":"checkInType"}],"dataToBeSent":{"apiResponseParams":["count"],"processId":"workOrderTaskCrewDataWF","apiResponseFormat":true,"contextVar":{"responseGrid":"previousAssignees","workOrderTaskId":"@pageContext.workOrderTaskId"},"apiResponseObject":"previousAssignees"},"dataSourceId":"process/start","sourceType":"api","header":{"filterAllowed":true,"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['pa2','Previous Assignees']"},"isSelectable":false,"updateAllowed":true,"actions":[{"name":"openCheckInDetailsNNSP","type":"openPanel","pageId":"97DNWZDQMO"}],"searchKeys":["userName"]}}],"id":"previousAssignee","label":"@lang.['pa2','Previous Assignees']","type":"section","transparent":true}],"label":"@lang.['a11','Attendance']","type":"tab"},{"children":[{"children":[{"label":"","id":"priceListItemsGridData","type":"dataGrid","jsonDef":{"isScrollAble":true,"searchAllowed":true,"tableWidth":"80rem","searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsVisiblePurple","name":"@lang.['v1','View']","tooltip":"@lang.['v1','View']","icon":"@iconlib.ActionsVisibleGrey","actionOnClick":["@actions.openPriceListItemDetailsNSP"],"type":"buttonIcon"}]},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"tableHeader":[{"name":"@lang.['m','Manufacturer']","options":{"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"manufacturerName"},{"name":"@lang.['mn','Model Name']","options":{"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"modelName"},{"name":"@lang.['mn1','Model Number']","options":{"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"modelNumber"},{"name":"@lang.['t5','Type']","options":{"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"catalogType"},{"name":"@lang.['quantityUsed','Quantity Used']","options":{"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"actualQty"},{"name":"@lang.['eq1','Estimated Quantity']","options":{"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"estimatedQty"}],"dataToBeSent":{"apiResponseParams":["count"],"processId":"X6AMXTO0IH","apiResponseFormat":true,"contextVar":{"statusFilter":"@pageContext.statusId","workOrderTaskId":"@pageContext.workOrderTaskId","workOrderId":"@pageContext.workOrderId"},"apiResponseObject":"workOrderTaskIventoryData"},"dataSourceId":"process/start","sourceType":"api","header":{"filterAllowed":true,"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['pam','Parts and Materials']"},"isSelectable":false,"updateAllowed":true,"actions":[{"name":"openPriceListItemDetailsNSP","type":"openPanel","pageId":"J0JIXTOPCX"}],"searchKeys":["modelName"]}}],"id":"priceListItemsSection","label":"","type":"section","transparent":true}],"label":"@lang.['pr1','Part Requirements']","type":"tab"},{"hidden":"@jslib.isIncidentReportHidden","children":[{"children":[{"id":"incidentReports","type":"dataGrid","jsonDef":{"isScrollAble":true,"searchAllowed":false,"tableWidth":"70rem","rowActions":{"children":[{"activeIcon":"@iconlib.ActionsVisiblePurple","name":"@lang.['t1','taskView']","icon":"@iconlib.ActionsVisibleGrey","tooltip":"@lang.['v1','View']","actionOnClick":["@actions.openIncidentDetailsSidePanel"],"type":"buttonIcon"}]},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"tableHeader":[{"name":"@lang.['it','Incident Type']","options":{"flex":1.5,"sortable":false,"showLabel":true},"key":"incidentType","primaryKey":true},{"name":"@lang.['r5','Reason']","options":{"flex":1.5,"sortable":false,"showLabel":true},"key":"travelIncidentReason"},{"name":"@lang.['st9','Submission Time']","options":{"flex":1.5,"sortable":false,"type":"dateTime","showLabel":true},"key":"reportIssueCapturedTime"},{"name":"@lang.['action','Action']","options":{"flex":1.5,"sortable":false,"showLabel":true},"key":"reportIssueType"},{"name":"@lang.['dm','Delay (In Minutes)']","options":{"flex":1.5,"sortable":false,"showLabel":true},"key":"taskDelay"}],"dataToBeSent":{"apiResponseParams":["count"],"processId":"workorderTaskIncidentReportWF","apiResponseFormat":true,"contextVar":{"workOrderTaskId":"@pageContext.workOrderTaskId"},"apiResponseObject":"incidentReportsData"},"dataSourceId":"process/start","sourceType":"api","header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['il','Incident Logs']"},"isSelectable":false,"updateAllowed":true,"actions":[{"name":"openIncidentDetailsSidePanel","type":"openPanel","pageId":"UGWILUCH1E"}],"searchKeys":[]}}],"id":"incidentReports","type":"section","transparent":true}],"label":"@lang.['il','Incident Logs']","type":"tab"},{"children":[{"children":[{"id":"workOrderTaskLogs","type":"dataGrid","jsonDef":{"isScrollAble":false,"searchAllowed":true,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"tableWidth":"50rem","rowActions":{},"gridRefreshId":"logsGridId","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"tableHeader":[{"name":"@lang.['timeStamp','Time Stamp']","options":{"flex":1.5,"sortOrder":"DESC","sortable":true,"type":"datetime","showLabel":true},"key":"workOrderTaskLogLogDate"},{"name":"@lang.['e10','Event']","options":{"flex":1.5,"sortOrder":"DESC","sortable":true,"showLabel":true},"key":"listOptionAnswerAnswerOptionText"},{"name":"@lang.['mb1','Modified By']","options":{"flex":1.5,"sortOrder":"DESC","sortable":true,"showLabel":true},"key":"userName"},{"name":"@lang.['details','Details']","options":{"flex":2,"showLabel":true},"key":"workOrderTaskLogDetails"},{"name":"@lang.['i','id']","options":{"hidden":true,"showLabel":false},"key":"workOrderTaskLogId","primaryKey":true}],"dataToBeSent":{"filter":"{$workOrderTaskLog.workOrderTaskId} = {@selectedWorkOrderTaskId} AND {$listOptionAnswer.listOptionId}='workOrderTaskLogEvents'","models":["workOrderTaskLog","User","listOptionAnswer"],"columns":{"workOrderTaskLogLogDate":"workOrderTaskLog.logDate","workOrderTaskLogId":"workOrderTaskLog.id","workOrderTaskLogDetails":"workOrderTaskLog.details","listOptionAnswerAnswerOptionText":"listOptionAnswer.answerOptionText","userName":"User.name"},"inputs":{"selectedWorkOrderTaskId":"@pageContext.workOrderTaskId"},"orderBy":"workOrderTaskLogLogDate DESC","outerJoinOnModel":"workOrderTaskLog","links":{"listOptionAnswer":"workOrderTaskLog","workOrderTaskLog":"User"},"translate":true},"dataSourceId":"query/read","jslib":{},"rowTextLength":40,"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['tl','Task Logs']","children":[]},"isSelectable":false,"dataSource":[],"actions":[],"searchKeys":["listOptionAnswerAnswerOptionText","userName"],"multiSelect":false}}],"label":"","id":"workOrderTaskLogSection","type":"section","transparent":true}],"label":"@lang.['navl','Logs']","type":"tab"}],"label":"","type":"tab"}]},"actions":[{"endPoint":"event/start","name":"fireProcessEventForTaskSchedulingAndAssignFetchData","outputVarMap":{"data":"@pageContext.workOrderTaskData"},"type":"api","continueOnError":true,"actionDef":{"data":[{"eventId":"NN3OQ58980","inputVar":{},"apiResponseFormat":true,"contextVar":{"statusId":"@pageContext.status","workOrderTaskId":"@pageContext.workOrderTaskId","workOrderId":"@pageContext.workOrderId","viewTravelStatus":"@pageContext.viewTravelStatus"}}]}},{"name":"clearPageContext","type":"clearPageContext"},{"name":"closePanel","type":"closePanel"},{"name":"openPreviousPanel","type":"backPanel","pageId":"8L04RP7A7D"},{"name":"openApproveNSP","type":"openPanel","pageId":"0650A2FJ18"},{"endPoint":"event/start","name":"fireProcessEventForTaskReviewFetchData","outputVarMap":{"data":"@pageContext.responseData"},"type":"api","actionDef":{"data":[{"eventId":"LHCUF48WQB","contextVar":{"statusId":"@pageContext.status","workOrderTaskId":"@pageContext.workOrderTaskId","workOrderId":"@pageContext.workOrderId","viewTravelStatus":"@pageContext.viewTravelStatus"}}]}},{"endPoint":"event/start","name":"fireProcessEventForWorkOrderTaskDelete","type":"api","actionDef":{"data":[{"eventId":"BM58GU7UNT","contextVar":{"workOrderTask":{"recver":"@pageContext.workOrderTaskRecver","id":"@pageContext.workOrderTaskId"},"subAction":"deleteWorkOrderTask"}}]}},{"subTitle":"@lang.['aysywtctt','Are you sure you want to cancel this task?']","name":"cancelTaskModal","options":[{"buttonType":"secondary","name":"no","actionOnClick":"@actions.closeModal","type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.closeModal","@actions.openCancelTaskNestedSidePanel"],"type":"button","title":"@lang.['yp','Yes, Proceed']"}],"type":"openModal","title":"@lang.['ct4','Cancel Task']"},{"name":"setActionApproveTask","type":"script","actionDef":"function(pageContext) {pageContext.taskReviewResult = 'approve';}"},{"name":"setActionRejectTask","type":"script","actionDef":"function(pageContext) {pageContext.taskReviewResult = 'reject';}"},{"name":"refreshDataGrid","type":"refreshDataGrid"},{"name":"processResponseData","type":"script","actionDef":"function(pageContext) { for (var i = 0; i < pageContext.responseData[0].data[0].workOrderTaskData.length; i++) { if (typeof pageContext.responseData[0].data[0].workOrderTaskData[i].taskDependencyData !== 'undefined' && pageContext.responseData[0].data[0].workOrderTaskData[i].taskDependencyData.length > 0) { pageContext.taskDependencyData = pageContext.responseData[0].data[0].workOrderTaskData[i].taskDependencyData; } if (typeof pageContext.responseData[0].data[0].workOrderTaskData[i].previousAssignees !== 'undefined' && pageContext.responseData[0].data[0].workOrderTaskData[i].previousAssignees.length > 0) { pageContext.previousAssignees = pageContext.responseData[0].data[0].workOrderTaskData[i].previousAssignees; } if (typeof pageContext.responseData[0].data[0].workOrderTaskData[i].taskScheduleBreakdown != 'undefined' && pageContext.responseData[0].data[0].workOrderTaskData[i].taskScheduleBreakdown.length > 0) { pageContext.taskScheduleBreakdown = pageContext.responseData[0].data[0].workOrderTaskData[i].taskScheduleBreakdown; } if (typeof pageContext.responseData[0].data[0].workOrderTaskData != 'undefined' && pageContext.responseData[0].data[0].workOrderTaskData.length > 0) { pageContext.workOrderTaskData = pageContext.responseData[0].data[0].workOrderTaskData; } if (typeof pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData !== 'undefined' && pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData !== '') { if (typeof pageContext.responseData !== 'undefined' && pageContext.responseData !== '') { if (Array.isArray(pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskResult) && pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskResult.length > 0) { pageContext.workOrderTaskResult = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskResult; if (typeof pageContext.workOrderTaskResult[0].overrideReason !== 'undefined' && pageContext.workOrderTaskResult[0].overrideReason !== '') { pageContext.workOrderTaskOverrideReason = pageContext.workOrderTaskResult[0].overrideReason.reason; pageContext.workOrderTaskOverrideComment = pageContext.workOrderTaskResult[0].overrideReason.comment; } } if (typeof pageContext.workOrderTaskResult !== 'undefined' && pageContext.workOrderTaskResult.length > 0) { for (var j = 0; j < pageContext.workOrderTaskResult.length; j++) { if (typeof pageContext.workOrderTaskResult[j].submitType !== 'undefined' && pageContext.workOrderTaskResult[j].submitType !== '' && pageContext.workOrderTaskResult[j].submitType === 'endTask') { pageContext.customerSignature = pageContext.workOrderTaskResult[j].customerSignature; if (typeof pageContext.workOrderTaskResult[j].approvedBy !== 'undefined') { pageContext.approvedBy = pageContext.workOrderTaskResult[j].approvedBy; } else { pageContext.approvedBy = '-'; } } } } else { pageContext.approvedBy = '-'; pageContext.customerSignature = ''; } pageContext.workOrderId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskWorkOrderId; pageContext.siteId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.siteId; pageContext.listOption = pageContext.responseData[0].data[0].listOptionData; pageContext.statusId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskStatusId; pageContext.workOrderTaskId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskId; pageContext.incidentDetails = (pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.incidentDetails) ? pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.incidentDetails : ''; pageContext.taskTypeName = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.taskTypeName; pageContext.workOrderTaskWorkOrderId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskWorkOrderId; pageContext.workOrderTypeName = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTypeName; pageContext.ZPriorityName = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.ZPriorityName; pageContext.siteName = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.siteName; pageContext.workOrderTaskNotes = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskNotes; pageContext.workOrderTaskDueDate = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskDueDate; pageContext.workOrderCalendarId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderCalendarId; pageContext.workOrderTaskEstimatedDuration = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskEstimatedDuration; if (typeof pageContext.workOrderTaskEstimatedDuration !== 'undefined' && pageContext.workOrderTaskEstimatedDuration !== '') { pageContext.workOrderTaskEstimatedDurationMinutes = pageContext.workOrderTaskEstimatedDuration * 60; } pageContext.workOrderTaskActualStartTime = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskActualStartTime; pageContext.workOrderTaskCompletedDate = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskCompletedDate; pageContext.workOrderTaskService = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskService; pageContext.actualTaskDuration = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.actualTaskDuration; pageContext.customerContactPerson = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.customerContactPerson; pageContext.customerContactTitle = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.customerContactTitle; pageContext.customerContactPhone = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.customerContactPhone; pageContext.customerContactEmail = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.customerContactEmail; pageContext.siteAddress = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.siteAddress; pageContext.siteLongitude = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.siteLongitude; pageContext.siteLatitude = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.siteLatitude; pageContext.customerCompanyName = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.customerCompanyName; pageContext.workOrderTaskScheduledDate = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskScheduledDate; pageContext.timezoneOffset = new Date().getTimezoneOffset(); pageContext.siteTimezoneOffset = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.siteTimezoneOffset; var addMinutes = function(date) { return (new Date(date.getTime() - (pageContext.timezoneOffset * 60000) - (pageContext.timezoneOffset * 60000))).toISOString().replace('T', ' ').replace('Z', ''); }; if (typeof pageContext.workOrderTaskScheduledDate !== 'undefined' && pageContext.workOrderTaskScheduledDate !== '') { var startDateInAbsolute = addMinutes(new Date(pageContext.workOrderTaskScheduledDate)); pageContext.scheduledStartDateAbsolute = startDateInAbsolute.split(' ')[0]; pageContext.scheduledStartTimeAbsolute = startDateInAbsolute.split(' ')[1]; } if (typeof pageContext.workOrderTaskDueDate !== 'undefined' && pageContext.workOrderTaskDueDate !== '') { var endDateInAbsolute = addMinutes(new Date(pageContext.workOrderTaskDueDate)); pageContext.scheduledEndDateAbsolute = endDateInAbsolute.split(' ')[0]; pageContext.scheduledEndTimeAbsolute = endDateInAbsolute.split(' ')[1]; } if (typeof pageContext.workOrderTaskActualStartTime !== 'undefined' && pageContext.workOrderTaskActualStartTime !== '') { var actualStartInAbsolute = addMinutes(new Date(pageContext.workOrderTaskActualStartTime)); pageContext.actualStartDateAbsolute = actualStartInAbsolute.split(' ')[0]; pageContext.actualStartTimeAbsolute = actualStartInAbsolute.split(' ')[1]; } if (typeof pageContext.workOrderTaskCompletedDate !== 'undefined' && pageContext.workOrderTaskCompletedDate !== '') { var actualEndInAbsolute = addMinutes(new Date(pageContext.workOrderTaskCompletedDate)); pageContext.actualEndDateAbsolute = actualEndInAbsolute.split(' ')[0]; pageContext.actualEndTimeAbsolute = actualEndInAbsolute.split(' ')[1]; } pageContext.workOrderTaskAppointmentBasedFlag = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskAppointmentBasedFlag; pageContext.workOrderTaskAppointmentWindowId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskAppointmentWindowId; pageContext.workOrderTaskAppointmentWindowStartDate = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskAppointmentWindowStartDate; pageContext.workOrderTaskAppointmentWindowEndDate = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskAppointmentWindowEndDate; pageContext.statusNameColor = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.statusNameColor; pageContext.statusName = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.statusName; pageContext.taskTypeMobileProcessId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.taskTypeMobileProcessId; pageContext.taskTypeCrewTask = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.taskTypeCrewTask; pageContext.workOrderTaskAssignedToUserId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskAssignedToUserId; pageContext.workOrderTaskReOpenCount = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskReOpenCount; pageContext.taskTypeWebTask = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.taskTypeWebTask; pageContext.workOrderTaskProcessInstanceId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskProcessInstanceId; pageContext.activityDetails = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.activityDetails; pageContext.workOrderTaskServicesArray = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskServicesArray; pageContext.workOrderTaskRecver = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskRecver; pageContext.regionName = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.regionName; pageContext.siteCustomerId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.siteCustomerId; pageContext.siteRegionId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.siteRegionId; pageContext.customerContactEmail = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.customerContactEmail; pageContext.workOrderDeadline = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderDeadline; pageContext.hideDataGrid = true; pageContext.workOrderTaskStatusTargetModel = 'workOrderTask'; pageContext.userName = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.userName; pageContext.userPhoneNumber = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.userPhoneNumber; pageContext.userEmail = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.userEmail; pageContext.latitude = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.siteLatitude; pageContext.longitude = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.siteLongitude; pageContext.workOrderTaskTaskTypeId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskTaskTypeId; pageContext.workOrderPriorityPriority = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderPriorityPriority; pageContext.initialAssignee = pageContext.workOrderTaskAssignedToUserId; pageContext.initialWorkOrderTaskEstimatedDurationMinutes = pageContext.workOrderTaskEstimatedDurationMinutes; pageContext.initialworkOrderTaskEstimatedDuration = pageContext.workOrderTaskEstimatedDuration; pageContext.initialWorkOrderTaskNotes = pageContext.workOrderTaskNotes; if (typeof pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.crewName !== 'undefined') { pageContext.workOrderTaskAssignedToCrewId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskAssignedToCrewId; pageContext.crewName = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.crewName; pageContext.crewLeadUserName = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.crewName.crewLeadUserName; } if (typeof pageContext.responseData[0].data[0].taskReviewLogData !== 'undefined' && pageContext.responseData[0].data[0].taskReviewLogData !== '' && pageContext.responseData[0].data[0].taskReviewLogData.length > 0) { if (pageContext.status !== 'workOrderTaskPendingReview') { pageContext.taskReviewLogReviewNotes = pageContext.responseData[0].data[0].taskReviewLogData[0].taskReviewLogReviewNotes; } if (pageContext.status === 'workOrderTaskCompleted') { pageContext.taskReviewResult = 'Approve'; } } if (pageContext.taskTypeCrewTask && (typeof pageContext.workOrderTaskAssignedToCrewId !== 'undefined' && pageContext.workOrderTaskAssignedToCrewId !== '')) { pageContext.selectDropdown = []; pageContext.initialAssignee = pageContext.workOrderTaskAssignedToCrewId; pageContext.crewLeadUserId = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.crewLeadUserId; pageContext.selectDropdown.push({ 'value': pageContext.workOrderTaskAssignedToCrewId, 'label': pageContext.crewName }) } else if (typeof pageContext.userName !== 'undefined') { pageContext.selectDropdown = []; pageContext.selectDropdown.push({ 'value': pageContext.workOrderTaskAssignedToUserId, 'label': pageContext.userName }) }; if (pageContext.status === 'workOrderTaskCancelled') { pageContext.workOrderTaskCancellationNotes = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskCancellationNotes; pageContext.workOrderTaskCancellationReasonData = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskCancellationReasonData; pageContext.workOrderTaskCancelledDate = pageContext.responseData[0].data[0].workOrderTaskData[i].workOrderTaskData.workOrderTaskCancelledDate; if (Array.isArray(pageContext.responseData[0].data[0].workOrderTaskCancelled) && pageContext.responseData[0].data[0].workOrderTaskCancelled.length > 0) { pageContext.workOrderTaskCancelledBy = pageContext.responseData[0].data[0].workOrderTaskCancelled[0].cancelledByUserName; } else { pageContext.workOrderTaskCancelledBy = '@lang.[\"atmn\",\"Automation\"]'; } } if (typeof pageContext.workOrderTaskScheduledDate == 'undefined') { pageContext.workOrderTaskScheduledDate = ''; } pageContext.currentDate = new Date().toISOString().replace('T', ' ').replace('Z', ''); pageContext.initialWorkOrderTaskScheduledDate = pageContext.workOrderTaskScheduledDate; if (pageContext.status === 'workOrderTaskDispatched' || pageContext.status === 'workOrderTaskInProgress') { pageContext.isEnabled = false; pageContext.currentDate = pageContext.workOrderTaskScheduledDate; } else if (pageContext.action === 'view') { pageContext.isEnabled = true; pageContext.currentDate = pageContext.workOrderTaskScheduledDate; } if (typeof pageContext.siteLatitude !== 'undefined' && typeof pageContext.siteLongitude !== 'undefined') { pageContext.coordinates = [pageContext.siteLatitude, pageContext.siteLongitude]; } else { pageContext.coordinates = [0, 0]; } } } } }"},{"name":"setTimeZoneAndLocale","type":"script","actionDef":"function (pageContext) { pageContext.timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone; pageContext.userLocale = sessionStorage.getItem('locale');}"},{"falseStep":["@actions.fetchTaskProgressDataByServices"],"trueStep":["@actions.fetchTaskProgressDataByDate"],"name":"decisionActionForFilter","type":"decision","actionDef":"function(pageContext){if( typeof pageContext.dropdown !== 'undefined' && pageContext.dropdown !='' && pageContext.dropdown === 'byDate'){return true;} else {return false;}}"},{"name":"viewChange","type":"script","actionDef":"function (pageContext) { if (typeof pageContext.dropdown !== 'undefined' && pageContext.dropdown !== '') { if (pageContext.dropdown === 'byDate') { pageContext.selectedFilterForView = 'byDate'; pageContext.showSelectedServicesGrid = false;} if (pageContext.dropdown === 'byServices') { pageContext.selectedFilterForView = 'byServices'; pageContext.showInitialEvidenceGrid = false; pageContext.showServicesDeliveredGrid = false; pageContext.showFinalEvidenceGrid=false; } } }"},{"endPoint":"event/start","name":"fetchAllTaskSchedularBreakdownData","outputVarMap":{"data":"@pageContext.taskScheduleBreakdown"},"type":"api","actionDef":{"data":[{"eventId":"workOrderTaskScheduleBreakdownProcessEvent","contextVar":{"calendarId":"@pageContext.workOrderCalendarId","estimatedDuration":"@pageContext.workOrderTaskEstimatedDuration","scheduledStartDate":"@pageContext.workOrderTaskScheduledDate"}}]}},{"name":"openCancelTaskNestedSidePanel","type":"openPanel","pageId":"1RFSG2AF8J"},{"subTitle":"@lang.['aysywtdtttcbu','Are you sure you want to delete this task? This cannot be undone.']","name":"deleteTaskModal","options":[{"buttonType":"secondary","name":"no","actionOnClick":"@actions.closeModal","type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.setSubActionDeleteWorkOrderTask","@actions.fireProcessEventForWorkOrderTaskDelete","@actions.closeModal","@actions.closePanel","@actions.clearPageContext","@actions.refreshDataGrid"],"type":"button","title":"@lang.['d1','Delete']"}],"type":"openModal","title":"@lang.['dt1','Delete Task']"},{"name":"setSubActionDeleteWorkOrderTask","type":"script","actionDef":"function(pageContext){pageContext.subAction='deleteWorkOrderTask';}"},{"async":true,"name":"setTravelDetails","type":"script","actionDef":"function (pageContext) { for (var j = 0; j <  pageContext.responseData[0].data[0].workOrderTaskData.length; j++) {  if (typeof pageContext.responseData[0].data[0].workOrderTaskData[j].originAddress !== 'undefined' && pageContext.responseData[0].data[0].workOrderTaskData[j].originAddress !== '') { pageContext.startTravelAt = pageContext.responseData[0].data[0].workOrderTaskData[j].taskData[0].workOrderTaskStartDate; pageContext.estimatedArrivalTime = pageContext.responseData[0].data[0].workOrderTaskData[j].duration; pageContext.startAddress = pageContext.responseData[0].data[0].workOrderTaskData[j].originAddress; pageContext.customerSite = pageContext.responseData[0].data[0].workOrderTaskData[j].taskData[0].siteName; pageContext.endAddress = pageContext.responseData[0].data[0].workOrderTaskData[j].destinationAddress; if (typeof pageContext.responseData[0].data[0].workOrderTaskData[j].taskData[0].workOrderTaskActualStartTime !== 'undefined') { pageContext.actualStartTime = pageContext.responseData[0].data[0].workOrderTaskData[j].taskData[0].workOrderTaskActualStartTime; } else { pageContext.actualStartTime = ''; } pageContext.transportMode =pageContext.responseData[0].data[0].workOrderTaskData[j].taskData[0].workOrderTaskTravelDetails[0].transportMode; if (pageContext.transportMode == undefined || pageContext.transportMode == '') { pageContext.transportMode = '@lang.[\"d20\",\"Driving\"]'; }; if (pageContext.transportMode != undefined && pageContext.transportMode == '{%b1}') { pageContext.transportMode = '@lang.[\"b1\",\"Bicycling\"]'; }; if (pageContext.transportMode != undefined && pageContext.transportMode == '{%d20}') { pageContext.transportMode = '@lang.[\"d20\",\"Driving\"]'; }; if (pageContext.transportMode != undefined && pageContext.transportMode == '{%w4}') { pageContext.transportMode = '@lang.[\"w4\",\"Walking\"]'; }; } } }"},{"async":true,"name":"calculatedActualTaskDuration","type":"script","actionDef":"function (pageContext) {if (typeof pageContext.workOrderTaskCompletedDate !== 'undefined' && pageContext.workOrderTaskCompletedDate !== '' && pageContext.workOrderTaskActualStartTime !== 'undefined' && pageContext.workOrderTaskActualStartTime !== '' && pageContext.workOrderTaskCompletedDate > pageContext.workOrderTaskActualStartTime) { let startDate = new Date(pageContext.workOrderTaskActualStartTime); let completedDate = new Date(pageContext.workOrderTaskCompletedDate); let diffTime = Math.abs(completedDate - startDate); pageContext.actualTaskDuration = Math.ceil(diffTime / (1000 * 60)); } }"},{"endPoint":"process/start","name":"fetchTaskProgressDataByDate","outputVarMap":{"data":"@pageContext.taskProgressDataByDate"},"type":"api","actionDef":{"data":[{"inputVar":{},"processId":"taskSchedulingDispatchedViewTaskProgressByDateWF","apiResponseFormat":true,"contextVar":{"userLocale":"@pageContext.userLocale","workOrderTaskId":"@pageContext.workOrderTaskId","timeZone":"@pageContext.timeZone"}}]}},{"endPoint":"process/start","name":"fetchTaskProgressDataByServices","outputVarMap":{"data":"@pageContext.taskProgressDataByServices"},"type":"api","actionDef":{"data":[{"inputVar":{},"processId":"taskSchedulingDispatchedViewTaskProgressByServicesWF","apiResponseFormat":true,"contextVar":{"userLocale":"@pageContext.userLocale","workOrderTaskId":"@pageContext.workOrderTaskId","timeZone":"@pageContext.timeZone"}}]}},{"name":"closeModal","type":"closeModal"},{"name":"enableRecordGrid","type":"script","actionDef":"function(pageContext){pageContext.enable=true;}"}]}