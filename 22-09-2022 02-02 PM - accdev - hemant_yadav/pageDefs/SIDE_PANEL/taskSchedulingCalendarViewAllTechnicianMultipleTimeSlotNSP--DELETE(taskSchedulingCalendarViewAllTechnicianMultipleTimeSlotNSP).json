{"pageContext":{},"actionOnLoad":["@actions.setInitialData"],"localPageContext":true,"jslib":{"isSaveDisabled":"function(pageContext){return(!(typeof pageContext.selectedRowIds!=='undefined'&&pageContext.selectedRowIds.length>0)||(typeof pageContext.selectedRowIds!=='undefined'&&pageContext.selectedRowIds.length>0&&typeof pageContext.workOrderTaskAssignedToUserId!=='undefined'&&pageContext.workOrderTaskAssignedToUserId!==''&&pageContext.workOrderTaskAssignedToUserId===pageContext.selectedRowIds[0].workforceUserId));}"},"header":{"leftData":{"children":[{"icon":"@iconlib.NavigationArrowBackGrey","actionOnClick":["@actions.openPreviousPanel"],"id":"back","type":"buttonIcon"}]},"children":[{"buttonType":"primary","actionOnClick":["@actions.storeUserId","@actions.openPreviousPanel"],"disabled":"@jslib.isSaveDisabled","id":"submit","type":"button","title":"Save"}],"title":"Select Assignee"},"body":{"children":[{"children":[{"id":"scheduleBreakdownDataGrid","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.taskScheduleBreakdown"}},"isScrollAble":false,"searchAllowed":false,"jslib":{},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"Schedule Breakdown"},"emptyScreen":{"image":"@iconlib.ActionsSearchGrey","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSelectable":false,"updateAllowed":true,"isSync":true,"actions":[],"tableHeader":[{"name":"Scheduled Date","options":{"type":"date","showLabel":true},"key":"startDate"},{"name":"Start Time","options":{"type":"time","showLabel":true},"key":"startDate"},{"name":"End Time","options":{"type":"time","showLabel":true},"key":"endDate"},{"name":"Duration(In Hours)","options":{"showLabel":true},"key":"durationInHours"}],"searchKeys":[]}}],"id":"scheduleBreakdown","type":"section","transparent":true},{"children":[{"id":"technicianDataGrid","type":"dataGrid","jsonDef":{"isScrollAble":true,"deleteAllowed":false,"searchAllowed":true,"tableWidth":"60rem","searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY']","type":"noData"},"modifyRowActions":[],"emptyScreen":{"image":"@iconlib.ActionsSearchGrey","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"singleSelect":true,"tableHeader":[{"name":"Id","options":{"hidden":true,"showLabel":false},"key":"workforceUserId","primaryKey":true},{"name":"Name","options":{"flex":0.6,"showLabel":true},"key":"userName","primaryKey":true},{"name":"Region","options":{"flex":0.4,"showLabel":true},"key":"regionName"},{"name":"Contractor","options":{"flex":0.6,"showLabel":true},"key":"contractorName"},{"name":"Shift","options":{"flex":0.5,"showLabel":true},"key":"calendarName"},{"name":"Email","options":{"flex":0.8,"showLabel":true},"key":"userEmailId"}],"dataToBeSent":{"apiResponseParams":["count"],"processId":"taskSchedulingAndAssignFetchEligibleTechniciansWF","apiResponseFormat":true,"contextVar":{"workOrderTaskId":"@pageContext.workOrderTaskId"},"apiResponseObject":"technicianList"},"rowsToSelect":{"filter":"{$workforceUserId}={@id}","models":["workforce","User"],"columns":{"workforceUserId":"workforce.userId","userName":"User.name"},"inputs":{"id":"@pageContext.workOrderTaskAssignedToUserId"}},"dataSourceId":"process/start","sourceType":"api","jslib":{"isShowScheduleDisabled":"function(pageContext){ return !(typeof pageContext.selectedRowIds !== 'undefined' && pageContext.selectedRowIds.length > 0); }"},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"All Technicains","children":[{"buttonType":"secondary","actionOnClick":["@actions.setVisibilityTrue","@actions.setWorkforceUserId","@actions.calendarFromAPI","@actions.initialEventsData"],"disabled":"@jslib.isShowScheduleDisabled","id":"getTechnicianSchedule","type":"button","title":"Show Schedule"}]},"isSelectable":true,"actions":[{"name":"setVisibilityTrue","type":"script","actionDef":"function(pageContext){pageContext.hideTechCalendarDetails = false; }"},{"name":"setWorkforceUserId","type":"script","actionDef":"function(pageContext){pageContext.workforceUserId = pageContext.selectedRowIds[0].workforceUserId;}"},{"name":"calendarFromAPI","outputVarMap":{"data":"@pageContext.calendarFromAPIQuery"},"type":"query","actionDef":{"filter":"{$workOrderId} = {$workOrderTaskWorkOrderId} and {$workOrderTaskAssignedToUserId} = {@currentlyAssignedUser} and {$statusTargetModel}='workOrderTask' and {$statusId} IN {@statusFilter} and {$taskType.webTask} = false","models":["taskType","workOrder","workOrderTask","ZStatus","calendar","calendarHoliday","holiday","workforceLeave","listOptionAnswer"],"inputs":{"statusFilter":["workOrderTaskScheduled","workOrderTaskDispatched","workOrderTaskInProgress","workOrderTaskPendingReview","workOrderTaskDiscontinued","workOrderTaskIncident","workOrderTaskInTransit","workOrderTaskDelayed","workOrderTaskCompleted"],"currentlyAssignedUser":"@pageContext.selectedRowIds[0].workforceUserId"},"columns":{"backgroundColor":"ZStatus.colorCode","workOrderTaskAssignedToUserId":"workOrderTask.assignedToUserId","statusTargetModel":"ZStatus.targetModel","workOrderTaskDueDate":"workOrderTask.dueDate","workOrderTaskActualStartTime":"workOrderTask.actualStartTime","statusId":"ZStatus.id","workOrderTaskWorkOrderId":"workOrderTask.workOrderId","statusName":"ZStatus.name","workOrderTaskId":"workOrderTask.id","workOrderTaskEstimatedDuration":"workOrderTask.estimatedDuration","workOrderTaskScheduledDate":"workOrderTask.scheduledDate","workOrderId":"workOrder.id","workOrderTaskCompletedDate":"workOrderTask.completedDate"},"links":{"workOrder":"workOrderTask","taskType":"workOrderTask","ZStatus":"workOrderTask"}}},{"name":"initialEventsData","type":"script","actionDef":"function(pageContext) { var calendarEvents = []; pageContext.calendarFromAPIQuery.forEach((event) => { var events = {}; events['id'] = event.workOrderTaskId; events['title'] = event.workOrderTaskId; if (typeof event.workOrderTaskActualStartTime !== 'undefined' && typeof event.workOrderTaskCompletedDate !== 'undefined') { events['start'] = event.workOrderTaskActualStartTime; events['end'] = event.workOrderTaskCompletedDate; } else if (typeof event.workOrderTaskActualStartTime !== 'undefined' && typeof event.workOrderTaskCompletedDate === 'undefined') { events['start'] = event.workOrderTaskActualStartTime; events['end'] = event.workOrderTaskDueDate; } else if (typeof event.workOrderTaskActualStartTime === 'undefined' && typeof event.workOrderTaskCompletedDate === 'undefined') { events['start'] = event.workOrderTaskScheduledDate; events['end'] = event.workOrderTaskDueDate; } events['backgroundColor'] = event.backgroundColor; events['color'] = '#000000'; calendarEvents.push(events); }); pageContext.calenderEventsData = calendarEvents; }"}],"searchKeys":["userName"]}}],"id":"technicianList","type":"section","transparent":true},{"hidden":"@pageContext.hideTechCalendarDetails","children":[{"disabled":false,"id":"technicianSchedule","label":"@lang.['ts','Technician Schedule']","type":"calendar","config":{"setPageContext":true,"actionOnClick":[]},"events":"@pageContext.calenderEventsData"}],"label":"","id":"showSchedule","type":"section","transparent":false}]},"actions":[{"name":"setInitialData","type":"script","actionDef":"function(pageContext){pageContext.enable=true; pageContext.hideTechCalendarDetails=true;}"},{"parentPanelRefreshRequired":false,"name":"openPreviousPanel","type":"backPanel","requiredPageContextKeys":"[ \"workOrderTaskAssignedToUserId\",\"userName\",\"selectDropdown\" ]"},{"name":"storeUserId","type":"script","actionDef":"function(pageContext){pageContext.workOrderTaskAssignedToUserId=pageContext.selectedRowIds[0].workforceUserId;pageContext.userName=pageContext.selectedRowIds[0].userName; pageContext.selectDropdown =[]; pageContext.selectDropdown.push({'value':pageContext.workOrderTaskAssignedToUserId, 'label':pageContext.userName}) }"}]}