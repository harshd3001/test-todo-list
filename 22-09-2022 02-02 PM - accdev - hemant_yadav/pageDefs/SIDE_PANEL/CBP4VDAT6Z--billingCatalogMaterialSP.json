{"pageContext":{},"actionOnLoad":["@actions.initialData","@actions.setManufacturerAndCategory","@actions.getStockUnit"],"jslib":{"setNumberForCost":"function(pageContext) { if ((typeof pageContext.catalogUnitPrice !== 'undefined' && pageContext.catalogUnitPrice !== '')) { return (Number(pageContext.catalogUnitPrice) < 0); } else { return false; } }","isAddHidden":"function(pageContext) { if(pageContext.materialAction === 'add'){return true;}else{return false;}}","setNumberForListPrice":"function(pageContext) { if ((typeof pageContext.catalogCustomerPrice !== 'undefined' && pageContext.catalogCustomerPrice !== '')) { return (Number(pageContext.catalogCustomerPrice) < 0); } else { return false; } }","dynamicHeaderText":"function(pageContext){ if(pageContext.materialAction === 'add'){return '@lang.[\"acni\",\"Add New Catalog Item\"]'}else if(pageContext.materialAction === 'edit'){return '@lang.[\"eci\",\"Edit Catalog Item\"]'}}","isSaveDisabled":"function (pageContext) { if (pageContext.materialAction === 'add') { return(typeof pageContext.catalogStockUnitId === 'undefined' || typeof pageContext.catalogName === 'undefined' || pageContext.catalogName == '' || pageContext.catalogStockUnitId === ''); } else if (pageContext.materialAction === 'edit') { return(((pageContext.catalogStockUnitId === pageContext.initialCatalogStockUnitId) && (pageContext.catalogDescription === pageContext.initialCatalogDescription) && (pageContext.catalogManufacturerId === pageContext.initialCatalogManufacturerId) && (pageContext.catalogModelNumber === pageContext.initialCatalogModelNumber) && (pageContext.catalogName === pageContext.initialCatalogName) && (Number(pageContext.catalogUnitPrice) === pageContext.initialCatalogUnitPrice) && (Number(pageContext.catalogCustomerPrice) === pageContext.initialCatalogCustomerPrice) && (pageContext.catalogCategoryId === pageContext.initialCatalogCategoryId)) || (pageContext.catalogStockUnitId === '') || (pageContext.catalogName === '')); } }"},"header":{"children":[{"buttonType":"primary","actionOnClick":["@actions.setPrice","@actions.setSubActionUpsertCatalog","@actions.fireProcessEvent","@actions.closePanel","@actions.clearPageContext","@actions.refreshDataGrid"],"disabled":"@jslib.isSaveDisabled","id":"submit","type":"button","title":"@lang.['s12','Save']"},{"icon":"@iconlib.NavigationCloseGrey","actionOnClick":["@actions.clearPageContext","@actions.closePanel"],"id":"close","type":"buttonIcon"}],"title":"@jslib.dynamicHeaderText"},"body":{"children":[{"children":[{"isRequired":true,"inputType":"text","id":"catalogName","label":"@lang.['mn2','Material Name']","placeholder":"@lang.['emn3','Enter material name']","type":"input","value":"@pageContext.catalogName"},{"id":"catalogDescription","label":"@lang.['d7','Description (Optional)']","type":"textarea","value":"@pageContext.catalogDescription","placeHolder":"@lang.['ed1','Enter description']"},{"id":"catalogModelNumber","label":"@lang.['mn3','Model Number (Optional)']","placeholder":"@lang.['emn2','Enter model number']","type":"input","value":"@pageContext.catalogModelNumber"},{"actionOnChange":["@actions.setSelectedManufacturerId"],"isMultiSelect":false,"searchByOptions":{"dataSourceId":"query/read","sourceType":"query","dataToBeSent":{"filter":"{$name} like {@filter}","models":["manufacturer"],"columns":{"name":"manufacturer.name","id":"manufacturer.id"},"orderBy":"name ASC"}},"optLabelMap":"name","optValueMap":"id","id":"manufacturerList","label":"@lang.['m1','Manufacturer (Optional)']","type":"selectDropdown","value":"@pageContext.selectedManufacturer","placeHolder":"@lang.['sm','Select manufacturer']"},{"options":"@pageContext.stockUnitList","id":"stockUnit","optTitleKey":"name","optValueKey":"id","type":"select","title":"@lang.['su1','Stock Unit']","value":"@pageContext.catalogStockUnitId","placeHolder":"@lang.['ssu','Select stock unit']"}],"label":"@lang.['gi','General Information']","id":"generalInformationSection","type":"section"},{"children":[{"errorText":"@lang.['epevp','Error! Please enter valid price']","validator":"@jslib.setNumberForCost","inputType":"number","id":"catalogUnitPrice","label":"@lang.['c31','Cost']","placeholder":"@lang.['ep','Enter price']","type":"currency","value":"@pageContext.catalogUnitPrice"},{"errorText":"@lang.['epevp','Error! Please enter valid price']","validator":"@jslib.setNumberForListPrice","inputType":"number","id":"catalogCustomerPrice","label":"@lang.['lp','List Price']","placeholder":"@lang.['ep','Enter price']","type":"currency","value":"@pageContext.catalogCustomerPrice"},{"actionOnChange":["@actions.emptyCategoryTaxRate","@actions.setSelectedCategoryId","@actions.getTaxCategory","@actions.changeInTaxCategory"],"isMultiSelect":false,"searchByOptions":{"dataSourceId":"query/read","sourceType":"query","dataToBeSent":{"filter":"{$name} like {@filter} AND {$categoryTypeId} = 'tax'","models":["category"],"columns":{"rate":"category.taxRate","name":"category.name","id":"category.id"}}},"optLabelMap":"name","optValueMap":"id","id":"selectedCategory","label":"@lang.['tc2','Tax Category']","type":"selectDropdown","value":"@pageContext.selectedCategory","placeHolder":"@lang.['stc','Select tax category']"},{"disabled":true,"id":"categoryTaxRate","label":"@lang.['tr','Tax Rate (%)']","placeholder":"@lang.['tribostc','Tax Rate (%) is based on selected tax category']","type":"input","value":"@pageContext.categoryTaxRate"}],"label":"@lang.['a12','Accounting (Optional)']","id":"accountingSection","type":"section"}]},"actions":[{"name":"setPrice","type":"script","continueOnError":true,"actionDef":"function(pageContext) {var roundoff=pageContext.catalogUnitPrice;roundoff=roundoff.toFixed(2);pageContext.catalogUnitPrice=roundoff;var ToFixed=pageContext.catalogCustomerPrice;ToFixed=ToFixed.toFixed(2);pageContext.catalogCustomerPrice=ToFixed;}"},{"endPoint":"event/start","name":"fireProcessEvent","outputVarMap":{"data":"@pageContext.data"},"type":"api","actionDef":{"data":[{"eventId":"billingCatalogProcessEvent","contextVar":{"catalog":{"unitPrice":"@pageContext.catalogUnitPrice","recver":"@pageContext.catalogRecver","name":"@pageContext.catalogName","manufacturerId":"@pageContext.catalogManufacturerId","description":"@pageContext.catalogDescription","catalogTypeId":"material","modelNumber":"@pageContext.catalogModelNumber","id":"@pageContext.catalogId","customerPrice":"@pageContext.catalogCustomerPrice","categoryId":"@pageContext.catalogCategoryId","stockUnitId":"@pageContext.catalogStockUnitId"},"subAction":"@pageContext.subAction"}}]}},{"name":"changeInTaxCategory","type":"script","actionDef":"function(pageContext){pageContext.categoryTaxRate=pageContext.taxCategoryList[0].categoryTaxRate;}"},{"name":"initialData","type":"script","actionDef":"function(pageContext){ if (pageContext.materialAction == 'edit') { pageContext.initialCatalogName = pageContext.catalogName; pageContext.initialCategoryName = pageContext.categoryName; pageContext.initialCatalogDescription = pageContext.catalogDescription; pageContext.initialCatalogModelNumber = pageContext.catalogModelNumber; pageContext.initialCatalogManufacturerId = pageContext.catalogManufacturerId; pageContext.initialCatalogCategoryId = pageContext.catalogCategoryId; pageContext.initialCatalogUnitPrice = pageContext.catalogUnitPrice; pageContext.initialCatalogCustomerPrice = pageContext.catalogCustomerPrice; pageContext.initialCatalogStockUnitId = pageContext.catalogStockUnitId; } else if (pageContext.materialAction == 'add') { pageContext.catalogName = ''; pageContext.catalogDescription = ''; pageContext.catalogModelNumber = ''; pageContext.catalogManufacturerId = ''; pageContext.catalogCategoryId = ''; pageContext.catalogUnitPrice = ''; pageContext.catalogCustomerPrice = ''; pageContext.catalogStockUnitId = ''; } }"},{"name":"setManufacturerAndCategory","type":"script","actionDef":"function(pageContext){ if (typeof pageContext.manufacturerName !== 'undefined' && pageContext.manufacturerName !== '' ||typeof pageContext.categoryName !== 'undefined' && pageContext.categoryName !== '' ) { pageContext.selectedManufacturer = []; var manufacturerObj = { label: pageContext.manufacturerName, value: pageContext.catalogManufacturerId }; pageContext.selectedManufacturer.push(manufacturerObj); pageContext.selectedCategory = []; var categoryObj = { label: pageContext.categoryName, value: pageContext.catalogCategoryId }; pageContext.selectedCategory.push(categoryObj); } }"},{"name":"setSelectedManufacturerId","type":"script","actionDef":"function(pageContext){ if(pageContext.selectedManufacturer[0]===null || typeof pageContext.selectedManufacturer==='undefined' || pageContext.selectedManufacturer==='' || typeof pageContext.selectedManufacturer[0].value==='undefined' || pageContext.selectedManufacturer[0].value==='' ){ pageContext.catalogManufacturerId = ''; } else{ pageContext.catalogManufacturerId= pageContext.selectedManufacturer[0].value; } }"},{"name":"emptyCategoryTaxRate","type":"script","actionDef":"function(pageContext){pageContext.categoryTaxRate='';}"},{"name":"setSelectedCategoryId","type":"script","actionDef":"function(pageContext){ if (pageContext.selectedCategory[0] === null || typeof pageContext.selectedCategory[0].value === 'undefined' || pageContext.selectedCategory[0].value === '') { pageContext.catalogCategoryId = ''; } else { pageContext.catalogCategoryId = pageContext.selectedCategory[0].value; } }"},{"name":"getTaxCategory","outputVarMap":{"data":"@pageContext.taxCategoryList"},"type":"query","actionDef":{"filter":"{@catalogCategoryId}={$categoryId}","models":["category"],"columns":{"categoryTaxRate":"category.taxRate","categoryName":"category.name","categoryId":"category.id"},"inputs":{"catalogCategoryId":"@pageContext.catalogCategoryId"}}},{"name":"getStockUnit","outputVarMap":{"data":"@pageContext.stockUnitList"},"type":"query","actionDef":{"filter":"","models":["stockUnit"],"columns":{"name":"stockUnit.name","id":"stockUnit.id"},"orderBy":"name ASC"}},{"name":"setSubActionUpsertCatalog","type":"script","actionDef":"function(pageContext){pageContext.subAction='upsertCatalog';}"},{"name":"setSubActionDeleteCatalog","type":"script","actionDef":"function(pageContext){pageContext.subAction='deleteCatalog';}"},{"name":"closeModal","type":"closeModal"},{"name":"closePanel","type":"closePanel"},{"name":"clearPageContext","type":"clearPageContext"},{"name":"refreshDataGrid","type":"refreshDataGrid"}]}