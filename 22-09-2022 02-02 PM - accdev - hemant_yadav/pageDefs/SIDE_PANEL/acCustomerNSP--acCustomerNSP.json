{"actionOnLoad":[],"pageContext":{},"localPageContext":true,"jslib":{"isAddAnalystDisable":"function(pageContext) { if (typeof pageContext.appraiserValue !== 'undefined' && pageContext.appraiserValue !== '' && pageContext.acAppraiser[0] !== null) { if (pageContext.acAnalystValue != '' && typeof pageContext.acAnalystValue != 'undefined') {  return false; }  return true; }  return true; }"},"header":{"leftData":{"children":[{"name":"back","icon":"@iconlib.NavigationArrowBackGrey","actionOnClick":["@actions.goBackToCustomerSP"],"type":"buttonIcon"}]},"title":"Add Approved Analyst"},"body":{"children":[{"children":[{"actionOnLoad":[],"children":[{"children":[{"actionOnChange":["@actions.getAppraiser","@actions.fetchAnalystData1","@actions.setAnalystData1","@actions.decisionForAnalystIds","@actions.emptyDropdown"],"isMultiSelect":false,"optLabelMap":"Appraiser","optValueMap":"acAppriaserSpoId","searchByOptions":{"dataSourceId":"query/read","sourceType":"query","dataToBeSent":{"filter":"{$workforce.statusId}='workforceActive' && ({$workforce.acWfType} IN {@listOptionIdValue}) && {$acAppraiserSponsorship.appraiserId}={$workforce.userId} && ({$Appraiser} like {@filter})","models":["acAppraiserSponsorship","workforce","User"],"columns":{"acAppriaserSpoId":"acAppraiserSponsorship.appraiserId","Appraiser":"User.name","appraiserId":"workforce.userId"},"inputs":{"listOptionIdValue":["G2BW2Q1MI8","CLKV2Q1ALX"]},"orderBy":"Appraiser ASC","distinct":true,"links":{"User":"workforce"}}},"id":"selectDropdown","label":"@lang.['ap01','Appraiser']","type":"selectDropdown","value":"@pageContext.acAppraiser"},{"isRequired":true,"options":"@pageContext.acAnalyst","optTitleKey":"analyst","optValueKey":"analystId","id":"analystList","title":"@lang.['an01','Analyst']","type":"select","value":"@pageContext.acAnalystValue","placeHolder":"@lang.['san01','Select analyst']"},{"buttonType":"primary","hidden":false,"actionOnClick":["@actions.insertNspData","@actions.refreshDataGrid","@actions.makeNull"],"disabled":"@jslib.isAddAnalystDisable","id":"saveid","label":"@lang.['aan01','Add Analyst']","title":"Add Analyst","type":"button","helperText":"","required":false}],"id":"genInfo","label":"@lang.['gi','GeneralInformation']","type":"section","title":"General Information"},{"children":[{"label":"","id":"ApprovedAnalysts","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{}},"isScrollAble":true,"tableWidth":"50rem","searchAllowed":true,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"tableHeader":[{"name":"@lang.['ap01','Appraiser']","options":{"flex":1.3,"sortOrder":"ASC","colorCode":"statusNameColor","sortable":true,"showLabel":true},"key":"appraiser"},{"name":"@lang.['an01','Analyst ']","options":{"flex":1.5,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"analystName"}],"dataToBeSent":{"apiResponseParams":["count"],"inputVar":{},"processId":"acClientApprovedAnalysts","apiResponseFormat":true,"contextVar":{"customerId":"@pageContext.customerId","userId":"{@userId}"},"apiResponseObject":"approvedAnalysts"},"dataSourceId":"process/start","sourceType":"api","rowTextLength":30,"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['aa02','Approved Analysts']"},"isSelectable":false,"updateAllowed":true,"actions":[],"searchKeys":["analystName"]}}],"localPageContext":true,"label":"","id":"ApprovedAnalysts","type":"section","transparent":true}],"label":"@lang.['aa02','Approved Analysts']","id":"approvedAnalyst","type":"tab","actionOnLoadOnce":true}],"id":"tabs","type":"tab"}]},"actions":[{"name":"refreshDataGrid","type":"refreshDataGrid"},{"name":"setForJslib","type":"script","actionDef":"function(pageContext){pageContext.ApprovedAnalystsTaskActionEnter='add';}"},{"name":"emptyDropdown","type":"script","actionDef":"function(pageContext) { if (pageContext.acAppraiser == '' || typeof pageContext.acAppraiser == 'undefined') { pageContext.acAnalystValue = ''; } else { return false; } }"},{"parentPanelRefreshRequired":true,"name":"goBackToCustomerSP","type":"backPanel"},{"falseStep":["@actions.fetchAnalystData2"],"trueStep":["@actions.fetchAnalystData"],"name":"decisionForAnalystIds","type":"decision","actionDef":"function(pageContext){return(typeof pageContext.analystIds != 'undefined' && pageContext.analystIds != '' && pageContext.analystIds.length > 0);}"},{"name":"getAppraiser","type":"script","actionDef":"function(pageContext) { if (typeof pageContext.acAppraiser !== 'undefined' && pageContext.acAppraiser !== '' && pageContext.acAppraiser.length > 0) { pageContext.appraiserValue = pageContext.acAppraiser[0].value; } else if(typeof pageContext.acAppraiser == 'undefined' || pageContext.acAppraiser == '' || pageContext.acAppraiser == [null] ){pageContext.acAnalystValue ='';} }"},{"name":"setAnalystData1","type":"script","actionDef":"function(pageContext) { pageContext.analystIds = []; if (typeof pageContext.acAnalyst1 !== 'undefined' && pageContext.acAnalyst1 !== '' && pageContext.acAnalyst1.length > 0) { for(var i=0; i< pageContext.acAnalyst1.length; i++) { if(typeof pageContext.acAnalyst1[i].analystId !== 'undefined' && pageContext.acAnalyst1[i].analystId !== '') { pageContext.analystIds.push(pageContext.acAnalyst1[i].analystId); } } } }"},{"name":"fetchAnalystData1","outputVarMap":{"data":"@pageContext.acAnalyst1"},"type":"query","actionDef":{"filter":" {$acClientApprovedWorkforce.appraiserId} = {@appraiserValue} && {$acClientApprovedWorkforce.clientId} = {@customerId}","models":["acClientApprovedWorkforce"],"columns":{"clientId":"acClientApprovedWorkforce.clientId","analystId":"acClientApprovedWorkforce.analystId","appraiserId":"acClientApprovedWorkforce.appraiserId"},"inputs":{"customerId":"@pageContext.customerId","appraiserValue":"@pageContext.appraiserValue"},"distinct":true}},{"name":"fetchAnalystData2","outputVarMap":{"data":"@pageContext.acAnalyst"},"type":"query","actionDef":{"filter":" {$acAppraiserSponsorship.appraiserId} = {@appraiserValue} && {$workforce.acWfType}={@listOptionId} && {$acAppraiserSponsorship.analystId} = {$analystId}","models":["workforce","User","acAppraiserSponsorship"],"columns":{"acSponsorship":"acAppraiserSponsorship.appraiserId","analyst":"User.name","analystId":"workforce.userId","workforceUserId":"workforce.userId"},"inputs":{"appraiserValue":"@pageContext.appraiserValue","listOptionId":"N1ZR2Q17ZF"},"distinct":true,"links":{"User":"workforce"}}},{"name":"fetchAnalystData","outputVarMap":{"data":"@pageContext.acAnalyst"},"type":"query","actionDef":{"filter":" {$acAppraiserSponsorship.appraiserId} = {@appraiserValue} && {$workforce.acWfType}={@listOptionId} && {$acAppraiserSponsorship.analystId} = {$analystId} && ({$workforce.userId} NOT IN {@analystIds})","models":["workforce","User","acAppraiserSponsorship"],"columns":{"acSponsorship":"acAppraiserSponsorship.appraiserId","analyst":"User.name","analystId":"workforce.userId","workforceUserId":"workforce.userId"},"inputs":{"analystIds":"@pageContext.analystIds","appraiserValue":"@pageContext.appraiserValue","listOptionId":"N1ZR2Q17ZF"},"distinct":true,"links":{"User":"workforce"}}},{"endPoint":"model/insert","name":"insertNspData","outputVarMap":{"data":"@pageContext.addAnalyst"},"type":"api","actionDef":{"data":[{"modelName":"acClientApprovedWorkforce","clientId":"@pageContext.customerId","analystId":"@pageContext.acAnalystValue","appraiserId":"@pageContext.appraiserValue"}],"columns":[]}},{"name":"makeNull","type":"script","actionDef":"function(pageContext) { pageContext.acAppraiser = ''; pageContext.acAnalystValue = ''; }"}]}