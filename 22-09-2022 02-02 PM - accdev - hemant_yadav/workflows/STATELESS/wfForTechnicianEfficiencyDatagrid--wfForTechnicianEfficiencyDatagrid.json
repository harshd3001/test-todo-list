{"processWorkOrderData":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"processWorkOrderData","description":"Processing data","processRule":"{ contextVar.resultArray = []; var obj = {}; for (var i = 0; i < contextVar.queryData.length; i++) { obj.technicianName = contextVar.queryData[i].technicianName; obj.Days = contextVar.queryData[i].Days; obj.taskTypeName = contextVar.queryData[i].taskTypeName; obj.woId = contextVar.queryData[i].woId; var plannedDate1 = contextVar.queryData[i].plannedDate; var startDate = new Date(contextVar.queryData[i].actualStartTime); var completedDate = new Date(contextVar.queryData[i].completedDate); var diffTime = Math.abs(completedDate - startDate); if (contextVar.queryData[i].actual != 0) { obj.actual = Math.ceil(diffTime / (1000 * 60)); } else { obj.actual = '-'; } obj.plannedDate = Math.ceil(plannedDate1); contextVar.resultArray.push(obj); var obj = {}; } contextVar.count = contextVar.resultArray.length; }","id":"processWorkOrderDataId","nodeType":"PROCESS"},"workflowContext":{"batchSize1":1000,"batchNumber1":1,"statusId":"workOrderTaskCompleted","queryData":[]},"processFilter":{"connectors":[{"exitPortType":"NextStep","nodeId":"queryNode1"}],"contextChangePermitted":true,"name":"processFilter","description":"processFilter","processRule":"{ if (typeof contextVar.filter !== 'undefined' && contextVar.filter !== '') { contextVar.filter = '({$workOrderTask.id} IS NOT NULL' + ' AND ' + '(DATE({$workOrderTask.completedDate}) BETWEEN (CURRENT_DATE() - INTERVAL 1 Month) AND CURRENT_DATE())' + ' && ' + '{$workOrderTask.statusId} = {@statusId})' + ' AND ' + contextVar.filter; } else { contextVar.filter = '({$workOrderTask.id} IS NOT NULL' + ' AND ' + '(DATE({$workOrderTask.completedDate}) BETWEEN (CURRENT_DATE() - INTERVAL 1 Month) AND CURRENT_DATE())' + ' && ' + '{$workOrderTask.statusId} = {@statusId})'; } }","nodeType":"PROCESS"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"processFilter"}],"name":"start","description":"Start","id":"start","nodeType":"START"},"decisionForCount":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processWorkOrderData"},{"exitPortType":"FalseStep","nodeId":"queryNode1"}],"name":"decisionForCount","description":"decisionForCount","processRule":"(contextVar.dataLength >= contextVar.count1)","nodeType":"DECISION"},"end":{"name":"end","description":"End","inputVarMap":{"count":"count","resultArray":"resultArray"},"outputVarMap":{"count":"count","resultArray":"resultArray"},"id":"end","nodeType":"END"},"workflowNodes":["start","processFilter","queryNode1","processCountForData","decisionForCount","processWorkOrderData","end"],"processCountForData":{"connectors":[{"exitPortType":"NextStep","nodeId":"decisionForCount"}],"contextChangePermitted":true,"name":"processCountForWOTData","description":"processCountForWOTData","processRule":"{contextVar.queryData=contextVar.queryData.concat(contextVar.queryData1);contextVar.dataLength=contextVar.queryData.length;contextVar.batchNumber1=contextVar.batchNumber1+1;}","nodeType":"PROCESS"},"queryNode1":{"models":["taskType","User","workOrderTask"],"connectors":[{"exitPortType":"NextStep","nodeId":"processCountForData"}],"columns":{"actual":"sum(timestampdiff(minute,{$workOrderTask.actualStartTime},{$workOrderTask.completedDate}))/count({$workOrderTask.id})","actualStartTime":"workOrderTask.actualStartTime","plannedDate":"(sum({$workOrderTask.estimatedDuration})/count({$workOrderTask.id}))","woId":"count({$workOrderTask.id})","technicianName":"User.name","Days":"DATE({$workOrderTask.scheduledDate})","scheduledDate":"workOrderTask.scheduledDate","taskTypeName":"taskType.name","estimatedDuration":"workOrderTask.estimatedDuration","completedDate":"workOrderTask.completedDate"},"orderBy":"Days DESC,technicianName","description":"queryNode1","inputVarMap":{"filter":"filter","batchSize1":"batchSize","batchNumber1":"batchNumber","statusId":"statusId"},"groupBy":"technicianName,Days,taskTypeName","nodeType":"QUERY","filter":"filter","name":"queryNode1","id":"queryNodeId1","outputVarMap":{"data":"queryData1","count":"count1"},"getCount":true}}