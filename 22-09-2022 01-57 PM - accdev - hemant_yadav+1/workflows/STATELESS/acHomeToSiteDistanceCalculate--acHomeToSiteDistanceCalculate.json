{"getDistance":{"connectors":[{"exitPortType":"NextStep","nodeId":"processDistanceData"}],"processId":"acGetDistanceWF","name":"getDistance","description":"getDistance","inputVarMap":{"destinations":"destinations","origins":"origins"},"outputVarMap":{"distance":"distance"},"nodeType":"WORKFLOW"},"processTechData":{"connectors":[{"exitPortType":"NextStep","nodeId":"getDistance"}],"contextChangePermitted":true,"name":"processTechData","description":"processTechData","processRule":"{ if (contextVar.getTechLocation.length > 0) { contextVar.techAddress = contextVar.getTechLocation[0].address; contextVar.lng1 = contextVar.getTechLocation[0].lng; contextVar.lat1 = contextVar.getTechLocation[0].lat; contextVar.origins = []; contextVar.origins.push(contextVar.techAddress); contextVar.origins.push({ 'lat': contextVar.lat1, 'lng': contextVar.lng1 }); } }","nodeType":"PROCESS","jsEngine":"es6"},"processDistanceData":{"connectors":[{"exitPortType":"NextStep","nodeId":"processInsertData"}],"contextChangePermitted":true,"name":"processDistanceData","description":"processDistanceData","processRule":"{ contextVar.distanceFromSite = contextVar.distance[0].rows[0].elements[0].distance.value / 1000; }","nodeType":"PROCESS","jsEngine":"es6"},"getSiteIds":{"filter":"{$siteId} = {@siteId} ","models":["Site"],"connectors":[{"exitPortType":"NextStep","nodeId":"processSiteData"}],"columns":{"address":"site.address","lng":"site.longitude","siteName":"site.name","siteId":"site.id","lat":"site.latitude"},"name":"getSiteIds","distinct":true,"description":"fetch site ids for given regions ids and customer ids","inputVarMap":{"siteId":"siteId"},"outputVarMap":{"data":"siteData"},"batchSize":"batchSize","nodeType":"QUERY"},"processInsertData":{"connectors":[{"exitPortType":"NextStep","nodeId":"insertAcComp"}],"contextChangePermitted":true,"name":"processInsertData","description":"processInsertData","processRule":"{ contextVar.distanceFromHome = contextVar.distanceFromSite; contextVar.address = contextVar.siteData[0].address; contextVar.latitude = contextVar.siteData[0].lat; contextVar.longitude = contextVar.siteData[0].lng; contextVar.workOrderId = contextVar.workOrderId; contextVar.locationType = 'Property'; contextVar.isChecked = 'yes'; }","nodeType":"PROCESS","jsEngine":"es6"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"getSiteIds"}],"name":"start","description":"Start","nodeType":"START"},"getTechLocation":{"filter":"{$userId} = {@assignee} ","models":["workforce"],"connectors":[{"exitPortType":"NextStep","nodeId":"processTechData"}],"columns":{"address":"workforce.address","lng":"workforce.longitude","userId":"workforce.userId","lat":"workforce.latitude"},"name":"getTechLocation","distinct":true,"description":"fetch site ids for given regions ids and customer ids","inputVarMap":{"assignee":"assignee"},"outputVarMap":{"data":"getTechLocation"},"batchSize":"batchSize","nodeType":"QUERY"},"workflowacDriveDistanceUpdateWF":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"processId":"acCompDistanceUpdate","name":"workflowacDriveDistanceUpdateWF","description":"Provide some description for your workflow node","inputVarMap":{"distanceFromHome":"distanceFromHome","insertedId":"insertedId"},"id":"workflowacDriveDistanceUpdateWF","outputVarMap":{"insertedId":"insertedId"},"nodeType":"WORKFLOW"},"end":{"name":"end","description":"End","inputVarMap":{"techAddress":"techAddress","distanceFromSite":"distanceFromSite","siteAddress":"siteAddress","insertedId":"insertedId"},"outputVarMap":{"techAddress":"techAddress","distanceFromSite":"distanceFromSite","siteAddress":"siteAddress","insertedId":"insertedId"},"nodeType":"END"},"insertAcComp":{"modelName":"acCompAddress","connectors":[{"exitPortType":"NextStep","nodeId":"workflowacDriveDistanceUpdateWF"}],"name":"insertAcComp","description":"Provide some description for your model node","inputVarMap":{"address":"address","latitude":"latitude","distanceFromHome":"distanceFromSite","locationType":"locationType","workOrderId":"workOrderId","isChecked":"isChecked","longitude":"longitude"},"id":"insertAcComp","outputVarMap":{"id":"insertedId"},"multiRecord":false,"nodeType":"MODEL","operation":4},"processSiteData":{"connectors":[{"exitPortType":"NextStep","nodeId":"getTechLocation"}],"contextChangePermitted":true,"name":"processSiteData","description":"processSiteData","processRule":"{ if(contextVar.siteData.length>0){contextVar.siteAddress = contextVar.siteData[0].address;contextVar.lng1 = contextVar.siteData[0].lng;contextVar.lat1 = contextVar.siteData[0].lat; contextVar.destinations = [];contextVar.destinations.push(contextVar.siteAddress);contextVar.destinations.push({'lat':contextVar.lat1,'lng': contextVar.lng1}); }}","nodeType":"PROCESS","jsEngine":"es6"},"workflowNodes":["start","getSiteIds","processSiteData","getTechLocation","processTechData","getDistance","processDistanceData","processInsertData","insertAcComp","workflowacDriveDistanceUpdateWF","end"]}