{"forEachPriority":{"connectors":[{"exitPortType":"NextStep","nodeId":"calculateSlaDate"}],"contextChangePermitted":true,"name":"forEachPriority","description":"forEachPriority","processRule":"{contextVar.getResolutionTime =  contextVar.loopThroughPriorites_currentElement;}","nodeType":"PROCESS"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"getPriorityResolutionTime"}],"name":"start","description":"Start","nodeType":"START"},"getWeeklySchedule":{"filter":"{$weeklyScheduleCalendarId}={@calendarId}","models":["weeklySchedule"],"connectors":[{"exitPortType":"NextStep","nodeId":"convertToLocalDateTime"}],"columns":{"weeklyScheduleSchedule":"weeklySchedule.schedule","isAllDay":"weeklySchedule.isAllDay","isOpen":"weeklySchedule.isOpen","weeklyScheduleCalendarId":"weeklySchedule.calendarId","weeklyScheduleOpeningTime":"weeklySchedule.openingTime","day":"weeklySchedule.day","weeklyScheduleClosingTime":"weeklySchedule.closingTime"},"name":"getWeeklySchedule","description":"Fetch Weekly Schedule","inputVarMap":{"workOrderCalendarId":"calendarId"},"outputVarMap":{"data":"getWeeklyScheduleData"},"nodeType":"QUERY"},"pushToPriorityDeadlineArray":{"connectors":[{"exitPortType":"NextStep","nodeId":"loopThroughPriorites"}],"contextChangePermitted":true,"name":"pushToPriorityDeadlineArray","description":"Push priority and deadline to priorityDeadlineData","processRule":"{var deadlineObj={'priority':contextVar.loopThroughPriorites_currentElement.slaTimeFramePriorityPriority ,'deadline':contextVar.dueDateSLA , 'resolutionUnit':contextVar.loopThroughPriorites_currentElement.slaTimeFrameResolutionTimeUnit , 'resolutionTime':contextVar.loopThroughPriorites_currentElement.slaTimeFrameResolutionTimeAmount}; contextVar.priorityDeadlineData.push(deadlineObj)}","nodeType":"PROCESS"},"loopThroughPriorites":{"connectors":[{"exitPortType":"TrueStep","nodeId":"forEachPriority"},{"exitPortType":"FalseStep","nodeId":"convertRequestedDateToUTC"}],"data":"getPriorities","name":"loopThroughPriorites","description":"Loop through each priority and calculkate the SLA deadline","inputVarMap":{},"outputVarMap":{},"nodeType":"FOREACHLOOP"},"workflowNodes":["start","getPriorityResolutionTime","getWeeklySchedule","getHolidays","convertToLocalDateTime","isPriorityPresent","loopThroughPriorites","forEachPriority","calculateSlaDate","pushToPriorityDeadlineArray","convertRequestedDateToUTC","end"],"convertToLocalDateTime":{"connectors":[{"exitPortType":"NextStep","nodeId":"isPriorityPresent"}],"contextChangePermitted":true,"name":"convertToLocalDateTime","description":"convertToLocalDateTime via JS","processRule":"@N30UH19K26","nodeType":"PROCESS"},"workflowContext":{"priorityDeadlineData":[]},"getPriorityResolutionTime":{"filter":"{$slaTimeFrameSlaId}={@slaId} ","models":["slaTimeFrame"],"connectors":[{"exitPortType":"NextStep","nodeId":"getHolidays"}],"columns":{"slaTimeFramePriorityPriority":"slaTimeFrame.priorityPriority","slaTimeFrameResolutionTimeUnit":"slaTimeFrame.resolutionTimeUnit","slaTimeFrameSlaId":"slaTimeFrame.slaId","slaTimeFrameResolutionTimeAmount":"slaTimeFrame.resolutionTimeAmount"},"name":"getPriorityResolutionTime","description":"Get resolution time amount for the priority associated withg SLA","inputVarMap":{"workOrderSlaId":"slaId"},"outputVarMap":{"data":"getPriorities"},"nodeType":"QUERY"},"calculateSlaDate":{"connectors":[{"exitPortType":"NextStep","nodeId":"pushToPriorityDeadlineArray"}],"contextChangePermitted":true,"name":"calculateSlaDate","description":"calculateSlaDate via JS","processRule":"@XCPS719GU3","nodeType":"PROCESS"},"end":{"name":"End","description":"end","inputVarMap":{"priorityDeadlineData":"priorityDeadlineData","workOrderRequestedDate":"workOrderRequestedDate"},"outputVarMap":{"priorityDeadlineData":"priorityDeadlineData","workOrderRequestedDate":"workOrderRequestedDate"},"nodeType":"END"},"getHolidays":{"filter":"{$calendarHolidayCalendarId}={@calendarId}","models":["holiday","calendarHoliday"],"connectors":[{"exitPortType":"NextStep","nodeId":"getWeeklySchedule"}],"columns":{"calendarHolidayCalendarId":"calendarHoliday.calendarId","holidayName":"holiday.name","holidayDate":"holiday.date","holidayId":"holiday.id"},"name":"getHolidays","inputVarMap":{"workOrderCalendarId":"calendarId"},"outputVarMap":{"data":"getHolidays"},"nodeType":"QUERY"},"convertRequestedDateToUTC":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"convertRequestedDateToUTC","description":"convertRequestedDateToUTC","processRule":"{var localTime = new Date(contextVar.workOrderRequestedDate).getTime() + ((-330) * 60 * 1000); contextVar.workOrderRequestedDate = new Date(localTime).toISOString().replace('T', ' ').replace('Z', '');}","nodeType":"PROCESS"},"isPriorityPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"loopThroughPriorites"},{"exitPortType":"FalseStep","nodeId":"convertRequestedDateToUTC"}],"name":"isPriorityPresent","description":"Check if there are priority associated with SLA","processRule":"(contextVar.getPriorities.length > 0)","nodeType":"DECISION"}}