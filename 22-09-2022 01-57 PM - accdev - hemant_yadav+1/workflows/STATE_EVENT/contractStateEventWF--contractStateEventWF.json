{"processWorkOrderData":{"connectors":[{"exitPortType":"NextStep","nodeId":"cancelWorkOrderWF"}],"contextChangePermitted":true,"name":"processWorkOrderData","description":"processWorkOrderData","processRule":"{contextVar.workOrder = []; var obj = { 'cancellationReason': contextVar.cancellationReason, 'statusId': 'workOrderCancelled', 'id': contextVar.loopThroughWorkOrder_currentElement.id }; contextVar.workOrder.push(obj)}","nodeType":"PROCESS"},"cancelWorkOrderWF":{"eventId":"NCJHIL7VSE","connectors":[{"exitPortType":"NextStep","nodeId":"loopThroughWorkOrder"}],"contextChangePermitted":true,"name":"cancelWorkOrderWF","description":"cancelWorkOrderWF","inputVarMap":{"workOrder":"workOrder","subAction":"subAction"},"id":"cancelWorkOrderWF","nodeType":"PUBLISH","captureOutput":true},"workflowContext":{"activeWorkOrders":["workOrderOpen","workOrderScheduled"],"cancellationReason":"@lang.['contractExpired ','Contract Expired']","subAction":"cancelWorkOrder","workOrderTaskCancelled":"workOrderTaskCancelled"},"isContractExpired":{"connectors":[{"exitPortType":"TrueStep","nodeId":"getWorkOrderData"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"isContractExpired","description":"isContractExpired","processRule":"contextVar.contractStatusId ==='contractExpired'","nodeType":"DECISION"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchCurrentUser"}],"name":"Start","description":"Start","nodeType":"START"},"isWorkOrderPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"loopThroughWorkOrder"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"isWorkOrderPresent","description":"isWorkOrderPresent","processRule":"{contextVar.workOrderData != undefined && contextVar.workOrderData.length>0}","nodeType":"DECISION"},"loopThroughWorkOrder":{"connectors":[{"exitPortType":"TrueStep","nodeId":"processWorkOrderData"},{"exitPortType":"FalseStep","nodeId":"end"}],"data":"workOrderData","name":"loopThroughWorkOrder","description":"loopThroughWorkOrder","inputVarMap":{},"outputVarMap":{},"nodeType":"FOREACHLOOP"},"end":{"name":"end","description":"End","inputVarMap":{},"outputVarMap":{},"nodeType":"END"},"processModelData":{"connectors":[{"exitPortType":"NextStep","nodeId":"isContractExpired"}],"contextChangePermitted":true,"name":"processModelData","description":"processModelData","processRule":"{ contextVar.contractCalendarId = contextVar.data.calendarId; contextVar.contractNumber = contextVar.data.contractNumber; contextVar.contractCustomerId = contextVar.data.customerId; contextVar.contractDescription = contextVar.data.description; contextVar.contractEndDate = contextVar.data.endDate; contextVar.contractId = contextVar.data.id; contextVar.contractSlaId = contextVar.data.slaId; contextVar.contractStartDate = contextVar.data.startDate; contextVar.contractStatusId = contextVar.data.statusId; contextVar.contractStatusTargetModel = contextVar.data.statusTargetModel;}","nodeType":"PROCESS"},"getWorkOrderData":{"filter":"{$contractId} = {@contractId} AND {$statusId} IN {@activeWorkOrders}","models":["workOrder"],"connectors":[{"exitPortType":"NextStep","nodeId":"isWorkOrderPresent"}],"columns":{"statusId":"workOrder.statusId","contractId":"workOrder.contractId","id":"workOrder.id"},"name":"getWorkOrderData","description":"getWorkOrderData","inputVarMap":{"activeWorkOrders":"activeWorkOrders","contractId":"contractId"},"outputVarMap":{"data":"workOrderData"},"nodeType":"QUERY"},"workflowNodes":["start","fetchCurrentUser","processModelData","isContractExpired","getWorkOrderData","isWorkOrderPresent","processWorkOrderData","loopThroughWorkOrder","cancelWorkOrderWF","end"],"fetchCurrentUser":{"filter":"{$userId}={@userId}","models":["User"],"connectors":[{"exitPortType":"NextStep","nodeId":"processModelData"}],"columns":{"userName":"User.name","userId":"User.id"},"name":"fetchCurrentUser","description":"fetchCurrentUser","inputVarMap":{"{@userId}":"userId"},"outputVarMap":{"data":"currentUserDetail"},"nodeType":"QUERY"}}