{"pageContext":{},"actionOnLoad":["@actions.enableRecordGrid","@actions.setInitialData"],"localPageContext":true,"jslib":{},"header":{"leftData":{"children":[{"name":"Back","icon":"@iconlib.NavigationArrowBackGrey","actionOnClick":["@actions.openPreviousPanel","@actions.refreshDataGrid"],"type":"buttonIcon"}]},"children":[{"icon":"@iconlib.NavigationCloseGrey","actionOnClick":["@actions.closePanel"],"id":"close","type":"buttonIcon"}],"title":"@lang.['cp5','Closeout Package']"},"body":{"children":[{"hidden":false,"children":[{"isRequired":true,"actionOnChange":["@actions.setVisibility"],"options":[{"id":"@lang.['cpp','Closeout Package PDF']","value":"Closeout Package PDF"}],"id":"filesGrid","optTitleKey":"id","optValueKey":"value","label":"@lang.['sfttd','Select File Type To Download']","type":"select","title":"@lang.['sfttd','Select File Type To Download']","value":"@pageContext.filesType","placeHolder":"@lang.['sft','Select File Type']"}],"label":"","id":"Files","type":"section","transparent":true},{"hidden":"@pageContext.hideDataGrid","children":[{"id":"packageGrid","label":"","type":"datagrid","jsonDef":{"isScrollAble":false,"deleteAllowed":false,"searchAllowed":false,"tableWidth":"70rem","modifyRowActions":[],"gridRefreshId":"","emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['nphbs','NO PHOTOS HAVE BEEN SUBMITTED']","type":"noData"},"isSync":true,"tableHeader":[{"name":"@lang.['ci9','Content Includes']","options":{"sortable":true,"showLabel":true},"key":"Name","primaryKey":true},{"name":"@lang.['i','id']","options":{"hidden":true,"sortable":true,"showLabel":false},"key":"id","primaryKey":true}],"dataToBeSent":{"apiResponseParams":["count"],"processId":"acCloseoutDynamicGridGenerationWF","apiResponseFormat":true,"contextVar":{"workOrderId":"@pageContext.workOrderId"},"apiResponseObject":"dynamicGridData"},"dataSourceId":"process/start","isMultiSelect":true,"sourceType":"api","jslib":{"isDownloadDisable":"function(pageContext) { if (typeof pageContext.selectedPackageData !== 'undefined' && pageContext.selectedPackageData !== '' && pageContext.selectedPackageData.length > 0 && typeof pageContext.selectedRowIds !== 'undefined' && pageContext.selectedRowIds !== '' && pageContext.selectedRowIds.length > 0 && pageContext.selectedRowIds.length != pageContext.selectedPackageData.length) { return false; } else { if (typeof pageContext.selectedRowIds !== 'undefined') { for (var i in pageContext.selectedRowIds) { if (pageContext.selectedPackageData.indexOf(pageContext.selectedRowIds[i].name) == -1) { return false; } } return true; } } }"},"header":{"filterAllowed":true,"subHeaderText":"@lang.['r','Records']","headerText":"@pageContext.copHeader","children":[{"buttonType":"primary","actionOnClick":["@actions.setselectedPackageData","@actions.fireProcessEventToCallCloseoutPackageWF","@actions.openPdfUrl"],"disabled":"@jslib.isDownloadDisable","id":"download","type":"button","title":"@lang.['d18','Download']"}]},"isSelectable":true,"dataSource":[],"actions":[{"name":"setselectedPackageData","type":"script","actionDef":"function (pageContext) {pageContext.selectedPackageData = [];pageContext.selectedRowIds.map(select => pageContext.selectedPackageData.push({ name: select.Name, id: select.id })); if(Intl.DateTimeFormat().resolvedOptions().timeZone){pageContext.timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone}else{pageContext.timeZone = 'Asia/Calcutta';}}"},{"name":"openPdfUrl","fileUrl":"@pageContext.pdfUrlData[0].data[0].zipUrl","type":"downloadFile"},{"endPoint":"event/start","name":"fireProcessEventToCallCloseoutPackageWF","outputVarMap":{"data":"@pageContext.pdfUrlData"},"type":"api","actionDef":{"data":[{"eventId":"WXOEFH8TW9","inputVar":{},"contextVar":{"gmtTimeZone":"@pageContext.gmtTimeZone","packageData":"@pageContext.selectedPackageData","timeZone":"@pageContext.timeZone","workOrderId":"@pageContext.workOrderId","locale":"@pageContext.locale","fileType":"@pageContext.filesType"}}]}}],"searchKeys":["Name"]}}],"label":"","id":"Packages","type":"section","transparent":true}],"label":"","id":"datagridFiles","type":"section","transparent":true},"updateAllowed":true,"actions":[{"name":"openPreviousPanel","type":"backPanel"},{"name":"setInitialData","type":"script","actionDef":"function (pageContext) { pageContext.selectedPackageData=[];pageContext.hideDataGrid=false; pageContext.filesType='Closeout Package PDF';pageContext.copHeader = \"@lang.['cpp','Closeout Package PDF']\";pageContext.package = []; pageContext.packageData=[{ 'name': `@lang.['tpr','Task Progress Reports']` }, { 'name': `@lang.['sd12','Services Delivered']` },{ 'name': `@lang.['fe','Final Evidence']`}]; pageContext.locale = navigator.language||navigator.userLanguage; pageContext.locale=pageContext.locale.toLowerCase(); pageContext.gmtTimeZone = new Date().toString().split(' ')[5]; }"},{"name":"setVisibility","type":"script","actionDef":"function (pageContext) { if (typeof pageContext.filesType !== 'undefined' && pageContext.filesType !== '') { pageContext.hideDataGrid = false; if(pageContext.filesType === 'Photos Only (Zip Folder)'){pageContext.copHeader = \"@lang.['pof','Photos Only (Zip Folder)']\";}else{pageContext.copHeader = \"@lang.['cpp','Closeout Package PDF']\";} } else { pageContext.hideDataGrid = true } }"},{"name":"enableRecordGrid","type":"script","actionDef":"function(pageContext){pageContext.enable=true;}"},{"name":"closePanel","type":"closePanel"},{"name":"refreshDataGrid","type":"refreshDataGrid"}]}