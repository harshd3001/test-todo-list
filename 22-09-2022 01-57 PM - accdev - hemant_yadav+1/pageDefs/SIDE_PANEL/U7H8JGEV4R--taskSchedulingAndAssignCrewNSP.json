{"pageContext":{},"actionOnLoad":["@actions.setInitialData","@actions.refreshDataGrid"],"localPageContext":true,"jslib":{"isSaveDisabled":"function(pageContext) { return (!(typeof pageContext.selectedRowIds !== 'undefined' && pageContext.selectedRowIds.length > 0) || (typeof pageContext.selectedRowIds !== 'undefined' && pageContext.selectedRowIds.length > 0 && typeof pageContext.workOrderTaskAssignedToCrewId !== 'undefined' && pageContext.workOrderTaskAssignedToCrewId !== '' && pageContext.workOrderTaskAssignedToCrewId === pageContext.selectedRowIds[0].crewId)); }"},"header":{"leftData":{"children":[{"icon":"@iconlib.NavigationArrowBackGrey","actionOnClick":["@actions.openPreviousPanel"],"id":"back","type":"buttonIcon"}]},"children":[{"buttonType":"primary","actionOnClick":["@actions.storeCrewId","@actions.openPreviousPanel"],"disabled":"@jslib.isSaveDisabled","id":"submit","type":"button","title":"@lang.['s12','Save']"}],"title":"@lang.['vac','View All Crews']"},"body":{"children":[{"children":[{"id":"scheduleBreakdownDataGrid","type":"dataGrid","jsonDef":{"pageContextConfig":{"enable":true,"isPaginationReqd":false,"tableData":{"source":"@pageContext.taskScheduleMultipleBreakdown"}},"isScrollAble":false,"searchAllowed":false,"emptyScreen":{"image":"@iconlib.ActionsSearchGrey","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"tableHeader":[{"name":"@lang.['sd4','Scheduled Date']","options":{"type":"date","showLabel":true},"key":"startDate"},{"name":"@lang.['st7','Start Time']","options":{"type":"time","showLabel":true},"key":"startDate"},{"name":"@lang.['et2','End Time']","options":{"type":"time","showLabel":true},"key":"endDate"},{"name":"@lang.['dh2','Duration (In Hours)']","options":{"showLabel":true},"key":"durationInHours"}],"dataSourceId":"query/read","jslib":{},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['taskSchedule','Task Schedule']"},"isSelectable":false,"updateAllowed":true,"actions":[],"searchKeys":[]}}],"id":"scheduleBreakdown","type":"section","transparent":true},{"children":[{"id":"crewDataGrid","type":"dataGrid","jsonDef":{"isScrollAble":true,"deleteAllowed":false,"searchAllowed":true,"tableWidth":"60rem","searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY']","type":"noData"},"modifyRowActions":[],"emptyScreen":{"image":"@iconlib.ActionsSearchGrey","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"singleSelect":true,"tableHeader":[{"name":"@lang.['c24','crewId']","options":{"hidden":true,"showLabel":false},"key":"crewId","primaryKey":true},{"name":"@lang.['c29','crewLeadUserId']","options":{"hidden":true,"showLabel":false},"key":"crewLeadUserId","primaryKey":true},{"name":"@lang.['c32','crewStatusId']","options":{"hidden":true,"showLabel":false},"key":"crewStatusId","primaryKey":true},{"name":"@lang.['n','Name']","options":{"flex":0.6,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"crewName","primaryKey":true},{"name":"@lang.['r1','Region']","options":{"flex":0.4,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"regionName"},{"name":"@lang.['cl2','Crew Lead']","options":{"flex":0.6,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"userName"},{"name":"@lang.['s4','Shift']","options":{"flex":0.5,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"calendarName"},{"name":"@lang.['d','Description']","options":{"flex":0.8,"showLabel":true},"key":"crewDescription"}],"dataToBeSent":{"apiResponseParams":["count"],"processId":"taskSchedulingFetchCrewListWF","apiResponseFormat":true,"contextVar":{"workOrderTaskId":"@pageContext.workOrderTaskId"},"apiResponseObject":"crewListData"},"rowsToSelect":{"filter":"{$crewId}={@id}","models":["crew"],"columns":{"crewLeadUserId":"crew.leadUserId","crewId":"crew.id","crewStatusId":"crew.statusId","crewName":"crew.name"},"inputs":{"id":"@pageContext.workOrderTaskAssignedToCrewId"}},"dataSourceId":"process/start","sourceType":"api","jslib":{"isShowScheduleDisabled":"function(pageContext){ return !(typeof pageContext.selectedRowIds !== 'undefined' && pageContext.selectedRowIds.length > 0); }"},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['c22','Crews']","children":[{"buttonType":"secondary","actionOnClick":["@actions.setVisibilityTrue","@actions.setCrewId","@actions.refreshCrewMembersDataGrid","@actions.calendarFromAPI","@actions.initialEventsData"],"disabled":"@jslib.isShowScheduleDisabled","id":"getCrewSchedule","type":"button","title":"@lang.['vc','View Crew']"}]},"isSelectable":true,"actions":[{"name":"setVisibilityTrue","type":"script","actionDef":"function(pageContext){pageContext.hideCrewDetails = false; }"},{"name":"setCrewId","type":"script","actionDef":"function(pageContext){pageContext.crewId = pageContext.selectedRowIds[0].crewId;}"},{"name":"refreshCrewMembersDataGrid","gridId":["crewMembers"],"type":"RefreshGridOnSidePanel"},{"name":"calendarFromAPI","outputVarMap":{"data":"@pageContext.calendarFromAPIQuery"},"type":"query","actionDef":{"filter":"{$workOrderTaskAssignedToCrewId} = {@crewId} AND  {$statusId} NOT IN {@statusFilter} and {$taskType.webTask} = false","models":["workOrderTask","ZStatus","taskType"],"inputs":{"statusFilter":["workOrderTaskOpen","workOrderTaskCancelled","workOrderTaskDiscontinued"],"crewId":"@pageContext.crewId"},"columns":{"workOrderTaskDueDate":"workOrderTask.dueDate","statusId":"ZStatus.id","workOrderTaskId":"workOrderTask.id","workOrderTaskAssignedToCrewId":"workOrderTask.assignedToCrewId","workOrderTaskScheduledDate":"workOrderTask.scheduledDate","workOrderTaskCompletedDate":"workOrderTask.completedDate"},"links":{"workOrderTask":"taskType","ZStatus":"workOrderTask"}}},{"name":"initialEventsData","type":"script","actionDef":"function(pageContext) {var calendarEvents = []; pageContext.calendarFromAPIQuery.forEach((event) => { var events = {}; events['id'] = event.workOrderTaskId; events['title'] = event.workOrderTaskId; if (typeof event.workOrderTaskActualStartTime !== 'undefined' && typeof event.workOrderTaskCompletedDate !== 'undefined') { events['start'] = event.workOrderTaskActualStartTime; events['end'] = event.workOrderTaskCompletedDate; } else if (typeof event.workOrderTaskActualStartTime !== 'undefined' && typeof event.workOrderTaskCompletedDate === 'undefined') { events['start'] = event.workOrderTaskActualStartTime; events['end'] = event.workOrderTaskDueDate; } else if (typeof event.workOrderTaskActualStartTime === 'undefined' && typeof event.workOrderTaskCompletedDate === 'undefined') { events['start'] = event.workOrderTaskScheduledDate; events['end'] = event.workOrderTaskDueDate; } events['backgroundColor'] = event.backgroundColor; events['color'] = '#000000'; calendarEvents.push(events); }); pageContext.calenderEventsData = calendarEvents;}"}],"searchKeys":["crewName"]}}],"id":"crews","type":"section","transparent":true},{"hidden":"@pageContext.hideCrewDetails","children":[{"id":"crewMembersDataGrid","type":"dataGrid","jsonDef":{"isScrollAble":true,"searchAllowed":true,"tableWidth":"60rem","searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY']","type":"noData"},"gridRefreshId":"crewMembers","emptyScreen":{"image":"@iconlib.ActionsSearchGrey","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"isSync":true,"tableHeader":[{"name":"@lang.['s','Status']","options":{"flex":1,"sortOrder":"ASC","colorCode":"statusNameColor","sortable":true,"showLabel":true},"key":"statusName"},{"name":"@lang.['n','Name']","options":{"flex":1,"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"userName"},{"name":"@lang.['navS1','Skills']","options":{"flex":1.5,"showLabel":true},"key":"skill"},{"name":"@lang.['p6','Phone']","options":{"flex":1,"showLabel":true},"key":"userPhoneNumber"}],"dataToBeSent":{"apiResponseParams":["count"],"processId":"workforceFieldForceCrewFetchDataWF","apiResponseFormat":true,"contextVar":{"crewId":"@pageContext.crewId"},"apiResponseObject":"crewMembersData"},"dataSourceId":"process/start","sourceType":"api","jslib":{},"header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['cm','Crew Members']"},"isSelectable":false,"updateAllowed":true,"actions":[],"searchKeys":["userName"]}}],"id":"crewMembers","type":"section","transparent":true},{"hidden":"@pageContext.hideCrewDetails","children":[{"actionOnClick":[],"id":"crewScheduleCalendar","label":"@lang.['cs2','Crew Schedule']","type":"calendarComponent","config":{"setPageContext":true,"actionOnClick":[]},"events":"@pageContext.calenderEventsData"}],"id":"crewSchedule","type":"section"}]},"actions":[{"name":"setInitialData","type":"script","actionDef":"function(pageContext){pageContext.enable=true; pageContext.hideCrewDetails=true;}"},{"name":"storeCrewId","type":"script","actionDef":"function (pageContext) { pageContext.crewStatusId = pageContext.selectedRowIds[0].crewStatusId; pageContext.workOrderTaskAssignedToCrewId = pageContext.selectedRowIds[0].crewId; pageContext.workOrderTaskAssignedToUserId = pageContext.selectedRowIds[0].crewLeadUserId; pageContext.crewName = pageContext.selectedRowIds[0].crewName; pageContext.selectDropdown = []; pageContext.selectDropdown.push({ 'value': pageContext.workOrderTaskAssignedToCrewId, 'label': pageContext.crewName }); }"},{"parentPanelRefreshRequired":false,"name":"openPreviousPanel","type":"backPanel","requiredPageContextKeys":"[ \"workOrderTaskAssignedToCrewId\",\"selectDropdown\", \"workOrderTaskAssignedToUserId\",\"crewStatusId\" ]"},{"name":"refreshDataGrid","type":"refreshDataGrid"}]}