{"pageContext":{},"actionOnLoad":["@actions.initialData"],"jslib":{"dynamicHeaderText":"function(pageContext){ if(pageContext.regionAction === 'add'){return '@lang.[\"anMa\",\"Add New Market\"]'}else if(pageContext.regionAction === 'edit'){return '@lang.[\"erM\",\"Edit Market\"]'}}","isSaveDisabled":"function(pageContext){if (pageContext.regionAction === 'add') {return (pageContext.regionName === '')} else if (pageContext.regionAction === 'edit') {return (((pageContext.regionName === pageContext.initialRegionName) && (pageContext.regionDescription === pageContext.initialRegionDescription))|| (pageContext.regionName === ''))}}","isActionEdit":"function(pageContext) {return pageContext.regionAction === 'edit';}","isActionAdd":"function(pageContext) {return pageContext.regionAction === 'add';}"},"header":{"children":[{"activeIcon":"@iconlib.ActionsBinPurple","hidden":true,"name":"@lang.['d1','Delete']","icon":"@iconlib.ActionsBinGrey","tooltip":"@lang.['d1','Delete']","actionOnClick":["@actions.openModal"],"id":"delete","type":"buttonIcon"},{"buttonType":"primary","hidden":"@jslib.isActionEdit","actionOnClick":["@actions.setSubActionUpsertRegion","@actions.fireProcessEvent","@actions.processApiOutput","@actions.refreshDataGrid","@actions.setRegionActionEdit","@actions.initialData"],"disabled":"@jslib.isSaveDisabled","id":"saveContinue","type":"button","title":"@lang.['sc1','Save & Continue']"},{"buttonType":"primary","hidden":"@jslib.isActionAdd","actionOnClick":["@actions.setSubActionUpsertRegion","@actions.fireProcessEvent","@actions.closePanel","@actions.clearPageContext","@actions.refreshDataGrid"],"disabled":"@jslib.isSaveDisabled","id":"save","type":"button","title":"@lang.['s12','Save']"},{"icon":"@iconlib.NavigationCloseGrey","actionOnClick":["@actions.closePanel","@actions.clearPageContext","@actions.refreshDataGrid"],"id":"Close","type":"buttonIcon"}],"title":"@jslib.dynamicHeaderText"},"body":{"children":[{"children":[{"isRequired":true,"inputType":"text","id":"name","label":"@lang.['n','Name']","placeholder":"@lang.['eman','Enter market name']","type":"input","value":"@pageContext.regionName"},{"id":"description","label":"@lang.['d7','Description (Optional)']","type":"textarea","value":"@pageContext.regionDescription","placeHolder":"@lang.['ed1','Enter description']"}],"label":"@lang.['mai','Market Information']","id":"regionInfo","type":"section"},{"hidden":true,"children":[{"label":"@lang.['s2','Subregions']","id":"subRegions","type":"datagrid","jsonDef":{"isScrollAble":false,"searchAllowed":true,"searchEmptyScreen":{"image":"@iconlib.ActionsSearchError","contentValue":"@lang.['sysrcue','SORRY! YOUR SEARCH RESULTS CAME UP EMPTY ']","type":"noData"},"rowActions":{"children":[{"activeIcon":"@iconlib.ActionsEditPurple","name":"@lang.['e1','Edit']","tooltip":"@lang.['e1','Edit']","icon":"@iconlib.ActionsEditGrey","actionOnClick":["@actions.setSubActionUpsertSubRegion","@actions.setSubRegionActionEdit","@actions.openNestedSidePanel"],"type":"buttonIcon"},{"activeIcon":"@iconlib.ActionsBinPurple","hidden":true,"name":"@lang.['d1','Delete']","icon":"@iconlib.ActionsBinGrey","tooltip":"@lang.['d1','Delete']","actionOnClick":["@actions.openSubRegionModal"],"type":"buttonIcon"}]},"emptyScreen":{"image":"@iconlib.ActionsSearchEmpty","contentValue":"@lang.['ylieatm','YOUR LIST IS EMPTY AT THE MOMENT']","type":"noData"},"tableHeader":[{"name":"@lang.['n','Name']","options":{"sortOrder":"ASC","sortable":true,"showLabel":true},"key":"subRegionName"},{"name":"@lang.['d','Description']","options":{"sortable":true,"showLabel":true},"key":"subRegionDescription"}],"dataToBeSent":{"filter":"{$regionId}={@regionId}","models":["subRegion","region"],"columns":{"regionId":"subRegion.regionId","subRegionRecver":"subRegion.recver","subRegionDescription":"subRegion.description","subRegionId":"subRegion.id","subRegionName":"subRegion.name"},"inputs":{"regionId":"@pageContext.regionId"},"orderBy":"subRegionName ASC"},"dataSourceId":"query/read","header":{"subHeaderText":"@lang.['r','Records']","headerText":"@lang.['s2','Subregions']","children":[{"buttonType":"primary","actionOnClick":["@actions.setSubActionUpsertSubRegion","@actions.setSubRegionActionAdd","@actions.openNestedSidePanel"],"id":"addNew","type":"button","title":"@lang.['addNew','Add New']"}]},"updateAllowed":true,"isSelectable":false,"actions":[{"subTitle":"@lang.['aysywtdtsrtcbu','Are you sure you want to delete the subregion? This cannot be undone.']","name":"openSubRegionModal","options":[{"buttonType":"secondary","name":"no","actionOnClick":"@actions.closeModal","type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.setSubActionDeleteSubRegion","@actions.fireProcessEvent","@actions.closeModal","@actions.refreshDataGrid"],"type":"button","title":"@lang.['d1','Delete']"}],"type":"openModal","title":"@lang.['ds1','Delete Subregions']"},{"name":"openNestedSidePanel","type":"openPanel","pageId":"91715V67CX"},{"name":"setSubRegionActionAdd","type":"script","actionDef":"function(pageContext){pageContext.subRegionAction='add';}"},{"name":"setSubRegionActionEdit","type":"script","actionDef":"function(pageContext){pageContext.subRegionAction='edit';}"},{"name":"setSubActionUpsertSubRegion","type":"script","actionDef":"function(pageContext){pageContext.subAction='upsertSubRegion';}"}],"searchKeys":["subRegionName"]}}],"disabled":"@jslib.isSaveDisabled","id":"datagrid","type":"section","transparent":true}]},"actions":[{"endPoint":"event/start","name":"fireProcessEvent","outputVarMap":{"data":"@pageContext.data"},"type":"api","actionDef":{"data":[{"eventId":"settingsBusinessRegionProcessEvent","contextVar":{"subRegion":{"recver":"@pageContext.subRegionRecver","id":"@pageContext.subRegionId"},"subAction":"@pageContext.subAction","region":{"recver":"@pageContext.regionRecver","name":"@pageContext.regionName","description":"@pageContext.regionDescription","id":"@pageContext.regionId"}}}]}},{"name":"setSubActionUpsertRegion","type":"script","actionDef":"function(pageContext){pageContext.subAction='upsertRegion';}"},{"name":"setSubActionDeleteRegion","type":"script","actionDef":"function(pageContext){pageContext.subAction='deleteRegion';}"},{"name":"setSubActionDeleteSubRegion","type":"script","actionDef":"function(pageContext){pageContext.subAction='deleteSubRegion';}"},{"name":"setRegionActionEdit","type":"script","actionDef":"function(pageContext){pageContext.regionAction='edit';}"},{"name":"clearPageContext","type":"clearPageContext"},{"name":"closeModal","type":"closeModal"},{"name":"closePanel","type":"closePanel"},{"name":"initialData","type":"script","actionDef":"function(pageContext){ if(pageContext.regionAction === 'add'){ pageContext.regionName = ''; pageContext.regionDescription = '';} else if (pageContext.regionAction === 'edit'){pageContext.initialRegionName = pageContext.regionName; pageContext.initialRegionDescription = pageContext.regionDescription;}}"},{"subTitle":"@lang.['aysywtdtrtcbu','Are you sure you want to delete the region? This cannot be undone.']","name":"openModal","options":[{"buttonType":"secondary","name":"no","actionOnClick":"@actions.closeModal","type":"button","title":"@lang.['c2','Cancel']"},{"buttonType":"primary","name":"yes","actionOnClick":["@actions.setSubActionDeleteRegion","@actions.fireProcessEvent","@actions.closeModal","@actions.closePanel","@actions.refreshDataGrid","@actions.clearPageContext"],"type":"button","title":"@lang.['d1','Delete']"}],"type":"openModal","title":"@lang.['dr','Delete Region']"},{"name":"refreshDataGrid","type":"refreshDataGrid"},{"name":"processApiOutput","type":"script","actionDef":"function(pageContext){pageContext.regionId=pageContext.data[0].data[0].regionId;}"}]}