{"processWorkOrderTemplateInventoryData":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"processWorkOrderTemplateInventoryData","description":"processWorkOrderTemplateInventoryData","processRule":"{contextVar.workOrderTemplateInventoryDataset.forEach(function (element) { element['templateTaskName'] = (Array.isArray(contextVar.inventoryDataWithTaskIds) && contextVar.inventoryDataWithTaskIds.length > 0) ? getTemplateTaskName(element.workOrderTemplateTaskId, contextVar.inventoryDataWithTaskIds) : '-'; }); contextVar.count = contextVar.workOrderTemplateInventoryDataset.length; function getTemplateTaskName(templateId, inventoryDataWithTaskIds) { var templateTaskName = '-'; for (const ele of inventoryDataWithTaskIds) { if (ele.workOrderTemplateTaskId == templateId) { templateTaskName = ele.templateTaskName; break; } } return templateTaskName; }}","id":"processServices","nodeType":"PROCESS","jsEngine":"es6"},"fetchWorkOrderTemplateInventoryDataWithoutTemplateTaskIds":{"models":["workOrderTemplateInventory","catalog","stockUnit","manufacturer","catalogType"],"connectors":[{"exitPortType":"NextStep","nodeId":"isworkOrderTemplateInventoryDatasetPresent"}],"columns":{"estimatedQty":"CONCAT({$workOrderTemplateInventory.estimatedQty},' ',{$stockUnit.name})","estimatedQuantity":"workOrderTemplateInventory.estimatedQty","manufacturerName":"manufacturer.name","costPrice":"catalog.unitPrice","catalogTypeName":"catalogType.name","estimatedCost":"IF({$workOrderTemplateInventory.estimatedQty}!=0,{$workOrderTemplateInventory.estimatedQty}*{$catalog.unitPrice},0)","stockUnitName":"stockUnit.name","modelName":"catalog.name","estimatedPrice":"IF({$workOrderTemplateInventory.estimatedQty}!=0,{$workOrderTemplateInventory.estimatedQty}*{$catalog.customerPrice},0)","modelNumber":"catalog.modelNumber","id":"workOrderTemplateInventory.id","listPrice":"catalog.customerPrice","workOrderTemplateTaskId":"workOrderTemplateInventory.workOrderTemplateTaskId"},"orderBy":"orderBy","description":"fetchWorkOrderTemplateInventoryDataWithoutTemplateTaskIds","distinct":true,"inputVarMap":{"workOrderTemplateId":"workOrderTemplateId","queryFilter":"filter","queryOrderBy":"orderBy"},"nodeType":"QUERY","translate":true,"filter":"filter","name":"fetchWorkOrderTemplateInventoryDataWithoutTemplateTaskIds","links":{"catalogType":"catalog","workOrderTemplateInventory":"catalog","manufacturer":"catalog","stockUnit":"catalog"},"outputVarMap":{"data":"workOrderTemplateInventoryDataset"},"getCount":true},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"createFilterForFetch"}],"name":"start","description":"Start","nodeType":"START"},"end":{"name":"end","description":"End","inputVarMap":{"workOrderTemplateInventoryDataset":"workOrderTemplateInventoryDataset","count":"count"},"outputVarMap":{"workOrderTemplateInventoryDataset":"workOrderTemplateInventoryDataset","count":"count"},"nodeType":"END"},"workflowNodes":["start","createFilterForFetch","fetchWorkOrderTemplateInventoryDataWithoutTemplateTaskIds","isworkOrderTemplateInventoryDatasetPresent","fetchWorkOrderTemplateInventoryDataWithTemplateTaskIds","processWorkOrderTemplateInventoryData","end"],"createFilterForFetch":{"connectors":[{"exitPortType":"NextStep","nodeId":"fetchWorkOrderTemplateInventoryDataWithoutTemplateTaskIds"}],"contextChangePermitted":true,"name":"createFilterForFetch","description":"createFilterForFetch","processRule":"{if (typeof contextVar.orderBy == 'undefined' || contextVar.orderBy == '') { contextVar.queryOrderBy = 'modelName ASC'; } if (typeof contextVar.filter != 'undefined' && contextVar.filter != '') { contextVar.queryFilter = contextVar.filter + 'AND ({$workOrderTemplateInventory.workOrderTemplateId} = {@workOrderTemplateId})'; } else { contextVar.queryFilter = '{$workOrderTemplateInventory.workOrderTemplateId} = {@workOrderTemplateId}'; }}","id":"processServices","nodeType":"PROCESS","jsEngine":"es6"},"isworkOrderTemplateInventoryDatasetPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"fetchWorkOrderTemplateInventoryDataWithTemplateTaskIds"},{"exitPortType":"FalseStep","nodeId":"end"}],"name":"isworkOrderTemplateInventoryDatasetPresent","description":"isworkOrderTemplateInventoryDatasetPresent","processRule":"(Array.isArray(contextVar.workOrderTemplateInventoryDataset) && contextVar.workOrderTemplateInventoryDataset.length > 0)","nodeType":"DECISION"},"fetchWorkOrderTemplateInventoryDataWithTemplateTaskIds":{"filter":"{$workOrderTemplateTask.workOrderTemplateId} = {@workOrderTemplateId}","models":["workOrderTemplateTask"],"connectors":[{"exitPortType":"NextStep","nodeId":"processWorkOrderTemplateInventoryData"}],"columns":{"templateTaskName":"workOrderTemplateTask.name","workOrderTemplateTaskId":"workOrderTemplateTask.id"},"name":"fetchWorkOrderTemplateInventoryDataWithTemplateTaskIds","description":"fetchWorkOrderTemplateInventoryDataWithTemplateTaskIds","distinct":true,"inputVarMap":{"workOrderTemplateId":"workOrderTemplateId"},"outputVarMap":{"data":"inventoryDataWithTaskIds"},"nodeType":"QUERY","getCount":true,"translate":true}}