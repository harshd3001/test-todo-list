{"processCompData":{"connectors":[{"exitPortType":"NextStep","nodeId":"getAcCompAddress1"}],"contextChangePermitted":true,"name":"processCompData","description":"processCompData","processRule":"{ if(contextVar.acCompData.length>0){contextVar.siteAddress = contextVar.acCompData[0].address;contextVar.lng1 = contextVar.acCompData[0].lng;contextVar.lat1 = contextVar.acCompData[0].lat; contextVar.origins = [];contextVar.origins.push(contextVar.siteAddress);contextVar.origins.push({'lat':contextVar.lat1,'lng': contextVar.lng1}); }}","nodeType":"PROCESS","jsEngine":"es6"},"getDistance":{"connectors":[{"exitPortType":"NextStep","nodeId":"processDistanceData"}],"processId":"acGetDistanceWF","name":"getDistance","description":"getDistance","inputVarMap":{"destinations":"destinations","origins":"origins"},"outputVarMap":{"distance":"distance"},"nodeType":"WORKFLOW"},"processDistanceData":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"processDistanceData","description":"processDistanceData","processRule":"{ contextVar.distanceFromSite = contextVar.distance[0].rows[0].elements[0].distance.value / 1000; }","nodeType":"PROCESS","jsEngine":"es6"},"processCompData1":{"connectors":[{"exitPortType":"NextStep","nodeId":"getDistance"}],"contextChangePermitted":true,"name":"processCompData1","description":"processCompData1","processRule":"{ if (contextVar.acCompData1.length > 0) { contextVar.siteAddress = contextVar.acCompData1[0].address; contextVar.lng1 = contextVar.acCompData1[0].lng; contextVar.lat1 = contextVar.acCompData1[0].lat; contextVar.destinations = []; contextVar.destinations.push(contextVar.siteAddress); contextVar.destinations.push({ 'lat': contextVar.lat1, 'lng': contextVar.lng1 }); } }","nodeType":"PROCESS","jsEngine":"es6"},"getSiteIds":{"filter":"{$siteId} = {@siteId} ","models":["Site"],"connectors":[{"exitPortType":"NextStep","nodeId":"processSiteData"}],"columns":{"address":"site.address","lng":"site.longitude","siteName":"site.name","siteId":"site.id","lat":"site.latitude"},"name":"getSiteIds","distinct":true,"description":"fetch site ids for given regions ids and customer ids","inputVarMap":{"siteId":"siteId"},"outputVarMap":{"data":"siteData"},"batchSize":"batchSize","nodeType":"QUERY"},"getAcCompAddress1":{"filter":"{$compId} = {@ending} ","models":["acCompAddress"],"connectors":[{"exitPortType":"NextStep","nodeId":"processCompData1"}],"columns":{"address":"acCompAddress.address","lng":"acCompAddress.longitude","compId":"acCompAddress.id","lat":"acCompAddress.latitude"},"name":"getAcCompAddress1","distinct":true,"description":"fetch site ids for given regions ids and customer ids","inputVarMap":{"ending":"ending"},"outputVarMap":{"data":"acCompData1"},"batchSize":"batchSize","nodeType":"QUERY"},"decisionNode":{"connectors":[{"exitPortType":"TrueStep","nodeId":"getSiteIds"},{"exitPortType":"FalseStep","nodeId":"getAcCompAddress"}],"name":"decisionNode","description":"Use this for decision in workflow","processRule":"if(contextVar.end == ''){ true;}else{false;}","id":"decisionNode","nodeType":"DECISION"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"decisionNode"}],"name":"start","description":"Start","nodeType":"START"},"end":{"name":"end","description":"End","inputVarMap":{"distanceFromSite":"distanceFromSite"},"outputVarMap":{"distanceFromSite":"distanceFromSite"},"nodeType":"END"},"processSiteData":{"connectors":[{"exitPortType":"NextStep","nodeId":"getAcCompAddress1"}],"contextChangePermitted":true,"name":"processSiteData","description":"processSiteData","processRule":"{ if(contextVar.siteData.length>0){contextVar.siteAddress = contextVar.siteData[0].address;contextVar.lng1 = contextVar.siteData[0].lng;contextVar.lat1 = contextVar.siteData[0].lat; contextVar.origins = [];contextVar.origins.push(contextVar.siteAddress);contextVar.origins.push({'lat':contextVar.lat1,'lng': contextVar.lng1}); }}","nodeType":"PROCESS","jsEngine":"es6"},"workflowNodes":["start","decisionNode","getSiteIds","processSiteData","getAcCompAddress","processCompData","getAcCompAddress1","processCompData1","getDistance","processDistanceData","end"],"getAcCompAddress":{"filter":"{$compId} = {@end} ","models":["acCompAddress"],"connectors":[{"exitPortType":"NextStep","nodeId":"processCompData"}],"columns":{"address":"acCompAddress.address","lng":"acCompAddress.longitude","compId":"acCompAddress.id","lat":"acCompAddress.latitude"},"name":"getAcCompAddress","distinct":true,"description":"fetch site ids for given regions ids and customer ids","inputVarMap":{"end":"end"},"outputVarMap":{"data":"acCompData"},"batchSize":"batchSize","nodeType":"QUERY"}}