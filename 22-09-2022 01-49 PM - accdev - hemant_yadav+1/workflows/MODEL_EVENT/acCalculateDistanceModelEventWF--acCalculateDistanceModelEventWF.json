{"processInputData":{"connectors":[{"exitPortType":"NextStep","nodeId":"getSiteIds"}],"contextChangePermitted":true,"name":"processInputData","description":"processInputData","processRule":"{ contextVar.latitude = contextVar.data.latitude;contextVar.id = contextVar.data.id; contextVar.longitude = contextVar.data.longitude; contextVar.workOrderId = contextVar.data.workOrderId; contextVar.address = contextVar.data.address; contextVar.destinations = [];contextVar.destinations.push(contextVar.address);contextVar.destinations.push({'lat':contextVar.latitude,'lng': contextVar.longitude}); }","nodeType":"PROCESS","jsEngine":"es6"},"getDistance":{"connectors":[{"exitPortType":"NextStep","nodeId":"processDistanceData"}],"processId":"acGetDistanceWF","name":"getDistance","description":"getDistance","inputVarMap":{"destinations":"destinations","origins":"origins"},"outputVarMap":{"distance":"distance"},"nodeType":"WORKFLOW"},"upsertCompAddress":{"modelName":"acCompAddress","connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"name":"upsertCompAddress","description":"upsertCompAddress","inputVarMap":{"distanceFromSite":"distanceFromSite","id":"id"},"outputVarMap":{"data":"data"},"nodeType":"MODEL","operation":2},"processDistanceData":{"connectors":[{"exitPortType":"NextStep","nodeId":"upsertCompAddress"}],"contextChangePermitted":true,"name":"processDistanceData","description":"processDistanceData","processRule":"{ contextVar.distanceFromSite = contextVar.distance[0].rows[0].elements[0].distance.value / 1000; }","nodeType":"PROCESS","jsEngine":"es6"},"getSiteIds":{"filter":"{$workOrder.id} = {@workOrderId} ","models":["workOrder","workOrderTask","Site"],"connectors":[{"exitPortType":"NextStep","nodeId":"processSiteData"}],"columns":{"address":"site.address","lng":"site.longitude","siteName":"site.name","siteId":"site.id","lat":"site.latitude"},"name":"getSiteIds","distinct":true,"description":"fetch site ids for given regions ids and customer ids","outerJoinOnModel":"workOrderTask","inputVarMap":{"workOrderId":"workOrderId"},"outputVarMap":{"data":"siteData"},"batchSize":"batchSize","nodeType":"QUERY"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"processInputData"}],"name":"start","description":"Start","nodeType":"START"},"end":{"name":"end","description":"End","inputVarMap":{"id":"id"},"outputVarMap":{"id":"id"},"nodeType":"END"},"processSiteData":{"connectors":[{"exitPortType":"NextStep","nodeId":"getDistance"}],"contextChangePermitted":true,"name":"processSiteData","description":"processSiteData","processRule":"{ if(contextVar.siteData.length>0){contextVar.siteAddress = contextVar.siteData[0].address;contextVar.lng1 = contextVar.siteData[0].lng;contextVar.lat1 = contextVar.siteData[0].lat; contextVar.origins = [];contextVar.origins.push(contextVar.siteAddress);contextVar.origins.push({'lat':contextVar.lat1,'lng': contextVar.lng1}); }}","nodeType":"PROCESS","jsEngine":"es6"},"workflowNodes":["start","processInputData","getSiteIds","processSiteData","getDistance","processDistanceData","upsertCompAddress","end"]}