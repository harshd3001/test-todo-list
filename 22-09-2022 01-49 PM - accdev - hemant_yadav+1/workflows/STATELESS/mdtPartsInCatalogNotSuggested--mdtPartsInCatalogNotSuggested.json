{"isMoreDataPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"fetchMoreData"},{"exitPortType":"FalseStep","nodeId":"clearValues"}],"name":"isMoreDataPresent","description":"isMoreDataPresent","processRule":"contextVar.noOfAllBatches >= 2 && contextVar.noOfAllBatches >= contextVar.newdataBatchNumber","nodeType":"DECISION"},"clearValues":{"connectors":[{"exitPortType":"NextStep","nodeId":"processFileName"}],"contextChangePermitted":true,"name":"clearValues","description":"clearValues","processRule":"contextVar.dataToAppend='';contextVar.dataVar='';contextVar.dataFilter='';","id":"clearValues","nodeType":"PROCESS"},"findNumberOfBatches":{"connectors":[{"exitPortType":"NextStep","nodeId":"isMoreDataPresent"}],"contextChangePermitted":true,"name":"findNumberOfBatches","description":"findNumberOfBatches","processRule":"contextVar.noOfAllBatches = Math.ceil(contextVar.dataCount / contextVar.customBatchSize);contextVar.newdataBatchNumber = contextVar.dataBatchNumber + 1;","id":"findNumberOfBatches","nodeType":"PROCESS"},"start":{"connectors":[{"exitPortType":"NextStep","nodeId":"fireCheckIfInventoryModelPresentWF"}],"name":"start","description":"Start","nodeType":"START"},"processFileName":{"connectors":[{"exitPortType":"NextStep","nodeId":"end"}],"contextChangePermitted":true,"name":"processFileName","description":"processFileName","processRule":"if (typeof contextVar.fetchNotSuggestedParts !== 'undefined' && contextVar.fetchNotSuggestedParts != '' && contextVar.fetchNotSuggestedParts.length > 0 && Array.isArray(contextVar.fetchNotSuggestedParts) === true) { contextVar.fetchNotSuggestedParts.map(function(item) { let fileName, splitFileName; if (typeof item.fileUrl !== 'undefined' && item.fileUrl !== '') { splitFileName = item.fileUrl.split('/'); fileName = splitFileName[splitFileName.length - 1]; } else { fileName = '{%assetManual}'; } item.fileName = fileName; return item; }); }","id":"processFileName","nodeType":"PROCESS","jsEngine":"es6"},"workflowNodes":["start","fireCheckIfInventoryModelPresentWF","isInventoryModelPresent","fireMdtFetchInventoryPartsProcessEvent","processData","getData","findNumberOfBatches","isMoreDataPresent","fetchMoreData","appendData","clearValues","processFileName","end"],"appendData":{"connectors":[{"exitPortType":"NextStep","nodeId":"isMoreDataPresent"}],"contextChangePermitted":true,"name":"appendData","description":"appendData","processRule":"{if (Array.isArray(contextVar.dataToAppend)) { contextVar[contextVar['dataVar']] = contextVar[contextVar['dataVar']].concat(contextVar.dataToAppend); } contextVar.newdataBatchNumber = contextVar.newdataBatchNumber + 1;}","id":"appendData","nodeType":"PROCESS","jsEngine":"es6"},"fireCheckIfInventoryModelPresentWF":{"connectors":[{"exitPortType":"NextStep","nodeId":"isInventoryModelPresent"}],"processId":"checkIfInventoryModelPresentWF","name":"fireCheckIfInventoryModelPresentWF","description":"fireCheckIfInventoryModelPresentWF","inputVarMap":{},"id":"fireCheckIfInventoryModelPresentWF","outputVarMap":{},"nodeType":"WORKFLOW"},"processData":{"connectors":[{"exitPortType":"NextStep","nodeId":"getData"}],"contextChangePermitted":true,"name":"processData","description":"processData","processRule":"if (Array.isArray(contextVar.catalogIds) && contextVar.catalogIds.length) { contextVar.catalogIds = contextVar.catalogIds[0].catalogIds; contextVar.dataFilter = contextVar.dataFilter + ' AND {$catalog.id} IN {@catalogIds}'; }","id":"processData","nodeType":"PROCESS","jsEngine":"es6"},"workflowContext":{"customBatchSize":1000,"dataFilter":" {$catalogId} NOT IN ({@suggestedParts}) AND {$catalogTypeId} = 'partAndAsset'","noOfBatches":0,"dataVar":"fetchNotSuggestedParts","newBatchNumber":0,"noOfAllBatches":0},"isInventoryModelPresent":{"connectors":[{"exitPortType":"TrueStep","nodeId":"fireMdtFetchInventoryPartsProcessEvent"},{"exitPortType":"FalseStep","nodeId":"processData"}],"name":"isInventoryModelPresent","description":"isInventoryModelPresent","processRule":"(contextVar.isInventoryModelPresent)","nodeType":"DECISION"},"fireMdtFetchInventoryPartsProcessEvent":{"eventId":"mdtFetchInventoryPartsProcessEvent","connectors":[{"exitPortType":"NextStep","nodeId":"processData"}],"contextChangePermitted":true,"ignoreSubContext":true,"name":"fireMdtFetchInventoryPartsProcessEvent","description":"fireMdtFetchInventoryPartsProcessEvent","inputVarMap":{"assignedToUserId":"assignedToUserId"},"outputVarMap":{"data":"catalogIds"},"nodeType":"PUBLISH","captureOutput":true},"end":{"name":"End","description":"end","inputVarMap":{"fetchNotSuggestedParts":"fetchNotSuggestedParts"},"outputVarMap":{"fetchNotSuggestedParts":"fetchNotSuggestedParts"},"id":"end","nodeType":"END"},"fetchMoreData":{"models":["catalog","manufacturer","stockUnit","category","catalogType","assetCategory"],"connectors":[{"exitPortType":"NextStep","nodeId":"appendData"}],"columns":{"categoryTaxRate":"category.taxRate","catalogCategoryId":"catalog.categoryId","catalogModifiedDate":"catalog.modifiedDate","manufacturerName":"manufacturer.name","displayName":"CONCAT({$catalog.name},'-',{$catalog.modelNumber},'-',{$manufacturer.name})","assetCategory":"assetCategory.name","catalogModelNumber":"catalog.modelNumber","catalogTypeId":"catalog.catalogTypeId","catalogStockUnitId":"catalog.stockUnitId","categoryName":"category.name","stockUnitName":"stockUnit.name","catalogName":"catalog.name","catalogRecver":"catalog.recver","catalogId":"catalog.id","catalogManufacturerId":"catalog.manufacturerId","catalogCustomerPrice":"catalog.customerPrice","assetCategoryId":"assetCategory.id","fileUrl":"catalog.pdfUrl","catalogUnitPrice":"catalog.unitPrice","categoryId":"category.id","catalogDescription":"catalog.description"},"inputs":{"suggestedParts":{"filter":"{$workOrderTaskId} = {@workOrderTaskId}","models":["workOrderInventory"],"columns":{"catalogId":"catalogId","workOrderTaskId":"workOrderTaskId"},"selectColumns":["catalogId"]}},"outerJoinOnModel":"catalog","orderBy":"catalogName","description":"Fetch Details","distinct":true,"inputVarMap":{"customBatchSize":"batchSize","dataFilter":"filter","workOrderTaskId":"workOrderTaskId","newdataBatchNumber":"batchNumber","catalogIds":"catalogIds"},"nodeType":"QUERY","filter":"filter","name":"fetchMoreData","links":{"catalogType":"catalog","assetCategory":"catalog","category":"catalog","manufacturer":"catalog","stockUnit":"catalog"},"id":"fetchMoreData","outputVarMap":{"data":"dataToAppend"},"batchSize":"batchSize","getCount":true,"batchNumber":"batchNumber"},"getData":{"models":["catalog","manufacturer","stockUnit","category","catalogType","assetCategory"],"connectors":[{"exitPortType":"NextStep","nodeId":"findNumberOfBatches"}],"columns":{"categoryTaxRate":"category.taxRate","catalogCategoryId":"catalog.categoryId","catalogModifiedDate":"catalog.modifiedDate","manufacturerName":"manufacturer.name","displayName":"CONCAT({$catalog.name},'-',{$catalog.modelNumber},'-',{$manufacturer.name})","assetCategory":"assetCategory.name","catalogModelNumber":"catalog.modelNumber","catalogTypeId":"catalog.catalogTypeId","catalogStockUnitId":"catalog.stockUnitId","categoryName":"category.name","stockUnitName":"stockUnit.name","catalogName":"catalog.name","catalogRecver":"catalog.recver","catalogId":"catalog.id","catalogManufacturerId":"catalog.manufacturerId","catalogCustomerPrice":"catalog.customerPrice","assetCategoryId":"assetCategory.id","fileUrl":"catalog.pdfUrl","catalogUnitPrice":"catalog.unitPrice","categoryId":"category.id","catalogDescription":"catalog.description"},"inputs":{"suggestedParts":{"filter":"{$workOrderTaskId} = {@workOrderTaskId}","models":["workOrderInventory"],"columns":{"catalogId":"catalogId","workOrderTaskId":"workOrderTaskId"},"selectColumns":["catalogId"]}},"outerJoinOnModel":"catalog","orderBy":"catalogName","description":"getData","distinct":true,"inputVarMap":{"customBatchSize":"batchSize","dataFilter":"filter","workOrderTaskId":"workOrderTaskId","catalogIds":"catalogIds"},"nodeType":"QUERY","filter":"filter","name":"getData","links":{"catalogType":"catalog","assetCategory":"catalog","category":"catalog","manufacturer":"catalog","stockUnit":"catalog"},"outputVarMap":{"data":"fetchNotSuggestedParts","count":"dataCount","batchNumber":"dataBatchNumber"},"batchSize":"batchSize","getCount":true}}